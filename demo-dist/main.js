var lt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Do(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var hs={exports:{}},Ut={},ms={exports:{}},j={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nt=Symbol.for("react.element"),Ho=Symbol.for("react.portal"),_o=Symbol.for("react.fragment"),No=Symbol.for("react.strict_mode"),qo=Symbol.for("react.profiler"),Fo=Symbol.for("react.provider"),Uo=Symbol.for("react.context"),Qo=Symbol.for("react.forward_ref"),Go=Symbol.for("react.suspense"),Yo=Symbol.for("react.memo"),Xo=Symbol.for("react.lazy"),rr=Symbol.iterator;function Zo(n){return n===null||typeof n!="object"?null:(n=rr&&n[rr]||n["@@iterator"],typeof n=="function"?n:null)}var gs={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fs=Object.assign,vs={};function $e(n,e,t){this.props=n,this.context=e,this.refs=vs,this.updater=t||gs}$e.prototype.isReactComponent={};$e.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};$e.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function xs(){}xs.prototype=$e.prototype;function Tn(n,e,t){this.props=n,this.context=e,this.refs=vs,this.updater=t||gs}var Pn=Tn.prototype=new xs;Pn.constructor=Tn;fs(Pn,$e.prototype);Pn.isPureReactComponent=!0;var sr=Array.isArray,ks=Object.prototype.hasOwnProperty,Rn={current:null},ys={key:!0,ref:!0,__self:!0,__source:!0};function bs(n,e,t){var r,s={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)ks.call(e,r)&&!ys.hasOwnProperty(r)&&(s[r]=e[r]);var i=arguments.length-2;if(i===1)s.children=t;else if(1<i){for(var u=Array(i),l=0;l<i;l++)u[l]=arguments[l+2];s.children=u}if(n&&n.defaultProps)for(r in i=n.defaultProps,i)s[r]===void 0&&(s[r]=i[r]);return{$$typeof:nt,type:n,key:o,ref:a,props:s,_owner:Rn.current}}function Ko(n,e){return{$$typeof:nt,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Bn(n){return typeof n=="object"&&n!==null&&n.$$typeof===nt}function Jo(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var or=/\/+/g;function tn(n,e){return typeof n=="object"&&n!==null&&n.key!=null?Jo(""+n.key):e.toString(36)}function Et(n,e,t,r,s){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case nt:case Ho:a=!0}}if(a)return a=n,s=s(a),n=r===""?"."+tn(a,0):r,sr(s)?(t="",n!=null&&(t=n.replace(or,"$&/")+"/"),Et(s,e,t,"",function(l){return l})):s!=null&&(Bn(s)&&(s=Ko(s,t+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(or,"$&/")+"/")+n)),e.push(s)),1;if(a=0,r=r===""?".":r+":",sr(n))for(var i=0;i<n.length;i++){o=n[i];var u=r+tn(o,i);a+=Et(o,e,t,u,s)}else if(u=Zo(n),typeof u=="function")for(n=u.call(n),i=0;!(o=n.next()).done;)o=o.value,u=r+tn(o,i++),a+=Et(o,e,t,u,s);else if(o==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function ut(n,e,t){if(n==null)return n;var r=[],s=0;return Et(n,r,"","",function(o){return e.call(t,o,s++)}),r}function Wo(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var se={current:null},Tt={transition:null},Vo={ReactCurrentDispatcher:se,ReactCurrentBatchConfig:Tt,ReactCurrentOwner:Rn};function ws(){throw Error("act(...) is not supported in production builds of React.")}j.Children={map:ut,forEach:function(n,e,t){ut(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return ut(n,function(){e++}),e},toArray:function(n){return ut(n,function(e){return e})||[]},only:function(n){if(!Bn(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};j.Component=$e;j.Fragment=_o;j.Profiler=qo;j.PureComponent=Tn;j.StrictMode=No;j.Suspense=Go;j.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vo;j.act=ws;j.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=fs({},n.props),s=n.key,o=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=Rn.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var i=n.type.defaultProps;for(u in e)ks.call(e,u)&&!ys.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&i!==void 0?i[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=t;else if(1<u){i=Array(u);for(var l=0;l<u;l++)i[l]=arguments[l+2];r.children=i}return{$$typeof:nt,type:n.type,key:s,ref:o,props:r,_owner:a}};j.createContext=function(n){return n={$$typeof:Uo,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:Fo,_context:n},n.Consumer=n};j.createElement=bs;j.createFactory=function(n){var e=bs.bind(null,n);return e.type=n,e};j.createRef=function(){return{current:null}};j.forwardRef=function(n){return{$$typeof:Qo,render:n}};j.isValidElement=Bn;j.lazy=function(n){return{$$typeof:Xo,_payload:{_status:-1,_result:n},_init:Wo}};j.memo=function(n,e){return{$$typeof:Yo,type:n,compare:e===void 0?null:e}};j.startTransition=function(n){var e=Tt.transition;Tt.transition={};try{n()}finally{Tt.transition=e}};j.unstable_act=ws;j.useCallback=function(n,e){return se.current.useCallback(n,e)};j.useContext=function(n){return se.current.useContext(n)};j.useDebugValue=function(){};j.useDeferredValue=function(n){return se.current.useDeferredValue(n)};j.useEffect=function(n,e){return se.current.useEffect(n,e)};j.useId=function(){return se.current.useId()};j.useImperativeHandle=function(n,e,t){return se.current.useImperativeHandle(n,e,t)};j.useInsertionEffect=function(n,e){return se.current.useInsertionEffect(n,e)};j.useLayoutEffect=function(n,e){return se.current.useLayoutEffect(n,e)};j.useMemo=function(n,e){return se.current.useMemo(n,e)};j.useReducer=function(n,e,t){return se.current.useReducer(n,e,t)};j.useRef=function(n){return se.current.useRef(n)};j.useState=function(n){return se.current.useState(n)};j.useSyncExternalStore=function(n,e,t){return se.current.useSyncExternalStore(n,e,t)};j.useTransition=function(){return se.current.useTransition()};j.version="18.3.1";ms.exports=j;var v=ms.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ea=v,ta=Symbol.for("react.element"),na=Symbol.for("react.fragment"),ra=Object.prototype.hasOwnProperty,sa=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,oa={key:!0,ref:!0,__self:!0,__source:!0};function Ss(n,e,t){var r,s={},o=null,a=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)ra.call(e,r)&&!oa.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:ta,type:n,key:o,ref:a,props:s,_owner:sa.current}}Ut.Fragment=na;Ut.jsx=Ss;Ut.jsxs=Ss;hs.exports=Ut;var b=hs.exports,aa=Object.defineProperty,dt=(n,e,t)=>((r,s,o)=>s in r?aa(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,typeof e!="symbol"?e+"":e,t);class ke extends Error{constructor(e={}){super(e.message),dt(this,"exceptionId"),dt(this,"message"),dt(this,"source"),dt(this,"type"),this.message=e.message??"",this.source=e.source,this.type=this.constructor.name,this.exceptionId=e.exceptionId}}class Se extends ke{}class Lt extends ke{}const re=n=>{typeof n!="string"?n&&typeof n.toString=="function"?console.warn(`[nlux] ${n.toString()}`):console.warn("[nlux]"):console.warn(`[nlux] ${n}`)},ar=[],dn=n=>{ar.includes(n)||(ar.push(n),re(n))},Cs=class Pt{static register(e){const t=e.__compId;t?Pt.componentDefs.get(t)===void 0&&(e.__renderer&&e.__updater?Pt.componentDefs.set(t,{id:t,model:e,render:e.__renderer,update:e.__updater}):re(`Component with id "${t}" missing renderer or updater`)):re("Component definition missing valid id")}static retrieve(e){const t=Pt.componentDefs.get(e);if(t)return t;re(`Component with id "${e}" not registered`)}};Cs.componentDefs=new Map;let As=Cs;btoa("sectionsRegistered")+"";const ge=n=>{const e=requestAnimationFrame(()=>{n()});return()=>{cancelAnimationFrame(e)}},et=n=>{n.replaceChildren()},de=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=16*Math.random()|0;return(n=="x"?e:3&e|8).toString(16)});class le{constructor(e,t){this.subComponentElementIds=new Map,this.subComponents=new Map,this.__context=null,this.__destroyed=!1,this.__status="unmounted",this.actionsOnDomReady=[],this.compEventGetter=a=>{if(this.destroyed)return()=>{};const i=this.rendererEventListeners.get(a);if(!i)throw new ke({source:this.constructor.name,message:`Unable to call renderer event "${a}" because no matching event listener was found. Make sure that the event listener is registered using @CompEventListener() decorator in the component model class, and use class methods instead of arrow function attributes.`});return i};const r=Object.getPrototypeOf(this).constructor.__compId;if(!r)throw new Se({source:this.constructor.name,message:"Unable to instantiate component: missing compId in implementation. Component should be annotated using @Model() to set compId before iy can be instantiated."});if(this.def=As.retrieve(r)??null,!this.def)throw new Se({source:this.constructor.name,message:`Unable to instantiate component "${r}" because it's not registered. Component should be registered using CompRegistry.register(ComponentClass) before instantiating a component.`});this.__instanceId=de(),this.__destroyed=!1,this.__context=e,this.renderedDom=null,this.renderingRoot=null,this.props=t;const s=t?Object.entries(t):[];this.elementProps=new Map(s),this.rendererEventListeners=new Map;const o=this.constructor.__compEventListeners;o&&o.forEach((a,i)=>{a.forEach(u=>{const l=Object.getPrototypeOf(this)[u];typeof l=="function"?this.addRendererEventListener(i,l.bind(this)):re(`Unable to set event listener "${i}" because method "${u}" cannot be found on component "${this.constructor.name} at runtime!"`)})}),this.rendererProps=Object.freeze(t)}get destroyed(){return this.__destroyed}get id(){return this.__instanceId}get rendered(){return this.renderedDom!==null}get root(){return this.throwIfDestroyed(),this.renderedDom&&this.renderingRoot?this.renderingRoot:null}get status(){return this.__status}get context(){if(!this.__context)throw new Se({source:this.constructor.name,message:"Unable to get context because it's not set"});return this.__context}destroy(){this.destroyComponent()}destroyListItemComponent(){this.destroyComponent(!0)}getProp(e){return this.throwIfDestroyed(),this.elementProps.get(e)??null}render(e,t){var a;if(!this.def)return;if(this.destroyed)return void re(`Unable to render component "${(a=this.def)==null?void 0:a.id}" because it is already destroyed`);if(this.rendered||this.renderedDom)return void re(`Unable to render component "${this.def.id}" because it is already rendered`);const r=document.createDocumentFragment(),s=Object.getPrototypeOf(this).constructor.__compId,o=this.executeRenderer(r);if(!o)throw new ke({source:this.constructor.name,message:`Unable to render component "${s}" because renderer returned null`});this.renderedDom=o;for(const[,i]of this.subComponents){const u=this.getSubComponentPortal(i.id);u&&this.mountSubComponentToPortal(i.id,u)}ge(()=>{this.destroyed||(t?e.insertBefore(r,t):e.append(r),this.renderingRoot=e)})}updateSubComponent(e,t,r){this.throwIfDestroyed();const s=this.subComponents.get(e);s&&!s.destroyed&&s.setProp(t,r)}addSubComponent(e,t,r){if(this.throwIfDestroyed(),this.subComponents.has(e))throw new Se({source:this.constructor.name,message:`Unable to add sub-component "${e}" because it already exists`});if(this.subComponents.set(e,t),r&&this.subComponentElementIds.set(e,r),this.renderedDom){const s=this.getSubComponentPortal(e);s&&this.mountSubComponentToPortal(e,s)}}executeDomAction(e,...t){if(this.throwIfDestroyed(),!this.renderedDom)return void this.actionsOnDomReady.push(()=>this.executeDomAction(e,...t));if(!this.renderingRoot)throw new ke({source:this.constructor.name,message:"Unable to execute DOM action because renderingRoot is not set"});const r=this.renderedDom.actions[e];if(!r)throw new ke({source:this.constructor.name,message:`Unable to execute DOM action "${String(e)}" because it does not exist`});return ge(()=>r(...t))}executeRenderer(e){var s;const t=(s=this.def)==null?void 0:s.render;if(!t)return null;if(this.renderingRoot)throw new ke({source:this.constructor.name,message:"Unable to render component because renderingRoot is already set"});const r=t({appendToRoot:o=>{e.append(o),this.runDomActionsQueue()},compEvent:this.compEventGetter,props:this.rendererProps,context:this.context});return r&&(this.renderingRoot=e),r}removeSubComponent(e){this.throwIfDestroyed(),ge(()=>{const t=this.subComponents.get(e);t&&(t.renderingRoot=null,t.destroy(),this.subComponents.delete(e))})}runDomActionsQueue(){if(this.actionsOnDomReady.length>0&&this.rendered){const e=this.actionsOnDomReady;this.actionsOnDomReady=[];for(const t of e)ge(()=>t())}}setProp(e,t){this.destroyed?re(`Unable to set prop "${String(e)}" because component "${this.constructor.name}" is destroyed`):this.elementProps.has(e)?(this.schedulePropUpdate(e,this.elementProps.get(e),t),this.props=Object.freeze(Object.fromEntries(this.elementProps)),this.elementProps.set(e,t)):re(`Unable to set prop "${String(e)}" because it does not exist in the component props`)}throwIfDestroyed(){if(this.__destroyed)throw new Se({source:this.constructor.name,message:"Unable to call method on destroyed component"})}addRendererEventListener(e,t){if(this.throwIfDestroyed(),this.rendererEventListeners.has(e))throw new Se({source:this.constructor.name,message:`Unable to add event listener to rendererEvents "${e}" because it already exists`});this.rendererEventListeners.set(e,t)}destroyComponent(e=!1){if(this.throwIfDestroyed(),this.subComponents.forEach(t=>{t.destroy()}),this.renderedDom){this.renderedDom.elements&&(this.renderedDom.elements=void 0),this.renderedDom.actions&&(this.renderedDom.actions=void 0),this.renderedDom.onDestroy&&this.renderedDom.onDestroy();const t=this.renderingRoot;ge(()=>{var r;if(t)if(t instanceof DocumentFragment)for(;t.firstChild;)t.removeChild(t.firstChild);else e?(r=t.parentElement)==null||r.removeChild(t):et(t)}),this.renderedDom=null,this.renderingRoot=null}this.__destroyed=!0,this.__context=null,this.props=void 0,this.elementProps.clear(),this.rendererEventListeners.clear(),this.subComponents.clear()}getSubComponentPortal(e){var o;const t=this.subComponents.get(e),r=this.subComponentElementIds.get(e);if(!t||!r)return null;const s=((o=this.renderedDom)==null?void 0:o.elements)[r];return s instanceof HTMLElement?s:null}mountSubComponentToPortal(e,t){const r=this.subComponents.get(e);r==null||r.render(t)}schedulePropUpdate(e,t,r){var i;if(!this.renderedDom||!((i=this.def)!=null&&i.update))return;const s=this.renderedDom,o=this.renderingRoot,a=this.def.update;o&&ge(()=>{a({propName:e,currentValue:t,newValue:r,dom:{root:o,elements:s.elements,actions:s.actions},updateSubComponent:this.updateSubComponent})})}}le.__compEventListeners=null,le.__compId=null,le.__renderer=null,le.__updater=null;const ye=(n,e,t)=>r=>{r.__compId=n,r.__renderer=e,r.__updater=t},pe=n=>(e,t)=>{const r=e;if(typeof r.constructor!="function")throw new Se({source:"CallbackFor",message:"@CallbackFor can only be used on methods of a class!"});r.constructor.hasOwnProperty("__compEventListeners")&&r.constructor.__compEventListeners!==null||(r.constructor.__compEventListeners=new Map);const s=r.constructor.__compEventListeners,o=s.get(n);o?o.push(t):s.set(n,[t])},Is=(n,e)=>{const t=document.createElement("div");if(t.classList.add("nlux-comp-avatarContainer"),n){const r=document.createElement("div");r.classList.add("nlux-comp-avatarPicture"),r.style.backgroundImage=`url("${encodeURI(n)}")`,t.append(r)}return t},Ln="nlux-comp-avatar",Mn=n=>{const e=document.createElement("div");return e.classList.add(Ln),n.avatar||n.name?(n.name&&(e.title=n.name),n.avatar&&n.avatar instanceof HTMLElement?(e.append(n.avatar.cloneNode(!0)),e):(e.append(Is(n.avatar)),e)):e},pt={received:"nlux_msg_received",sent:"nlux_msg_sent"},Es=(n,e)=>{Object.keys(pt).forEach(t=>{n.classList.remove(pt[t])}),pt[e]&&n.classList.add(pt[e])},Ye={streaming:"nlux_msg_streaming",complete:"nlux_msg_complete"},Ts=(n,e)=>{Object.keys(Ye).forEach(t=>{n.classList.remove(Ye[t])}),Ye[e]&&n.classList.add(Ye[e])},ir=n=>{if(!(n instanceof HTMLButtonElement)||n.dataset.clickListenerSet==="true")return;let e=!1;const t=n.nextElementSibling;n.addEventListener("click",()=>{if(e||!t)return;const r=t.innerText;navigator.clipboard.writeText(r??""),e=!0,n.classList.add("clicked"),setTimeout(()=>{e=!1,n.classList.remove("clicked")},1e3)}),n.dataset.clickListenerSet="true"},Ps=n=>{const e="nlux-comp-copyButton";n instanceof HTMLButtonElement&&n.classList.contains(e)?ir(n):n.querySelectorAll(`.${e}`).forEach(ir)};function ia(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Ee={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function cr(n){Ee=n}var ca=Object.defineProperty,Rs=(n,e,t)=>((r,s,o)=>s in r?ca(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,typeof e!="symbol"?e+"":e,t);let Xe=class{constructor(e){Rs(this,"options"),this.options=e||Ee}postprocess(e){return e}preprocess(e){return e}processAllTokens(e){return e}};Rs(Xe,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));const Bs=/[&<>"']/,la=new RegExp(Bs.source,"g"),Ls=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,ua=new RegExp(Ls.source,"g"),da={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},lr=n=>da[n];function ie(n,e){if(e){if(Bs.test(n))return n.replace(la,lr)}else if(Ls.test(n))return n.replace(ua,lr);return n}const pa=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function ha(n){return n.replace(pa,(e,t)=>(t=t.toLowerCase())==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):"")}const ma=/(^|[^\[])\^/g;function D(n,e){let t=typeof n=="string"?n:n.source;e=e||"";const r={replace:(s,o)=>{let a=typeof o=="string"?o:o.source;return a=a.replace(ma,"$1"),t=t.replace(s,a),r},getRegex:()=>new RegExp(t,e)};return r}function ur(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const Ze={exec:()=>null};function dr(n,e){const t=n.replace(/\|/g,(s,o,a)=>{let i=!1,u=o;for(;--u>=0&&a[u]==="\\";)i=!i;return i?"|":" |"}).split(/ \|/);let r=0;if(t[0].trim()||t.shift(),t.length>0&&!t[t.length-1].trim()&&t.pop(),e)if(t.length>e)t.splice(e);else for(;t.length<e;)t.push("");for(;r<t.length;r++)t[r]=t[r].trim().replace(/\\\|/g,"|");return t}function ht(n,e,t){const r=n.length;if(r===0)return"";let s=0;for(;s<r;){const o=n.charAt(r-s-1);if(o!==e||t){if(o===e||!t)break;s++}else s++}return n.slice(0,r-s)}const rt=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ms=/(?:[*+-]|\d{1,9}[.)])/,Os=D(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Ms).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),On=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,$n=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ga=D(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",$n).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),fa=D(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Ms).getRegex(),Qt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",zn=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,va=D("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",zn).replace("tag",Qt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),pr=D(On).replace("hr",rt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Qt).getRegex(),jn={blockquote:D(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",pr).getRegex(),code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,def:ga,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:rt,html:va,lheading:Os,list:fa,newline:/^(?: *(?:\n|$))+/,paragraph:pr,table:Ze,text:/^[^\n]+/},hr=D("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",rt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Qt).getRegex(),xa={...jn,table:hr,paragraph:D(On).replace("hr",rt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",hr).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Qt).getRegex()},ka={...jn,html:D(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",zn).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ze,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:D(On).replace("hr",rt).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Os).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},$s=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,zs=/^( {2,}|\\)\n(?!\s*$)/,st="\\p{P}\\p{S}",ya=D(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,st).getRegex(),ba=D(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,st).getRegex(),wa=D("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,st).getRegex(),Sa=D("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,st).getRegex(),Ca=D(/\\([punct])/,"gu").replace(/punct/g,st).getRegex(),Aa=D(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Ia=D(zn).replace("(?:-->|$)","-->").getRegex(),Ea=D("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Ia).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Mt=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ta=D(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Mt).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),mr=D(/^!?\[(label)\]\[(ref)\]/).replace("label",Mt).replace("ref",$n).getRegex(),gr=D(/^!?\[(ref)\](?:\[\])?/).replace("ref",$n).getRegex(),Dn={_backpedal:Ze,anyPunctuation:Ca,autolink:Aa,blockSkip:/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,br:zs,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:Ze,emStrongLDelim:ba,emStrongRDelimAst:wa,emStrongRDelimUnd:Sa,escape:$s,link:Ta,nolink:gr,punctuation:ya,reflink:mr,reflinkSearch:D("reflink|nolink(?!\\()","g").replace("reflink",mr).replace("nolink",gr).getRegex(),tag:Ea,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:Ze},Pa={...Dn,link:D(/^!?\[(label)\]\((.*?)\)/).replace("label",Mt).getRegex(),reflink:D(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Mt).getRegex()},pn={...Dn,escape:D($s).replace("])","~|])").getRegex(),url:D(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Ra={...pn,br:D(zs).replace("{2,}","*").getRegex(),text:D(pn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},mt={normal:jn,gfm:xa,pedantic:ka},Ne={normal:Dn,gfm:pn,breaks:Ra,pedantic:Pa};var Ba=Object.defineProperty,nn=(n,e,t)=>((r,s,o)=>s in r?Ba(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,typeof e!="symbol"?e+"":e,t);function fr(n,e,t,r){const s=e.href,o=e.title?ie(e.title):null,a=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const i={type:"link",raw:t,href:s,title:o,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,i}return{type:"image",raw:t,href:s,title:o,text:ie(a)}}let Ot=class{constructor(e){nn(this,"lexer"),nn(this,"options"),nn(this,"rules"),this.options=e||Ee}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let r,s;return t[2]==="@"?(r=ie(t[1]),s="mailto:"+r):(r=ie(t[1]),s=r),{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let r=t[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);r=ht(r.replace(/^ *>[ \t]?/gm,""),`
`);const s=this.lexer.state.top;this.lexer.state.top=!0;const o=this.lexer.blockTokens(r);return this.lexer.state.top=s,{type:"blockquote",raw:t[0],tokens:o,text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:ht(r,`
`)}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(/\n/g," ");const s=/[^ ]/.test(r),o=/^ /.test(r)&&/ $/.test(r);return s&&o&&(r=r.substring(1,r.length-1)),r=ie(r,!0),{type:"codespan",raw:t[0],text:r}}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(/\s+/g," "),s=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:s,title:o}}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}emStrong(e,t,r=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(s&&!(s[3]&&r.match(/[\p{L}\p{N}]/u))&&(!(s[1]||s[2])||!r||this.rules.inline.punctuation.exec(r))){const o=[...s[0]].length-1;let a,i,u=o,l=0;const c=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+o);(s=c.exec(t))!=null;){if(a=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!a)continue;if(i=[...a].length,s[3]||s[4]){u+=i;continue}if((s[5]||s[6])&&o%3&&!((o+i)%3)){l+=i;continue}if(u-=i,u>0)continue;i=Math.min(i,i+u+l);const d=[...s[0]][0].length,p=e.slice(0,o+s.index+d+i);if(Math.min(o,i)%2){const h=p.slice(1,-1);return{type:"em",raw:p,text:h,tokens:this.lexer.inlineTokens(h)}}const m=p.slice(2,-2);return{type:"strong",raw:p,text:m,tokens:this.lexer.inlineTokens(m)}}}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:ie(t[1])}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],s=function(o,a){const i=o.match(/^(\s+)(?:```)/);if(i===null)return a;const u=i[1];return a.split(`
`).map(l=>{const c=l.match(/^\s+/);if(c===null)return l;const[d]=c;return d.length>=u.length?l.slice(u.length):l}).join(`
`)}(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(/#$/.test(r)){const s=ht(r,"#");this.options.pedantic?r=s.trim():s&&!/ $/.test(s)||(r=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let r;return r=this.lexer.state.inRawBlock?t[0]:ie(t[0]),{type:"text",raw:t[0],text:r}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const a=ht(r.slice(0,-1),"\\");if((r.length-a.length)%2==0)return}else{const a=function(i,u){if(i.indexOf(u[1])===-1)return-1;let l=0;for(let c=0;c<i.length;c++)if(i[c]==="\\")c++;else if(i[c]===u[0])l++;else if(i[c]===u[1]&&(l--,l<0))return c;return-1}(t[2],"()");if(a>-1){const i=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,i).trim(),t[3]=""}}let s=t[2],o="";if(this.options.pedantic){const a=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);a&&(s=a[1],o=a[3])}else o=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(s=this.options.pedantic&&!/>$/.test(r)?s.slice(1):s.slice(1,-1)),fr(t,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const s=r.length>1,o={type:"list",raw:"",ordered:s,start:s?+r.slice(0,-1):"",loose:!1,items:[]};r=s?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=s?r:"[*+-]");const a=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let i="",u="",l=!1;for(;e;){let c=!1;if(!(t=a.exec(e))||this.rules.block.hr.test(e))break;i=t[0],e=e.substring(i.length);let d=t[2].split(`
`,1)[0].replace(/^\t+/,w=>" ".repeat(3*w.length)),p=e.split(`
`,1)[0],m=0;this.options.pedantic?(m=2,u=d.trimStart()):(m=t[2].search(/[^ ]/),m=m>4?1:m,u=d.slice(m),m+=t[1].length);let h=!1;if(!d&&/^ *$/.test(p)&&(i+=p+`
`,e=e.substring(p.length+1),c=!0),!c){const w=new RegExp(`^ {0,${Math.min(3,m-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),f=new RegExp(`^ {0,${Math.min(3,m-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),x=new RegExp(`^ {0,${Math.min(3,m-1)}}(?:\`\`\`|~~~)`),S=new RegExp(`^ {0,${Math.min(3,m-1)}}#`);for(;e;){const C=e.split(`
`,1)[0];if(p=C,this.options.pedantic&&(p=p.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),x.test(p)||S.test(p)||w.test(p)||f.test(e))break;if(p.search(/[^ ]/)>=m||!p.trim())u+=`
`+p.slice(m);else{if(h||d.search(/[^ ]/)>=4||x.test(d)||S.test(d)||f.test(d))break;u+=`
`+p}h||p.trim()||(h=!0),i+=C+`
`,e=e.substring(C.length+1),d=p.slice(m)}}o.loose||(l?o.loose=!0:/\n *\n *$/.test(i)&&(l=!0));let g,k=null;this.options.gfm&&(k=/^\[[ xX]\] /.exec(u),k&&(g=k[0]!=="[ ] ",u=u.replace(/^\[[ xX]\] +/,""))),o.items.push({type:"list_item",raw:i,task:!!k,checked:g,loose:!1,text:u,tokens:[]}),o.raw+=i}o.items[o.items.length-1].raw=i.trimEnd(),o.items[o.items.length-1].text=u.trimEnd(),o.raw=o.raw.trimEnd();for(let c=0;c<o.items.length;c++)if(this.lexer.state.top=!1,o.items[c].tokens=this.lexer.blockTokens(o.items[c].text,[]),!o.loose){const d=o.items[c].tokens.filter(m=>m.type==="space"),p=d.length>0&&d.some(m=>/\n.*\n/.test(m.raw));o.loose=p}if(o.loose)for(let c=0;c<o.items.length;c++)o.items[c].loose=!0;return o}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const s=t[(r[2]||r[1]).replace(/\s+/g," ").toLowerCase()];if(!s){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return fr(r,s,r[0],this.lexer)}}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const r=dr(t[1]),s=t[2].replace(/^\||\| *$/g,"").split("|"),o=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],a={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===s.length){for(const i of s)/^ *-+: *$/.test(i)?a.align.push("right"):/^ *:-+: *$/.test(i)?a.align.push("center"):/^ *:-+ *$/.test(i)?a.align.push("left"):a.align.push(null);for(const i of r)a.header.push({text:i,tokens:this.lexer.inline(i)});for(const i of o)a.rows.push(dr(i,a.header.length).map(u=>({text:u,tokens:this.lexer.inline(u)})));return a}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}url(e){var r;let t;if(t=this.rules.inline.url.exec(e)){let s,o;if(t[2]==="@")s=ie(t[0]),o="mailto:"+s;else{let a;do a=t[0],t[0]=((r=this.rules.inline._backpedal.exec(t[0]))==null?void 0:r[0])??"";while(a!==t[0]);s=ie(t[0]),o=t[1]==="www."?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:s,href:o,tokens:[{type:"text",raw:s,text:s}]}}}};var La=Object.defineProperty,qe=(n,e,t)=>((r,s,o)=>s in r?La(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,typeof e!="symbol"?e+"":e,t);let Le=class hn{constructor(e){qe(this,"options"),qe(this,"state"),qe(this,"tokens"),qe(this,"inlineQueue"),qe(this,"tokenizer"),this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ee,this.options.tokenizer=this.options.tokenizer||new Ot,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:mt.normal,inline:Ne.normal};this.options.pedantic?(t.block=mt.pedantic,t.inline=Ne.pedantic):this.options.gfm&&(t.block=mt.gfm,this.options.breaks?t.inline=Ne.breaks:t.inline=Ne.gfm),this.tokenizer.rules=t}static get rules(){return{block:mt,inline:Ne}}static lex(e,t){return new hn(t).lex(e)}static lexInline(e,t){return new hn(t).inlineTokens(e)}blockTokens(e,t=[]){let r,s,o,a;for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,(i,u,l)=>u+"    ".repeat(l.length));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(i=>!!(r=i.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0))))if(r=this.tokenizer.space(e))e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);else if(r=this.tokenizer.code(e))e=e.substring(r.raw.length),s=t[t.length-1],!s||s.type!=="paragraph"&&s.type!=="text"?t.push(r):(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text);else if(r=this.tokenizer.fences(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.heading(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.hr(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.blockquote(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.list(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.html(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.def(e))e=e.substring(r.raw.length),s=t[t.length-1],!s||s.type!=="paragraph"&&s.type!=="text"?this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title}):(s.raw+=`
`+r.raw,s.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text);else if(r=this.tokenizer.table(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.lheading(e))e=e.substring(r.raw.length),t.push(r);else{if(o=e,this.options.extensions&&this.options.extensions.startBlock){let i=1/0;const u=e.slice(1);let l;this.options.extensions.startBlock.forEach(c=>{l=c.call({lexer:this},u),typeof l=="number"&&l>=0&&(i=Math.min(i,l))}),i<1/0&&i>=0&&(o=e.substring(0,i+1))}if(this.state.top&&(r=this.tokenizer.paragraph(o)))s=t[t.length-1],a&&s.type==="paragraph"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r),a=o.length!==e.length,e=e.substring(r.raw.length);else if(r=this.tokenizer.text(e))e=e.substring(r.raw.length),s=t[t.length-1],s&&s.type==="text"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r);else if(e){const i="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(i);break}throw new Error(i)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,s,o,a,i,u,l=e;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(l))!=null;)c.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(l))!=null;)l=l.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(l))!=null;)l=l.slice(0,a.index)+"++"+l.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(i||(u=""),i=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(c=>!!(r=c.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0))))if(r=this.tokenizer.escape(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.tag(e))e=e.substring(r.raw.length),s=t[t.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);else if(r=this.tokenizer.link(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(r.raw.length),s=t[t.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);else if(r=this.tokenizer.emStrong(e,l,u))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.codespan(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.br(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.del(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.autolink(e))e=e.substring(r.raw.length),t.push(r);else if(this.state.inLink||!(r=this.tokenizer.url(e))){if(o=e,this.options.extensions&&this.options.extensions.startInline){let c=1/0;const d=e.slice(1);let p;this.options.extensions.startInline.forEach(m=>{p=m.call({lexer:this},d),typeof p=="number"&&p>=0&&(c=Math.min(c,p))}),c<1/0&&c>=0&&(o=e.substring(0,c+1))}if(r=this.tokenizer.inlineText(o))e=e.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(u=r.raw.slice(-1)),i=!0,s=t[t.length-1],s&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);else if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}throw new Error(c)}}else e=e.substring(r.raw.length),t.push(r);return t}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}};var Ma=Object.defineProperty,Oa=(n,e,t)=>((r,s,o)=>s in r?Ma(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,e+"",t);let $t=class{constructor(e){Oa(this,"options"),this.options=e||Ee}blockquote(e){return`<blockquote>
${e}</blockquote>
`}br(){return"<br>"}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}code(e,t,r){var o;const s=(o=(t||"").match(/^\S*/))==null?void 0:o[0];return e=e.replace(/\n$/,"")+`
`,s?'<pre><code class="language-'+ie(s)+'">'+(r?e:ie(e,!0))+`</code></pre>
`:"<pre><code>"+(r?e:ie(e,!0))+`</code></pre>
`}codespan(e){return`<code>${e}</code>`}del(e){return`<del>${e}</del>`}em(e){return`<em>${e}</em>`}heading(e,t,r){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}html(e,t){return e}image(e,t,r){const s=ur(e);if(s===null)return r;let o=`<img src="${e=s}" alt="${r}"`;return t&&(o+=` title="${t}"`),o+=">",o}link(e,t,r){const s=ur(e);if(s===null)return r;let o='<a href="'+(e=s)+'"';return t&&(o+=' title="'+t+'"'),o+=">"+r+"</a>",o}list(e,t,r){const s=t?"ol":"ul";return"<"+s+(t&&r!==1?' start="'+r+'"':"")+`>
`+e+"</"+s+`>
`}listitem(e,t,r){return`<li>${e}</li>
`}paragraph(e){return`<p>${e}</p>
`}strong(e){return`<strong>${e}</strong>`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablecell(e,t){const r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}tablerow(e){return`<tr>
${e}</tr>
`}text(e){return e}},Hn=class{br(){return""}codespan(e){return e}del(e){return e}em(e){return e}html(e){return e}image(e,t,r){return""+r}link(e,t,r){return""+r}strong(e){return e}text(e){return e}};var $a=Object.defineProperty,rn=(n,e,t)=>((r,s,o)=>s in r?$a(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,typeof e!="symbol"?e+"":e,t);let Me=class mn{constructor(e){rn(this,"options"),rn(this,"renderer"),rn(this,"textRenderer"),this.options=e||Ee,this.options.renderer=this.options.renderer||new $t,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Hn}static parse(e,t){return new mn(t).parse(e)}static parseInline(e,t){return new mn(t).parseInline(e)}parse(e,t=!0){let r="";for(let s=0;s<e.length;s++){const o=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]){const a=o,i=this.options.extensions.renderers[a.type].call({parser:this},a);if(i!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){r+=i||"";continue}}switch(o.type){case"space":continue;case"hr":r+=this.renderer.hr();continue;case"heading":{const a=o;r+=this.renderer.heading(this.parseInline(a.tokens),a.depth,ha(this.parseInline(a.tokens,this.textRenderer)));continue}case"code":{const a=o;r+=this.renderer.code(a.text,a.lang,!!a.escaped);continue}case"table":{const a=o;let i="",u="";for(let c=0;c<a.header.length;c++)u+=this.renderer.tablecell(this.parseInline(a.header[c].tokens),{header:!0,align:a.align[c]});i+=this.renderer.tablerow(u);let l="";for(let c=0;c<a.rows.length;c++){const d=a.rows[c];u="";for(let p=0;p<d.length;p++)u+=this.renderer.tablecell(this.parseInline(d[p].tokens),{header:!1,align:a.align[p]});l+=this.renderer.tablerow(u)}r+=this.renderer.table(i,l);continue}case"blockquote":{const a=o,i=this.parse(a.tokens);r+=this.renderer.blockquote(i);continue}case"list":{const a=o,i=a.ordered,u=a.start,l=a.loose;let c="";for(let d=0;d<a.items.length;d++){const p=a.items[d],m=p.checked,h=p.task;let g="";if(p.task){const k=this.renderer.checkbox(!!m);l?p.tokens.length>0&&p.tokens[0].type==="paragraph"?(p.tokens[0].text=k+" "+p.tokens[0].text,p.tokens[0].tokens&&p.tokens[0].tokens.length>0&&p.tokens[0].tokens[0].type==="text"&&(p.tokens[0].tokens[0].text=k+" "+p.tokens[0].tokens[0].text)):p.tokens.unshift({type:"text",text:k+" "}):g+=k+" "}g+=this.parse(p.tokens,l),c+=this.renderer.listitem(g,h,!!m)}r+=this.renderer.list(c,i,u);continue}case"html":{const a=o;r+=this.renderer.html(a.text,a.block);continue}case"paragraph":{const a=o;r+=this.renderer.paragraph(this.parseInline(a.tokens));continue}case"text":{let a=o,i=a.tokens?this.parseInline(a.tokens):a.text;for(;s+1<e.length&&e[s+1].type==="text";)a=e[++s],i+=`
`+(a.tokens?this.parseInline(a.tokens):a.text);r+=t?this.renderer.paragraph(i):i;continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}parseInline(e,t){t=t||this.renderer;let r="";for(let s=0;s<e.length;s++){const o=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]){const a=this.options.extensions.renderers[o.type].call({parser:this},o);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=a||"";continue}}switch(o.type){case"escape":{const a=o;r+=t.text(a.text);break}case"html":{const a=o;r+=t.html(a.text);break}case"link":{const a=o;r+=t.link(a.href,a.title,this.parseInline(a.tokens,t));break}case"image":{const a=o;r+=t.image(a.href,a.title,a.text);break}case"strong":{const a=o;r+=t.strong(this.parseInline(a.tokens,t));break}case"em":{const a=o;r+=t.em(this.parseInline(a.tokens,t));break}case"codespan":{const a=o;r+=t.codespan(a.text);break}case"br":r+=t.br();break;case"del":{const a=o;r+=t.del(this.parseInline(a.tokens,t));break}case"text":{const a=o;r+=t.text(a.text);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}};var Ke,vr,gn,za=Object.defineProperty,js=n=>{throw TypeError(n)},he=(n,e,t)=>((r,s,o)=>s in r?za(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,typeof e!="symbol"?e+"":e,t),fn=(n,e,t)=>(((r,s,o)=>{s.has(r)||js("Cannot "+o)})(n,e,"access private method"),t);Ke=new WeakSet,vr=function(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){const r="<p>An error occurred:</p><pre>"+ie(t.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(t);throw t}},gn=function(n,e){return(t,r)=>{const s={...r},o={...this.defaults,...s};this.defaults.async===!0&&s.async===!1&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const a=fn(this,Ke,vr).call(this,!!o.silent,!!o.async);if(t==null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(t):t).then(i=>n(i,o)).then(i=>o.hooks?o.hooks.processAllTokens(i):i).then(i=>o.walkTokens?Promise.all(this.walkTokens(i,o.walkTokens)).then(()=>i):i).then(i=>e(i,o)).then(i=>o.hooks?o.hooks.postprocess(i):i).catch(a);try{o.hooks&&(t=o.hooks.preprocess(t));let i=n(t,o);o.hooks&&(i=o.hooks.processAllTokens(i)),o.walkTokens&&this.walkTokens(i,o.walkTokens);let u=e(i,o);return o.hooks&&(u=o.hooks.postprocess(u)),u}catch(i){return a(i)}}};const Ce=new class{constructor(...n){var e,t,r;e=this,(t=Ke).has(e)?js("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),he(this,"Hooks",Xe),he(this,"Lexer",Le),he(this,"Parser",Me),he(this,"Renderer",$t),he(this,"TextRenderer",Hn),he(this,"Tokenizer",Ot),he(this,"defaults",{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}),he(this,"options",this.setOptions),he(this,"parse",fn(this,Ke,gn).call(this,Le.lex,Me.parse)),he(this,"parseInline",fn(this,Ke,gn).call(this,Le.lexInline,Me.parseInline)),this.use(...n)}lexer(n,e){return Le.lex(n,e??this.defaults)}parser(n,e){return Me.parse(n,e??this.defaults)}setOptions(n){return this.defaults={...this.defaults,...n},this}use(...n){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{const r={...t};if(r.async=this.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const o=e.renderers[s.name];e.renderers[s.name]=o?function(...a){let i=s.renderer.apply(this,a);return i===!1&&(i=o.apply(this,a)),i}:s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=e[s.level];o?o.unshift(s.tokenizer):e[s.level]=[s.tokenizer],s.start&&(s.level==="block"?e.startBlock?e.startBlock.push(s.start):e.startBlock=[s.start]:s.level==="inline"&&(e.startInline?e.startInline.push(s.start):e.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(e.childTokens[s.name]=s.childTokens)}),r.extensions=e),t.renderer){const s=this.defaults.renderer||new $t(this.defaults);for(const o in t.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if(o==="options")continue;const a=o,i=t.renderer[a],u=s[a];s[a]=(...l)=>{let c=i.apply(s,l);return c===!1&&(c=u.apply(s,l)),c||""}}r.renderer=s}if(t.tokenizer){const s=this.defaults.tokenizer||new Ot(this.defaults);for(const o in t.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const a=o,i=t.tokenizer[a],u=s[a];s[a]=(...l)=>{let c=i.apply(s,l);return c===!1&&(c=u.apply(s,l)),c}}r.tokenizer=s}if(t.hooks){const s=this.defaults.hooks||new Xe;for(const o in t.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if(o==="options")continue;const a=o,i=t.hooks[a],u=s[a];Xe.passThroughHooks.has(o)?s[a]=l=>{if(this.defaults.async)return Promise.resolve(i.call(s,l)).then(d=>u.call(s,d));const c=i.call(s,l);return u.call(s,c)}:s[a]=(...l)=>{let c=i.apply(s,l);return c===!1&&(c=u.apply(s,l)),c}}r.hooks=s}if(t.walkTokens){const s=this.defaults.walkTokens,o=t.walkTokens;r.walkTokens=function(a){let i=[];return i.push(o.call(this,a)),s&&(i=i.concat(s.call(this,a))),i}}this.defaults={...this.defaults,...r}}),this}walkTokens(n,e){var r,s;let t=[];for(const o of n)switch(t=t.concat(e.call(this,o)),o.type){case"table":{const a=o;for(const i of a.header)t=t.concat(this.walkTokens(i.tokens,e));for(const i of a.rows)for(const u of i)t=t.concat(this.walkTokens(u.tokens,e));break}case"list":{const a=o;t=t.concat(this.walkTokens(a.items,e));break}default:{const a=o;(s=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(i=>{const u=a[i].flat(1/0);t=t.concat(this.walkTokens(u,e))}):a.tokens&&(t=t.concat(this.walkTokens(a.tokens,e)))}}return t}};function F(n,e){return Ce.parse(n,e)}F.options=F.setOptions=function(n){return Ce.setOptions(n),F.defaults=Ce.defaults,cr(F.defaults),F},F.getDefaults=ia,F.defaults=Ee,F.use=function(...n){return Ce.use(...n),F.defaults=Ce.defaults,cr(F.defaults),F},F.walkTokens=function(n,e){return Ce.walkTokens(n,e)},F.parseInline=Ce.parseInline,F.Parser=Me,F.parser=Me.parse,F.Renderer=$t,F.TextRenderer=Hn,F.Lexer=Le,F.lexer=Le.lex,F.Tokenizer=Ot,F.Hooks=Xe,F.parse=F;const Ds=(n,e)=>{const{showCodeBlockCopyButton:t,markdownLinkTarget:r,syntaxHighlighter:s,htmlSanitizer:o}=e||{},a=F(n,{async:!1,breaks:!0});if(typeof a!="string")throw new Error("Markdown parsing failed");const i=document.createElement("div");return i.innerHTML=o?o(a):a,i.querySelectorAll("pre").forEach(u=>{const l=document.createElement("div");l.className="code-block";const c=u.querySelector("code");if(!c){const h=u.innerHTML;return l.innerHTML=o?o(h):h,void u.replaceWith(l)}let d;for(let h=0;h<c.classList.length;h++){const g=c.classList[h];if(g.startsWith("language-")){d=g.slice(9);break}}const p=document.createElement("pre"),m="<div>"+c.innerHTML+"</div>";if(p.innerHTML=e!=null&&e.htmlSanitizer?e.htmlSanitizer(m):m,d&&(p.setAttribute("data-language",d),s)){const h="<div>"+s.createHighlighter()(c.textContent||"",d)+"</div>";p.innerHTML=o?o(h):h,p.className="highlighter-dark"}et(l),l.appendChild(p),u.replaceWith(l)}),t!==!1&&i.querySelectorAll(".code-block").forEach(u=>{var p;if(!u.querySelector("pre")||(p=u.previousElementSibling)!=null&&p.classList.contains("nlux-comp-copyButton"))return;const l="Copy code block to clipboard",c=document.createElement("button");c.classList.add("nlux-comp-copyButton"),c.setAttribute("aria-label",l),c.setAttribute("title",l);const d=document.createElement("span");d.classList.add("icon-copy"),c.appendChild(d),u.appendChild(c)}),r!=="self"&&i.querySelectorAll("a").forEach(u=>{u.setAttribute("target","_blank")}),i.innerHTML},Hs=(n,e="text",t)=>{if(e==="markdown"){const r=document.createElement("div"),s=Ds(n,t);r.innerHTML=t!=null&&t.htmlSanitizer?t.htmlSanitizer(s):s,Ps(r);const o=document.createDocumentFragment();for(;r.firstChild;)o.appendChild(r.firstChild);return o}return document.createTextNode(n)},_s="nlux-comp-message",gt={received:"nlux-comp-chatItem--received",sent:"nlux-comp-chatItem--sent"},Ns=(n,e)=>{Object.keys(gt).forEach(t=>{n.classList.remove(gt[t])}),gt[e]&&n.classList.add(gt[e])},ft={bubbles:"nlux-comp-chatItem--bubblesLayout",list:"nlux-comp-chatItem--listLayout"},qs=(n,e)=>{Object.keys(ft).forEach(t=>{n.classList.remove(ft[t])}),ft[e]&&n.classList.add(ft[e])},Fs="nlux-comp-chatItem-participantInfo",Us="nlux-comp-chatItem-participantName",ja=n=>{const e=document.createElement("div");e.classList.add("nlux-comp-chatItem");const t={direction:n.direction,status:n.status,message:n.message,htmlSanitizer:n.htmlSanitizer};let r;if(n.avatar!==void 0){const a={name:n.name,avatar:n.avatar};r=Mn(a)}const s=document.createElement("span");s.classList.add(Us),s.textContent=n.name;{const a=document.createElement("div");a.classList.add(Fs),r!==void 0&&a.append(r),a.append(s),e.append(a)}Ns(e,n.direction),qs(e,n.layout);const o=(a=>{const i=document.createElement("div");i.classList.add(_s);const u=a.status?a.status:"complete";return Ts(i,u),Es(i,a.direction),i})(t);return e.append(o),e},xr=(n,e,t)=>{if(e.name!==t.name&&typeof t.avatar=="string"){const r=t.name&&t.name.length>0?t.name[0].toUpperCase():"",s=n.querySelector("* > .nlux-comp-avatarContainer > .avtr_ltr");s==null||s.replaceChildren(r)}},Qs=(n,e,t)=>{e.avatar===t.avatar&&e.name===t.name||(e.avatar!==t.avatar&&((r,s,o)=>{if(s.avatar!==o.avatar)if(typeof o.avatar=="string"&&typeof s.avatar=="string"){const a=r.querySelector("* > .nlux-comp-avatarContainer > .nlux-comp-avatarPicture");a!==null&&(a.style.backgroundImage=`url("${encodeURI(o.avatar)}")`)}else if(typeof o.avatar=="string"){const a=Is(o.avatar);r.replaceChildren(a)}else o.avatar?r.replaceChildren(o.avatar.cloneNode(!0)):et(r)})(n,e,t),t.name?e.name!==t.name&&(n.title=t.name,xr(n,e,t)):(n.title="",xr(n,e,t)))},Da=(n,e,t)=>{if(e.message===t.message&&e.status===t.status&&e.direction===t.direction||!t||!t.hasOwnProperty("message")&&!t.hasOwnProperty("status")&&!t.hasOwnProperty("direction"))return;e.direction!==t.direction&&Es(n,t.direction);const r=t.status;if(e.status!==r)return Ts(n,t.status),void((s,o,a)=>{const i=a.status;if(i!=="streaming"&&i==="complete"){const u=a.message?a.message:"",l=document.createTextNode(u);s.classList.add(Ye[i]),et(s),s.append(l)}})(n,0,t);r==="complete"&&(e.message===t.message&&e.format===t.format||((s,o,a)=>{o.message===a.message&&o.format===a.format||(et(s),s.append(Hs(a.message??"",a.format,{htmlSanitizer:a.htmlSanitizer})))})(n,e,t))},Ha=(n,e)=>{let t=!1;const{onComplete:r}=e||{},s=[],o=(e!=null&&e.skipStreamingAnimation?"timeout":"animationFrame")=="timeout"?d=>setTimeout(d,0):d=>requestAnimationFrame(d),a=document.createElement("div");a.classList.add("md-in-progress"),n.append(a);const i=()=>{for(;a.firstChild;){const d=a.firstChild;d instanceof HTMLElement&&Ps(d),a.before(d)}},u=!(e!=null&&e.skipStreamingAnimation)&&(e!=null&&e.streamingAnimationSpeed)&&e.streamingAnimationSpeed>=0?e.streamingAnimationSpeed:e!=null&&e.skipStreamingAnimation?0:8,l={timeSinceLastProcessing:new Date().getTime(),currentMarkdown:"",previousHtml:void 0};let c=setInterval(()=>{const d=new Date().getTime(),p=(e==null?void 0:e.waitTimeBeforeStreamCompletion)!=="never";if(s.length===0&&p){const h=typeof(e==null?void 0:e.waitTimeBeforeStreamCompletion)=="number"?e.waitTimeBeforeStreamCompletion:2e3;return void((t||d-l.timeSinceLastProcessing>h)&&(t=!0,c&&(clearInterval(c),c=void 0),i(),a.remove(),r==null?void 0:r()))}l.timeSinceLastProcessing=d;const m=s.shift();m!==void 0&&typeof m=="string"&&o(()=>{const h=l.currentMarkdown+m,g=Ds(h,e).trim();if(typeof g!="string")return l.currentMarkdown=l.currentMarkdown.slice(0,-m.length),void re("Markdown parsing failed");if(l.previousHtml&&g.length>l.previousHtml.length&&g.startsWith(l.previousHtml)){i();const k=g.slice(l.previousHtml.length).trim();a.innerHTML=e!=null&&e.htmlSanitizer?e.htmlSanitizer(k):k,l.currentMarkdown=m,l.previousHtml=void 0}else a.innerHTML=e!=null&&e.htmlSanitizer?e.htmlSanitizer(g):g,l.currentMarkdown=h,l.previousHtml=g})},u);return{next:d=>{if(t)re("Stream is already complete. No more chunks can be added");else for(const p of d)s.push(p)},complete:()=>{s.push(`
`),t=!0},cancel:()=>{c&&(clearInterval(c),c=void 0),t=!0,a.remove()},error:()=>{t=!0}}},kr="dom/getElement";var _a=Object.defineProperty,Na=Object.getOwnPropertyDescriptor,yr=(n,e,t,r)=>{for(var s,o=r>1?void 0:r?Na(e,t):e,a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&_a(e,t,o),o};let Rt=class extends le{constructor(e,t){super(e,t),this.serverResponse=[],this.stringContent="",t.domProps.message!==void 0&&(this.stringContent=t.domProps.message)}addChunk(e,t){this.throwIfDestroyed(),this.executeDomAction("processStreamedChunk",e),typeof e=="string"&&(this.stringContent+=e),this.serverResponse.push(t)}commitChunks(){this.throwIfDestroyed(),this.executeDomAction("commitStreamedChunks")}getChatSegmentItem(){return this.getProp("domProps").direction==="received"?{uid:this.props.uid,participantRole:"assistant",content:this.getItemContent(),contentType:"text",serverResponse:this.serverResponse,status:"complete",dataTransferMode:"batch",time:new Date}:{uid:this.props.uid,participantRole:"user",content:this.getItemContent(),contentType:"text",status:"complete",time:new Date}}getItemContent(){return this.aiMessageContent??this.stringContent}updateDomProps(e){const t=this.getProp("domProps"),r={...t,...e};this.setProp("domProps",r),this.executeDomAction("updateDomProps",t,r)}updateMarkdownStreamRenderer(e,t){if(this.setProp(e,t),e==="syntaxHighlighter"){const r=t;this.executeDomAction("updateMarkdownStreamRenderer",{syntaxHighlighter:r})}if(e==="htmlSanitizer"){const r=t;this.executeDomAction("updateMarkdownStreamRenderer",{htmlSanitizer:r})}}onMarkdownStreamComplete(e){this.context.emit("messageRendered",{uid:this.props.uid})}};yr([pe("markdown-stream-complete")],Rt.prototype,"onMarkdownStreamComplete",1),Rt=yr([ye("chatItem",({props:n,appendToRoot:e,compEvent:t})=>{const r=ja({...n.domProps,htmlSanitizer:n.htmlSanitizer,message:void 0}),s=((c,d)=>{const p=c.querySelector(d);if(!p)throw new Lt({source:kr,message:`Could not find element with query "${d}". Make sure the query provided matches an element that exists in the root element.`});if(!(p instanceof HTMLElement))throw new Lt({source:kr,message:`Element with query "${d}" is not a valid HTMLElement.`});return p})(r,".nlux-comp-message");if(!s)throw new Error("Message container not found");const o=document.createElement("div");o.classList.add("nlux-markdownStream-root");const a=document.createElement("div");if(a.classList.add("nlux-markdown-container"),a.setAttribute("nlux-message-id",n.uid),o.append(a),s.append(o),n.domProps.message){const c=Hs(n.domProps.message??"","markdown",{markdownLinkTarget:n.markdownLinkTarget,syntaxHighlighter:n.syntaxHighlighter,htmlSanitizer:n.htmlSanitizer});a.append(c)}let i;e(r);let u={...n};const l=c=>((d,p)=>{const m=Ha(d,{syntaxHighlighter:p==null?void 0:p.syntaxHighlighter,htmlSanitizer:p==null?void 0:p.htmlSanitizer,markdownLinkTarget:p==null?void 0:p.markdownLinkTarget,showCodeBlockCopyButton:p==null?void 0:p.showCodeBlockCopyButton,skipStreamingAnimation:p==null?void 0:p.skipStreamingAnimation,streamingAnimationSpeed:p==null?void 0:p.streamingAnimationSpeed,waitTimeBeforeStreamCompletion:p==null?void 0:p.waitTimeBeforeStreamCompletion,onComplete:p==null?void 0:p.onComplete});return{next(h){m.next(h)},complete(){m.complete()}}})(a,{syntaxHighlighter:c.syntaxHighlighter,htmlSanitizer:c.htmlSanitizer,markdownLinkTarget:c.markdownLinkTarget,showCodeBlockCopyButton:c.showCodeBlockCopyButton,skipStreamingAnimation:c.skipStreamingAnimation,streamingAnimationSpeed:c.streamingAnimationSpeed,onComplete:()=>t("markdown-stream-complete")});return{elements:{chatItemContainer:r},actions:{focus:()=>{r.focus()},processStreamedChunk:c=>{i||(i=l(u)),i.next(c)},commitStreamedChunks:()=>{i&&i.complete()},updateMarkdownStreamRenderer:c=>{u={...u,...c},l(u)},updateDomProps:(c,d)=>{((p,m,h)=>{if((m.direction!==h.direction||m.layout!==h.layout||m.status!==h.status||m.message!==h.message||m.name!==h.name||m.avatar!==h.avatar)&&h&&(h.hasOwnProperty("direction")||h.hasOwnProperty("layout")||h.hasOwnProperty("status")||h.hasOwnProperty("message")||h.hasOwnProperty("loader")||h.hasOwnProperty("name")||h.hasOwnProperty("avatar"))){if(m.direction!==h.direction&&Ns(p,h.direction),m.layout!==h.layout&&qs(p,h.layout),m.direction!==h.direction||m.status!==h.status||m.message!==h.message){const g=p.querySelector(`.${_s}`);g&&Da(g,{direction:m.direction,status:m.status,message:m.message,htmlSanitizer:m.htmlSanitizer},{direction:h.direction,status:h.status,message:h.message,htmlSanitizer:m.htmlSanitizer})}if(m.name!==h.name||m.avatar!==h.avatar){const g=p.querySelector(`.${Ln}`);if(!h.name&&!h.avatar)return void(g==null?void 0:g.remove());if(g)Qs(g,{name:m.name,avatar:m.avatar},{name:h.name,avatar:h.avatar});else if(h.name!==void 0||h.avatar!==void 0){const k={name:h.name,avatar:h.avatar},w=Mn(k),f=p.querySelector(`.${Fs}`);f&&f.prepend(w)}}if(m.name!==h.name){const g=p.querySelector(`.${Us}`);g&&(g.textContent=h.name||"")}}})(r,c,d)}},onDestroy:()=>{r.remove(),i=void 0}}},({propName:n,newValue:e,dom:t})=>{var r;switch(n){case"markdownLinkTarget":case"skipStreamingAnimation":case"syntaxHighlighter":case"htmlSanitizer":case"showCodeBlockCopyButton":case"streamingAnimationSpeed":(r=t.actions)==null||r.updateMarkdownStreamRenderer({[n]:e})}})],Rt);const qa=(n,e)=>{let t,r=e,s=n,o=!0;const a=((g,k)=>{let w=!1;if(typeof g!="function")throw new ke({source:"x/throttle",message:"Callback must be a function"});return(...f)=>{w||(g.apply(void 0,f),w=!0,setTimeout(function(){w=!1},k))}})((g=>{let k,w;return f=>{const x=f.target;if(!(x instanceof HTMLElement))return;const{scrollTop:S,clientHeight:C,scrollHeight:T}=x,M=T-30,$=Math.ceil(S+C)>=M,A=k===void 0||w===void 0?void 0:S>k&&w===T?"down":S<k&&w===T?"up":void 0;w=T,k=S,g({scrolledToBottom:$,scrollDirection:A})}})(({scrolledToBottom:g,scrollDirection:k})=>{o?k==="up"&&(o=!1):k==="down"&&g&&(o=!0)}),50),i=g=>{g.addEventListener("scroll",a)},u=g=>{g==null||g.removeEventListener("scroll",a)},l=g=>{(t==null?void 0:t.uid)===g&&(c==null||c.disconnect(),d==null||d.disconnect(),t=void 0,c=void 0,d=void 0)};let c,d;const p=()=>{s==null||s.scrollTo({top:5e4,behavior:"instant"})},m=()=>{s&&r&&o&&p()},h=()=>{m()};return i(s),{updateConversationContainer:g=>{u(s),i(g),s=g},updateProps:({autoScroll:g})=>{r=g},handleNewChatSegmentAdded:(g,k)=>{t&&(c==null||c.disconnect(),d==null||d.disconnect()),t={uid:g,container:k},c=new ResizeObserver(m),c.observe(k),d=new MutationObserver(h),d.observe(k,{childList:!0,subtree:!0,characterData:!0}),r&&p()},handleChatSegmentRemoved:g=>l(g),handleChatSegmentComplete:g=>l(g),destroy:()=>{t&&(l(t.uid),t=void 0),u(s),s=void 0}}},Oe=n=>{var r;const e=typeof n=="function"?n.__compId:void 0;if(!e)throw new Error("Invalid compClass! Component should be registered before using");const t=(r=As.retrieve(e))==null?void 0:r.model;if(!t||typeof t!="function")throw new Error(`Component "${e}" is not registered`);return{withContext:s=>({create:()=>new t(s,{}),withProps:o=>({create:()=>new t(s,o)})})}},Fa=n=>{const e=["adapter","events"],t=Object.keys(n).filter(s=>!e.includes(s)),r={};for(let s=0;s<t.length;s++){const o=t[s];r[o]=n[o]}return r},Gs=()=>{const n=document.createElement("div");n.classList.add("nlux-comp-messageLoader");const e=document.createElement("span");e.classList.add("spinning-loader");const t=document.createElement("div");return t.classList.add("nlux-comp-loaderContainer"),t.appendChild(e),n.appendChild(t),n},sn={typing:"nlux-composer--typing","submitting-prompt":"nlux-composer--submitting","submitting-conversation-starter":"nlux-composer--submitting",waiting:"nlux-composer--waiting"},Ys=(n,e)=>{Object.keys(sn).forEach(t=>{n.classList.remove(sn[t])}),n.classList.add(sn[e])},Ua=n=>{const e=document.createElement("div");e.classList.add("nlux-comp-composer");const t=document.createElement("textarea");t.placeholder=n.placeholder??"",t.value=n.message??"",n.autoFocus&&(t.autofocus=!0);const r=document.createElement("button");return r.append((()=>{const s=document.createElement("div");s.classList.add("nlux-comp-sendIcon");const o=document.createElement("div");return o.classList.add("nlux-comp-sendIcon-container"),s.appendChild(o),s})()),r.append(Gs()),e.append(t),e.append(r),Ys(e,n.status),n.status!=="submitting-conversation-starter"&&n.status!=="submitting-prompt"||(t.disabled=!0,r.disabled=!0),n.status==="waiting"&&(r.disabled=!0),n.status==="typing"&&(r.disabled=n.disableSubmitButton??t.value===""),e},zt=(n,e)=>{let t=!1;const r=e?n.querySelector(e):n,s=r instanceof HTMLElement?r:void 0;if(!s)throw new Lt({source:"dom/listenTo",message:`Could not find element with query "${e}". Make sure the query provided matches an element that exists in the root element.`});const o=new Map,a=new Map,i=()=>{s&&(o.forEach((l,c)=>{s.removeEventListener(c,l)}),o.clear(),a.clear())},u={on:(l,c)=>{if(!c||!s)return u;if(!o.has(l)){const d=p=>{var m;(m=a.get(l))==null||m.forEach(h=>h(p))};o.set(l,d),s.addEventListener(l,d)}return a.has(l)||a.set(l,new Set),a.get(l).add(c),u},get:()=>{if(t)throw new Error("listenTo().get() can only be used once!");return t=!0,[s,i]}};return u},br=n=>{n.style.height="auto",n.style.height=`${n.scrollHeight}px`};var Qa=Object.defineProperty,Ga=Object.getOwnPropertyDescriptor,Fe=(n,e,t,r)=>{for(var s,o=r>1?void 0:r?Ga(e,t):e,a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&Qa(e,t,o),o};let Ae=class extends le{constructor(e,{props:t,eventListeners:r}){super(e,t),this.userEventListeners=r}focusTextInput(){this.executeDomAction("focusTextInput")}handleCommandEnterKeyPressed(e){var r;((r=this.getProp("domCompProps"))==null?void 0:r.submitShortcut)==="CommandEnter"&&(this.handleSendButtonClick(),e==null||e.preventDefault())}handleEnterKeyPressed(e){var r;const t=(r=this.getProp("domCompProps"))==null?void 0:r.submitShortcut;t&&(t!=="Enter"||e!=null&&e.isComposing)||(this.handleSendButtonClick(),e==null||e.preventDefault())}handleSendButtonClick(){var s;const e=this.getProp("domCompProps");if(e!=null&&e.disableSubmitButton||!(e==null?void 0:e.message))return;const r=(s=this.userEventListeners)==null?void 0:s.onSubmit;r&&r()}handleTextChange(e){var s;const t=(s=this.userEventListeners)==null?void 0:s.onTextUpdated;t&&t(e);const r=this.getProp("domCompProps");this.setDomProps({...r,message:e})}handleTextInputUpdated(e){const t=e.target;t instanceof HTMLTextAreaElement&&this.handleTextChange(t.value)}setDomProps(e){this.setProp("domCompProps",e)}};Fe([pe("command-enter-key-pressed")],Ae.prototype,"handleCommandEnterKeyPressed",1),Fe([pe("enter-key-pressed")],Ae.prototype,"handleEnterKeyPressed",1),Fe([pe("send-message-clicked")],Ae.prototype,"handleSendButtonClick",1),Fe([pe("text-updated")],Ae.prototype,"handleTextInputUpdated",1),Ae=Fe([ye("composer",({appendToRoot:n,props:e,compEvent:t})=>{const r=Ua(e.domCompProps);n(r);const[s,o]=zt(r,":scope > textarea").on("input",t("text-updated")).on("keydown",c=>{const d=c.key==="Enter"&&!c.isComposing,p=c.altKey||c.ctrlKey||c.metaKey||c.shiftKey;if(d&&!p)return void t("enter-key-pressed")(c);const m=c.getModifierState("Meta")&&c.key==="Enter",h=c.getModifierState("Control")&&c.key==="Enter";(m||h)&&t("command-enter-key-pressed")(c)}).get(),[a,i]=zt(r,":scope > button").on("click",t("send-message-clicked")).get();if(!(a instanceof HTMLButtonElement))throw new Error("Expected a button element");if(!(s instanceof HTMLTextAreaElement))throw new Lt({source:(u="composer",l="render",`#${u}/${l}`),message:"Expected a textarea element"});var u,l;return{elements:{root:r,textInput:s,sendButton:a},actions:{focusTextInput:()=>ge(()=>{s.focus(),s.setSelectionRange(s.value.length,s.value.length)})},onDestroy:()=>{o(),i()}}},({propName:n,currentValue:e,newValue:t,dom:r})=>{var s;n==="domCompProps"&&((s=r.elements)!=null&&s.root)&&((o,a,i)=>{if(a.status===i.status&&a.message===i.message&&a.placeholder===i.placeholder&&a.autoFocus===i.autoFocus&&a.disableSubmitButton===i.disableSubmitButton)return;const u=o.querySelector("* > textarea");if(a.status!==i.status)return Ys(o,i.status),((l,c,d)=>{if(c.status===d.status)return;const p=l.querySelector("* > textarea");d.status!=="typing"&&d.status!=="waiting"||!p.disabled?d.status!=="submitting-prompt"&&d.status!=="submitting-conversation-starter"||p.disabled||(p.disabled=!0):p.disabled=!1;const m=l.querySelector("* > button");if(d.status==="typing"){const h=(c.disableSubmitButton!==d.disableSubmitButton?d.disableSubmitButton:c.disableSubmitButton)??p.value==="";m.disabled!==h&&(m.disabled=h)}else d.status!=="waiting"&&d.status!=="submitting-prompt"&&d.status!=="submitting-conversation-starter"||m.disabled||(m.disabled=!0);c.placeholder!==d.placeholder&&(p.placeholder=d.placeholder??""),c.message!==d.message&&(p.value=d.message??""),c.autoFocus!==d.autoFocus&&(p.autofocus=d.autoFocus??!1)})(o,a,i),void br(u);if(a.placeholder!==i.placeholder&&(u.placeholder=i.placeholder??""),a.autoFocus!==i.autoFocus&&(u.autofocus=i.autoFocus??!1),a.message!==i.message&&(u.value=i.message??"",br(u)),a.status==="typing"){const l=o.querySelector("* > button"),c=(a.disableSubmitButton!==i.disableSubmitButton?i.disableSubmitButton:a.disableSubmitButton)??u.value==="";l.disabled!==c&&(l.disabled=c)}})(r.elements.root,e,t)})],Ae);const wr=n=>{const e="nlux-chatSegment";return n==="complete"?`${e} nlux-chatSegment--complete`:n==="error"?`${e} nlux-chatSegment--error`:`${e} nlux-chatSegment--active`},vt=(n,e)=>{var t,r;return n==="assistant"?((t=e==null?void 0:e.assistant)==null?void 0:t.name)??"Assistant":n==="user"?((r=e==null?void 0:e.user)==null?void 0:r.name)??"User":""},Ya="bubbles";var Xa=Object.defineProperty,Za=Object.getOwnPropertyDescriptor,xt=(n,e,t,r)=>{for(var s,o=r>1?void 0:r?Za(e,t):e,a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&Xa(e,t,o),o};let Be=class extends le{constructor(e,t){super(e,t),this.chatItemCompIdsByIndex=[],this.chatItemComponentsById=new Map}addChatItem(e){var s,o;if(this.throwIfDestroyed(),this.chatItemComponentsById.has(e.uid))throw new Error(`CompChatSegment: chat item with id "${e.uid}" already exists`);const t=((a,i,u,l)=>{const c=i??Ya;if(a.participantRole==="assistant"){const p=a.status==="complete"?"complete":"streaming";return a.dataTransferMode==="stream"?{status:p,layout:c,direction:"received",name:vt("assistant",{assistant:l}),avatar:l==null?void 0:l.avatar}:a.status==="complete"?{status:p,layout:c,direction:"received",name:vt("assistant",{assistant:l}),avatar:l==null?void 0:l.avatar,message:(d=a.content,typeof d=="string"?d:typeof d=="object"?`${d}`:d==null?"":typeof d.toString=="function"?d.toString():JSON.stringify(d))}:{status:p,layout:c,direction:"received",name:vt("assistant",{assistant:l}),avatar:l==null?void 0:l.avatar}}var d;return{status:"complete",layout:c,direction:"sent",message:a.content,name:vt("user",{user:u}),avatar:u==null?void 0:u.avatar}})(e,this.getProp("conversationLayout"),this.getProp("userPersona"),this.getProp("assistantPersona"));if(!t)throw new Error(`CompChatSegment: chat item with id "${e.uid}" has invalid props`);const r=Oe(Rt).withContext(this.context).withProps({uid:e.uid,domProps:t,markdownLinkTarget:this.getProp("markdownLinkTarget"),showCodeBlockCopyButton:this.getProp("showCodeBlockCopyButton"),skipStreamingAnimation:this.getProp("skipStreamingAnimation"),syntaxHighlighter:this.getProp("syntaxHighlighter"),htmlSanitizer:this.getProp("htmlSanitizer"),streamingAnimationSpeed:this.getProp("streamingAnimationSpeed")}).create();this.chatItemComponentsById.set(e.uid,r),this.chatItemCompIdsByIndex.push(e.uid),this.rendered&&((o=(s=this.renderedDom)==null?void 0:s.elements)!=null&&o.chatSegmentContainer?r.render(this.renderedDom.elements.chatSegmentContainer,this.renderedDom.elements.loaderContainer):dn("CompChatSegment: chatSegmentContainer is not available"))}addChunk(e,t,r){if(this.destroyed)return;const s=this.chatItemComponentsById.get(e);if(!s)throw new Error(`CompChatSegment: chat item with id "${e}" not found`);s.addChunk(t,r)}complete(){this.throwIfDestroyed(),this.chatItemComponentsById.forEach(e=>e.commitChunks()),this.setProp("status","complete")}destroy(){this.chatItemComponentsById.forEach(e=>e.destroy()),this.chatItemComponentsById.clear(),this.chatItemCompIdsByIndex=[],super.destroy()}getChatItems(){return this.chatItemCompIdsByIndex.map(e=>this.chatItemComponentsById.get(e)).filter(e=>!!e)}onLoaderShown(e){var t;(t=this.renderedDom)!=null&&t.elements&&(this.renderedDom.elements.loaderContainer=e)}setAssistantPersona(e){this.setProp("assistantPersona",e);const t={name:e==null?void 0:e.name,avatar:e==null?void 0:e.avatar};this.chatItemComponentsById.forEach(r=>{r.getChatSegmentItem().participantRole==="assistant"&&r.updateDomProps(t)})}setLayout(e){this.setProp("conversationLayout",e),this.chatItemComponentsById.forEach(t=>{t.updateDomProps({layout:e})})}setUserPersona(e){this.setProp("userPersona",e);const t={name:e==null?void 0:e.name,avatar:e==null?void 0:e.avatar};this.chatItemComponentsById.forEach(r=>{r.getChatSegmentItem().participantRole==="user"&&r.updateDomProps(t)})}updateMarkdownStreamRenderer(e,t){this.setProp(e,t)}setProp(e,t){super.setProp(e,t),e!=="markdownLinkTarget"&&e!=="syntaxHighlighter"&&e!=="htmlSanitizer"&&e!=="skipStreamingAnimation"&&e!=="streamingAnimationSpeed"||this.chatItemComponentsById.forEach(r=>{r.updateMarkdownStreamRenderer(e,t)})}onChatSegmentReady(){ge(()=>{var t,r,s,o;if(!((r=(t=this.renderedDom)==null?void 0:t.elements)!=null&&r.chatSegmentContainer))return;const e=(o=(s=this.renderedDom)==null?void 0:s.elements)==null?void 0:o.chatSegmentContainer;this.chatItemComponentsById.forEach(a=>{a.rendered||a.render(e)})})}onLoaderHidden(){var e;(e=this.renderedDom)!=null&&e.elements&&(this.renderedDom.elements.loaderContainer=void 0)}};xt([pe("loader-shown")],Be.prototype,"onLoaderShown",1),xt([pe("chat-segment-ready")],Be.prototype,"onChatSegmentReady",1),xt([pe("loader-hidden")],Be.prototype,"onLoaderHidden",1),Be=xt([ye("chatSegment",({props:n,compEvent:e,appendToRoot:t})=>{let r;const s=document.createElement("div");s.className=wr(n.status);const o=()=>{if(!r){r=document.createElement("div"),r.className="nlux-chatSegment-loader-container";const a=Gs();r.appendChild(a),s.appendChild(r),e("loader-shown")(r)}};return n.status==="active"&&o(),t(s),e("chat-segment-ready")(),{elements:{chatSegmentContainer:s,loaderContainer:r},actions:{showLoader:o,hideLoader:()=>{r&&(r.remove(),r=void 0,e("loader-hidden")())}},onDestroy:()=>{s.remove()}}},({propName:n,newValue:e,dom:t})=>{var r,s,o;if(n==="status"){const a=(r=t.elements)==null?void 0:r.chatSegmentContainer;if(!a)return;const i=e;a.className=wr(i),i==="active"?(s=t.actions)==null||s.showLoader():(o=t.actions)==null||o.hideLoader()}})],Be);let vn=class extends le{constructor(e,t){super(e,t),this.chatSegmentCompIdsByIndex=[],this.chatSegmentComponentsById=new Map,t.messages&&t.messages.length>0&&this.addChatSegment("complete",t.messages)}addChatItem(e,t){const r=this.chatSegmentComponentsById.get(e);if(!r)throw new Error(`CompConversation: chat segment with id "${e}" not found`);r.destroyed?dn(`CompConversation: chat segment with id "${e}" is destroyed and cannot be used`):r.addChatItem(t)}addChatSegment(e="active",t){this.throwIfDestroyed();const r=de(),s=Oe(Be).withContext(this.context).withProps({uid:r,status:e,conversationLayout:this.getProp("conversationLayout"),userPersona:this.getProp("userPersona"),assistantPersona:this.getProp("assistantPersona"),markdownLinkTarget:this.getProp("markdownLinkTarget"),showCodeBlockCopyButton:this.getProp("showCodeBlockCopyButton"),skipStreamingAnimation:this.getProp("skipStreamingAnimation"),syntaxHighlighter:this.getProp("syntaxHighlighter"),htmlSanitizer:this.getProp("htmlSanitizer"),streamingAnimationSpeed:this.getProp("streamingAnimationSpeed")}).create();if(t)for(const a of t)a.role==="assistant"?s.addChatItem({uid:de(),participantRole:"assistant",time:new Date,dataTransferMode:"batch",status:"complete",content:a.message,serverResponse:a.serverResponse,contentType:"text"}):a.role==="user"&&s.addChatItem({uid:de(),participantRole:"user",time:new Date,status:"complete",content:a.message,contentType:"text"});this.chatSegmentComponentsById.set(r,s),this.chatSegmentCompIdsByIndex.push(r);const o=s.id;return this.addSubComponent(o,s,"segmentsContainer"),this.notifyAboutSegmentCountChange(this.chatSegmentCompIdsByIndex.length),r}addChunk(e,t,r,s){const o=this.chatSegmentComponentsById.get(e);if(!o)throw new Error(`CompConversation: chat segment with id "${e}" not found`);o.addChunk(t,r,s)}completeChatSegment(e){const t=this.chatSegmentComponentsById.get(e);if(!t)throw new Error(`CompConversation: chat segment with id "${e}" not found`);t.destroyed||t.complete()}getChatSegmentContainer(e){const t=this.chatSegmentComponentsById.get(e);if((t==null?void 0:t.root)instanceof HTMLElement)return t.root}getConversationContentForAdapter(e="max"){if(typeof e=="number"&&e<0)return void dn(`Invalid value provided for 'historyPayloadSize' : "${e}"! Value must be a positive integer or 'max'.`);if(e===0)return;const t=(r=>{const s=[];return r.forEach(o=>{o.items.forEach(a=>{if(a.status==="complete"){if(a.participantRole==="assistant")s.push({role:"assistant",message:a.content});else if(a.participantRole==="user")return s.push({role:"user",message:a.content})}})}),s})(this.chatSegmentCompIdsByIndex.map(r=>this.chatSegmentComponentsById.get(r)).filter(r=>r!==void 0).map(r=>({uid:r.id,status:"complete",items:r.getChatItems().map(s=>s.getChatSegmentItem())})));return e==="max"?t:t.slice(-e)}removeChatSegment(e){const t=this.chatSegmentComponentsById.get(e);if(!t)return;const r=t.id;this.subComponents.has(r)&&this.removeSubComponent(r),this.chatSegmentComponentsById.delete(t.id);const s=this.chatSegmentCompIdsByIndex.indexOf(e);s>=0&&this.chatSegmentCompIdsByIndex.splice(s,1),this.notifyAboutSegmentCountChange(this.chatSegmentCompIdsByIndex.length)}setAssistantPersona(e){this.setProp("assistantPersona",e),this.chatSegmentComponentsById.forEach(t=>{t.setAssistantPersona(e)})}setConversationLayout(e){this.setProp("conversationLayout",e),this.chatSegmentComponentsById.forEach(t=>{t.setLayout(e)})}setUserPersona(e){this.setProp("userPersona",e),this.chatSegmentComponentsById.forEach(t=>{t.setUserPersona(e)})}updateMarkdownStreamRenderer(e,t){this.setProp(e,t)}setProp(e,t){if(super.setProp(e,t),e==="markdownLinkTarget"||e==="syntaxHighlighter"||e==="htmlSanitizer"||e==="skipStreamingAnimation"||e==="streamingAnimationSpeed"||e==="showCodeBlockCopyButton"){const r=e,s=t;this.chatSegmentComponentsById.forEach(o=>{o.updateMarkdownStreamRenderer(r,s)})}}notifyAboutSegmentCountChange(e){const t=this.getProp("onSegmentCountChange");t&&t(e)}};vn=((n,e,t,r)=>{for(var s,o=e,a=n.length-1;a>=0;a--)(s=n[a])&&(o=s(o)||o);return o})([ye("conversation",({appendToRoot:n})=>{const e=document.createElement("div");return e.classList.add("nlux-chatSegments-container"),n(e),{elements:{segmentsContainer:e},actions:{}}},()=>{})],vn);var Ka=Object.defineProperty,Ja=Object.getOwnPropertyDescriptor,Sr=(n,e,t,r)=>{for(var s,o=r>1?void 0:r?Ja(e,t):e,a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&Ka(e,t,o),o};let Bt=class extends le{constructor(e,t){super(e,t),this.updateConversationStarters=r=>{}}conversationStarterClicked(e){this.getProp("onConversationStarterSelected")(e)}};Sr([pe("conversation-starter-selected")],Bt.prototype,"conversationStarterClicked",1),Bt=Sr([ye("conversationStarters",({appendToRoot:n,props:e,compEvent:t})=>{const r=(o=>{const a=document.createElement("div");return a.classList.add("nlux-comp-conversationStarters"),o.forEach((i,u)=>{const l=document.createElement("button");l.classList.add("nlux-comp-conversationStarter");let c=document.createElement("div");i.icon&&(typeof i.icon=="string"?(c=document.createElement("img"),c.setAttribute("src",i.icon),c.setAttribute("width","16px")):(c.className="nlux-comp-conversationStarter-icon-container",c.appendChild(i.icon)));const d=document.createElement("span");d.classList.add("nlux-comp-conversationStarter-prompt"),d.textContent=i.label??i.prompt,l.appendChild(c),l.appendChild(d),a.appendChild(l)}),a})(e.conversationStarters);n(r);let s=[];return e.conversationStarters.forEach((o,a)=>{const[i,u]=zt(r,`:scope > :nth-child(${a+1})`).on("click",()=>{t("conversation-starter-selected")(o)}).get();s.push(u)}),{elements:{},actions:{},onDestroy:()=>{s.forEach(o=>o()),s=[],r.remove()}}},({})=>{})],Bt);const Cr="nlux-comp-welcomeMessage-text",Xs=(n,e)=>{const t=n.querySelector(`.${Cr}`);if(e!==""&&e!==void 0)if(t)t.textContent=e;else{const r=document.createElement("div");r.classList.add(Cr),r.textContent=e,n.appendChild(r)}else t==null||t.remove()},Zs="nlux-comp-welcomeMessage-personaName",xn=n=>{const e=document.createElement("div");e.classList.add("nlux-comp-welcomeMessage");const t=Mn({name:n.name,avatar:n.avatar});e.append(t);const r=document.createElement("div"),s=document.createTextNode(n.name);return r.append(s),r.classList.add(Zs),e.append(r),Xs(e,n.message),e},Ar=()=>xn({name:"",avatar:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAABGdBTUEAALGPC/xhBQAACklpQ0NQc1JHQiBJRUM2MTk2Ni0yLjEAAEiJnVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/stRzjPAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAJcEhZcwAAewgAAHsIAXgkHaEAABj0SURBVHic7Z13vBxV2ce/Z29ugEQMEAICQUBAkBqqlCiRKqC0gApKE14poh8VUCmihv4SCB2CVAtFQBR9UZpCaMIL0ouAGIIEQgsJya27e/zjmb117+yUc+bM7J7v53Nys3dnzjx3dn9z2nOeR2mt8Xg89Sm5NsDjyTNeIB5PCF4gHk8IXiAeTwheIB5PCF4gHk8IXiAeTwheIB5PCF4gHk8IXiAeTwheIB5PCF4gHk8IXiAeTwheIB5PCF4gHk8IXiAeTwheIB5PCKNsVdwzY4Ktqgej+v6RHwpQ8lqr2jFD3q+9UAPrGHDcwN8F6JD3hr1m0LHjgYnAWsAqwGrA8sDKwNLAOGAMsCTQPuDkMtANdAALgUXAPOBtYC4wB5gNvI5m7gBLhxjOiK8VwMAdpQOPrf1eD31PD/5dcJwa8lr+P+D4Ie8pCxtZ249/z3id1gTSoowHNgEmBWUDNGsBYy1eswy8BrwIPAs8BTyBiMeTEi+QdCwFfA6YAmwLbAaMHf7Ytsoo4NNB2XPA758GHgHuB2bBwFbGExUvkPisAOwK7ALsAKyQrR4is3FQjgR6EaH8CfgL8E+HdhUKL5BoLAHsBUwFdkczxq05sWkHdgwKiFhuBm7DtyyheIGEsyFwMHCA0nol18YYZLugnAfcAlwD3OPUopziBVKf3dEcCXzJtSGWGQ0cEJTHgV8A1wI9Dm3KFX4dZDD7A48iffVmF8dQNgdmAv8CTkCmoFseLxDhq8CTaH09Wm+J1rRwmYjWZyBC+TEy/mpZWl0gOwEPorkRzaT+BS1f0ExAcybwKvCtNDe5yLSqQNYAbkZzF5ptc/BlzHOZiGYm0vXcKukNLyqtKJD9gRdB7+v6m1ewsiXoR4CTE931gtJKAvkEcAua69Es4f77VthyKuLOsk3cD6CItIpADgReRjM1B1+wZigbo3kIOCPm51A4mn0dZDRwFVp/w7UhTcoJyETHQYizZNPRzALZXMGNwJquDWlyNgeeAw5DFhmbimYVyBHA5WjXZrQMJcRdZUvgaMe2GKUZBXIZWh/p2ogW5SjEf20v4H23ppiheQSiWBL4E5odXJvS4kxGNm7tiuxJKTTNIpBV0PwNWNu1IR4AVkKmgr8I3OnWlHTYE8iwfdqGGD6uWA/0LGS7qydf/AX4BvAb14YkxZ5AqtZqFkSAWwctR0s71OWcXwPLAhe7NiQJ1gSiKnamkHTf0qaaDDxg5SIe01yErEmd59qQuBR1DLI1WntxFItzkX7F+Y7tiEURXU0mAQ+5NsKTiBnIGlVhKFYLolgDzcPYmwLw2Ody4EPgJsd2RMKeQLThMYji42j+riQWlafY3Ai8hWaWa0MaYVEgButSgOYBJCaVpzn4G7AWmn+7NiSMYnSxNLcBG7k2w2OUEjKWXJ0cR1HJdxdLRho/Q3x7PM3HSsDdwHZ5dSzNexdrd+CnRmry5JXPA+eiOda1IfXIcxdrRTS3uzbCkwk/QMKh5u7zznMX6y7ys07TDTwJvAC8gkxTdiIxb5dGIqtvCHyWfD908sxtwIqA+SQfKcjrh3kG+RiU3wr8DvgrkrimEasAOyN74L9g0a5mpATcgWy6yg1Km16vCOg9bdlkJyq2AB4zakx8LgQuQPFaorPllu4AnIL0sT3ROREJWBeb9pPnm7bFpkCWSXimmovMbrjgLuBYFM+JKQlr0YP+fwzirOeJjP400pWNRfvJHxq3xJ43bzLdzQBnaQaO04pzLXixXKy0noUExF7VdOVNyu+QMZ1z7A2C48daWg/N9xzEeOpGxg3n2roVwDPARmieyUFMqyKUDYDvxD7PAnmZJQL4rYNrfoCkKbvb6lWkUfoQ2AIRi6cRmguBZVybYXFHYQxJK74JrG/Nlvp8BGyGUrMzvGYPmm1Av4qEQvWEcxWaqS4NyMM07yh05tsxe4FtUBmkShZHSyT3BgCLgc+h+Sf5asHzyD7AlmjtbFYzDwuF15O1C7tSnwee6/vijrK4vaQKDN9+/CqyK/JRexduGn4PrOzq4m4H6dL/38+aDfX5X+Dvfa+0li9wnC5hFJSITpUrUvfwTE6PAd81e9GmZCXgOFcXt7YOUj7l41EOewAJNJYVz1JvhV4H/7S3oUeV+lu/NA2LVqieClSrfWIZgUfJ2epxDukAxgHlsINGTVto/MIWW5C6T82BZXM0kzOePtwtdHqwtwrlavqlkJJClatSH6qRTfvlYFo172UMmh81/E5ZwGUXa3rGySm/D/o/oTe3qlFdZekShT/1R6ZNich6ysHdbXgj5qD12TlI3pn3ciKattBbaQFrAlHhZX0F2zU4xlzRvAicH3oTNX0th+pJ2IoooKIpdVZQOrh2NULRnKA0CzO7H8UsYxR8O+wYG7hqQX6eaRMNBygNkYpSqN4qqrsCpRi3XQFKUeqsyKBfqThPNQ0cl4OuTN7LSVRhxGIBFwuFy6MyXfy5AQmkHAvVXUGPLolIosxwlRSqqwK9gbDi94l/Afwcd46aRWAFYE80f8jqgi4WquL72KRrPY6JbaECtKbUUZaWoNF4pKRQZY3qLMvJye09PgdP6byXE8I/DLO4WCj8trVrDmc6Wn2Q7FQFPRXU4l70Um2hhwHQ0SstTRs1YSbhN8DZyMYrT30+i+zgfDmLi2XdguxKdmkKysApqR5XJYVa3CuD9lEj3KpSCdVZ7h+zJBdHjT+mrqH5OSqrC2U9SD86w6b4TDSdqetpK6E6yjJ1O6qEbh9QlmiDSlXeL5VM2X1dDroxeS8Ho1HDfm+BLMP+LIuE8cmCHpShHN4KEUFXBb0UlDrL/X9bSUFZB+MUI1cD+DuapxE3HE99at+lP9m+UJZjkP2wN109lIuArtS1aEQEo0qU3u/qdx3RA94f3UZ13GgRibmcKGcjTpyekTmQDARizRerctyYob/6K9lF+hiPbIZKR5uCKqiPumWMoZT8TiHiCFoXVElEMrpNumIm0HyAPCk99elA7k9f2NK26R3GL5LVIH05shPHLzEljrKm9GGXiGNUqV8c0P+zTZwbSx92oxb3BouLqaZ6ay3UL1L/Dc3NGCRJqFUsBm0Y1DLtYes6wy/M6anO14gYequoBd39r8MIFgbVRz3Sooxtly5musb5YuCHqWpofqZiORpjVi3IbhldZxaal1M9uUvB+seCbqmxLeKwSclYRXWUUYuClqTWFUvGG0gYIs/IHASMtXmBLGaxSsCO1q4zmNNSnd2mpOVY2CNf7ji+WDVGlaBLnBX12HZx8EouknOQiCue+jyI5YmfLGaxtiCbweabpIlO0iZOiiwMxnxJxDGgLrrK4q84ph10NalI7kH+Lr+yPpw7Ucr6GCSLhcLtM1o8ujDxuUoG5OqjQBxRu1VhtJVQnRXZX5J0b4kwIwcLc3krj5DBAB2yGYN8LoNraGBmorMCb93Sop7+1yZQoEsKtbgsriqlxDNbM7HmzF1I3gCmZHUx212sNsS5zDa3AgtinzVQHBUtU7YmCcYxalEP+mPt0F5Kspi4CHFiPNCscYVkIRIMvAcN8gTB6ijEdhdrPTTLZdDkxu+GBDaqjl5xFzHVcgwlqLa0qBd6ddKW5MwcdGtcl/mI+83sure5104ja3sWaxNr9ffzGoqHY59VKqG6yqjuqt24WNDfUnX0Uh07WkQTxHOIyItoHgK2tWVizqkAW1EaIA5N315b1V016eYzCIuRFTVoJtmrP0BxOTrOF1ye4qqnIhucbLUcQwkcG1VHL3rMKLEj3kPvdCTBTCuyA6iX++5XTRwaiR5TrprvHgfYTn9gP4S95ur+PlMEFBK9pKPc/zoralPJXRX0Um2oeE+9PwNzgE/aMS63HKPh/mEPFI3cv4rF7jH2u1jrWqtf+APwfuSjg8AKqm/3X5bqCCgp8e1qU0kG7afSWj5aN6G4pO6nVNVSLM/D2pzFmghMtFY/gFKXRD5WB0+anir0OBIH9LVYqrOMVu3yAVc1kZoyxVVoPR2JMtjsvIlSX6vbOdBBy5HBR2hTf2tYrBs089D67khBx6rBzawEgeEcaaOPUuBG31Vm0JRaoyJ7E9I5YxYBzUJgu4afZwbYnOZdzeq0H1wZ41gg6NpUcC8QkDvfq2UGRsWa+p2BpisH0662ygfApsC/6t63kUMwrTDSG2mwGZt3ouVQlDMjH6tA9VZkHSIkQEnmlIDuqtgWhBqKUMpoPS0HoUBtlPlonUQce6D1LTY+IpuDdJsOdg8iLgeNCWat6DYQlNo0NXtqrUh09/izgROBj1myzAWdwBYoXq/7blWH3ZvrgCVsGGWzizXeYvcqRkYqJb5Q8t/8URu091Ti3IMqmhNz0B0y+ZluS1jLUR3x3IPRLIO2EyfL5iyWrRx8H4G6OdKRqraQpNM+ClZFgpWtDiyP7HlfEom99T4wF3gJeE7si4kCKuIuodtV1FX2i9CcBKwY+3p5Q7ELWj0JBGIZ0lSMHDehDbg0+P9oG6bZzFG4jKV6f43Wjdega12r3sTi2BHYE/FG3pBaLeFdoPlI9+92xIFyfuSrlZBZthLo6AHo/gfLW04z4BDCdk6GBxU5A9mbzoCfRrEW1YTD214C1jFer2JD5EndmLIeeUpwYCyrvp9qLBK175vAZ1JaugC4EjgXrd8C+r/0mvofvAZKSJariCjNw8DW6Ux1g4afopgmr4Z/SCr8u7kcgxeJ53Jlxfi412YXy4ai/4FWjcVRaz3izZcfjdanYK7LMg44FjgamAac1fCMwIlRlXWchcz90Xp2Qhtdcp1Salq/BgaLQdXrag1m6HqQlS6WzUH6khYGchdGOjCeONZDciVegmZFCwPQpYAzkVyEjVulmrgrVSJOjb4O/Mz5IDtemQUcgtaoEYr8bSOePwHNkUN+Z+Vhb3Ml3bSiO9HcEOkDiJ6x9lDgeWq5Em0hdm2JdA2/2vD42nTvyDM3Q8vPySjauQFepVGMtMafxU/q/M7Kd9nmOohpg69hQBS9kOs2RlqWc9CZpxcuATcis2LTGx6tNTH6iLshX748Mx/YhjBH/8af3xJIt3UoVibxXeQHSYbiVGN1aW4H/WVj9cXnHMTT+fCGR0YXyb9A7wnZZV+KySsodgb1LlBfCHqkNwZxJhn6Q7jIMJWE69G8Ham70Zg7AJfiqHEYkadoo3buuZ1sExRF5U0k/NPs8MMafoAfA75vwqCo2BRIxWBd6QLC9fN7JIlPXvgycJnhOi9FotvnhbeBzYAFouOQCYfGhInfyqZ0mwJpPF6IxqPAiwbq+SWy8Jc3jgS+Y7jO75KP9An/RuISzDNUX1jrYfKB3IdNgXQaquenBuo4j3yHzbkQ2MpwnV9HwgW54lFgEtKCmGB3wteoyoauMwibAllsoI5XgDtT1nEsGfdbE3IX5j1SvwFcYLjOKPwKEfxCg3U2mnE01WMZhE2BmMhmcnLK8/chynRqPlga8d8yzfeQblwWaCTt9kGG612dxtEUew1fE7ArkPdSnv8f4Lcpzt8CO184m+yORA40zUyku/OQhbpr3IF4JUSPExCdKDNzprr0g7ApkHdSnv+DFOeuBNyf8vqusNUlehqYDByBhA8yxYPIbNzuiMu/DQ6LcExLCeQ1INqej+G0Aw8DS6W4vksmIW7strgCWBNZpLwvYR2vI+GHvoBsB7CZTHNvoqXPiL8PJwI294P8J8W5ab4g9yF91iJzGeKSYuVDR2Z8rgrK2siXfAuki7QyMh6qBUjtQB52s4EngVnIDJVN77WBRJ0Cf9fGxfMokPuRjLhJuBXx9Sk6bci44YAMrvVKUK4e8Luao6nG0uA3IqsQPfnrXBsG2OxizU54XtL1iiuQWatmYX+yCN1an56guBQHwLdiHFt/P3tKbArkNeLf4FOIGq1kMNOx2293xTWuDXBMY2fOfl6zYYBNgcwnnvv1C5DIY/cMZDGwGdmMfPmOZckUZDwUFSszaLa9eeMYnSTn3HnACQnOKxKXuzbAEXH80+Yhfl/GsS2QZyIety/xu1anUwwXkrR8EvGraiXGIdO7UXmWAnrzAjwV4ZgTib/iPSU4r1U4z7UBGXMg8XYIPm3LENsCeaLB+6cjO8TisAytl2lpBeINWIvOUTGP/4cVK7AvkDcYeXbheJI5I/6V4q6Sp+EM1wZkxKbIgmUcHrNhCGSz5XZogs1XgZ1I5mV7A9kkBs0jE4jmk1R04m4ZnoPFYBVZCOTR4OdLSKuxDnBPgnpmAF8zZVRBMbX1OK+MRhZI4zDLhiE1bLqa1LgJmc1K84eciexraHU+gQxgf+XaEEscSPzuc1K3pEhk0YK8SzpxnAz82JAtzUAzp2BLMm2fpDcSmbyH/TmQZKvrzcyqNJfPWY1JwPoxz3meZK5JkcmzQL6ERCLxDOds1wZYIEmUyz8at2IIeRXIXmTwxxeYtYCdXRthkKVJ5tpvJS/hQPIokKOA21wbUQDOcW2AQY4gfmzdN2i8EJ2avAnkMvpTannC2Qg7AR5ckKR7lSagR2TyIpDtkdQAWYWnaRaaYSyyD8mSFl1n2pB6uBbIpsje63uJP4PhkeBsm7s2IiVJImc+j3jwWieLhcKhrI3sG/8KktPCk44ZSNCFIrIt0lWMy0zThoyEC4HcgOyU85hhMtISW/NotUiSLmIVuNawHSPioot1rYNrNjs2ohnaZiOkBYnL9dgLhzQMFwK5BLNBjT0yFpns2oiYJI0gmenEhAuBaNxEHG92MuuXG2ATGgejrsdjyGxnZriaxZpOdpH5WoX1kImPIpBUzJkH6HAlkIW0brQOm1zs2oAIfBEJcxqXl7Hs2l4Pl+sgJjJHeQYzAZjm2ogGXJnwPCexz1wK5F2KOfuSd36CpH/IIyci8Xbj8hJ2I8iPiOuV9JMcX79ZudG1AXWYQPLNXseYNCQOrgWygNYI/pY1n0cy3eaJPyc8707EFckJrgUCcD7iW+MxywXILr08cDXJvSf2NWlIXPIgEJBsrB7z/J9rAxBv3UMTnns8sMigLbHJi0CeonkjdbhkZdzmSl+d5IlU55CDDMV5EQhIfg8riRhbnAOQHXtZsyTwQIrz9zNlSBryJJBukmeX8oRzOdmnpnsAmJjw3KuwGE40DnkSCEhznHS2wxPOfcCnMrxW0o1cH5CjbGF5EwjIrEW3ayOakHYkDGzSp3oUPg48AmyXoo69yJGfXh4F0kG85Cme6CyPbKxa00LdmyHbYLdKUce5pBu3GCePAgHpZnk3FDtMQBLOTDFY57HA40g2rKQ8T7LoJlbJq0BA3Asy2ZjfgowF/gb8KGU9OyHpLdJOx+qgrtyRZ4EA7Ijk6/bY4SzgIeQ+R2UMkobiXuAuYGsDduwBvGWgHuO4CNoQh3eQ/QOZ7wNoIbYB7gYeRIKxPYBkjF0MLAGMR+JWbYhET9kNSQlnip/hyFM3CkprSxMGh8SNJBnKMcBFJiv0hLIAcfFYElgWez2NWzC5IHit+e9y3rtYNS6mGLvlmoVxyL6N8dj7jjxBTlbLwyiKQEASy//OtREeI8yhIHGFiyQQgKlYzknnsc6HyFpJh2M7IlE0gYCs0j7u2ghPIjqBz5LTGat6FFEgIFOLT7o2whOLbkQcL7s2JA5FFUgZudn/79oQTySqyOdVuIXfogoEoBe56fe7NsTTkMMR95bCUWSBgLgoTAF+79YMTwhzgGtcG5GUogukxt5I+jZP/rCax9w2zSIQgKOBH7o2wjMMp0EX0tJMAgHJ/LoX3sExT6zu2oA0NJtAAP4AbIBESvG4J0mKtdzQjAIBeAXJQXGFa0M8rI6EHyokzSqQGkcgQekWuzakxVnPtQFJaXaBgAROWwfpenncsIFrA5LSCgIBeBMZvB+Gz4/oAi+QgnA18GkkYrgnOz7j2oCktJpAAOYh23gPBd5wbEursC4Sl6twtKJAalwLrI1kZPLdLrssB6zl2ogktLJAQFywT0MCqZ1FwVd9c866rg1IQqsLpMZ7SIrhNZEkmPPcmtOUFHLB0AtkMO8g2Xc/BXwbCSzQClSwvwW2kGshXiD16QAuRSKUb4+MVz5yaZAl7gC+DqwBrIbs1DwBO6kHxlio0zpFiYuVB8YjEQD3BnYBRrs1JzGPALche2heCTlucySC4lTMOBxegu1stRbiYnmBJGMlYGckZOcU7KYUSMsiZNflX5C9GS8lqGNP4CtBSRqNczIS5tQeXiC5pA3Z+jsZCWezKdJdccX7wDNILpCHkODSHxiqe1Xgm4hQ4owp7iVe/N9keIEUhvWBjZF4tusgawCfRCIWmqILeB2YDfwTCYjwNPAC2Thn7oDkP9wLWecYiReALTOxyQuk0IxDumYrBz+XRRLajEeCRI9GVptLyF77XmTjVw8SbO09pCWYB8wF3kZm3VwzDhHJVMTnanlkVuwtxKXneCQKjX0KJRCPpwnw07weTwheIB5PCF4gHk8IXiAeTwheIB5PCF4gHk8IXiAeTwheIB5PCF4gHk8IXiAeTwheIB5PCF4gHk8IXiAeTwheIB5PCF4gHk8IXiAeTwj/Ba/47FkhCYEqAAAAAElFTkSuQmCC"});let kn=class extends le{constructor(n,e){super(n,e),this.setConversationStarters(e.conversationStarters)}setAssistantPersona(n){this.setProp("assistantPersona",n),this.executeDomAction("updateAssistantPersona",n)}setConversationStarters(n){var e;if(n||this.conversationStartersComp){if(n&&!this.conversationStartersComp){const t=this.getProp("onConversationStarterSelected");return this.conversationStartersComp=Oe(Bt).withContext(this.context).withProps({conversationStarters:n,onConversationStarterSelected:t}).create(),void this.addSubComponent(this.conversationStartersComp.id,this.conversationStartersComp,"conversationStartersContainer")}!n&&this.conversationStartersComp?(this.removeSubComponent(this.conversationStartersComp.id),this.conversationStartersComp=void 0):(e=this.conversationStartersComp)==null||e.updateConversationStarters(n)}}setShowGreeting(n){this.setProp("showGreeting",n),this.executeDomAction("resetGreeting",n)}resetConversationStarters(){const n=this.getProp("conversationStarters");this.setConversationStarters(n)}};kn=((n,e,t,r)=>{for(var s,o=e,a=n.length-1;a>=0;a--)(s=n[a])&&(o=s(o)||o);return o})([ye("launchPad",({appendToRoot:n,props:e})=>{const t={assistantPersona:e.assistantPersona,conversationStarters:e.conversationStarters,showGreeting:e.showGreeting!==!1};let r;if(t.showGreeting)if(e.assistantPersona){const a=e.assistantPersona;r=xn({name:a.name,avatar:a.avatar,message:a.tagline})}else r=Ar();r&&(n(r),t.greetingElement=r);const s=document.createElement("div");s.classList.add("nlux-conversationStarters-container"),n(s);const o=(a=!0)=>{t.showGreeting=a,t.greetingElement&&(t.greetingElement.remove(),t.greetingElement=void 0),a&&(t.greetingElement=t.assistantPersona?xn({name:t.assistantPersona.name,avatar:t.assistantPersona.avatar,message:t.assistantPersona.tagline}):Ar(),t.greetingElement&&s.insertAdjacentElement("beforebegin",t.greetingElement))};return{elements:{conversationStartersContainer:s},actions:{resetGreeting:(a=!0)=>{o(a)},updateAssistantPersona:a=>{const i=t.assistantPersona;t.assistantPersona=a,(i||a)&&t.showGreeting&&(a&&i?((u,l,c)=>{if(l.message!==c.message||l.name!==c.name||l.avatar!==c.avatar){if(l.message!==c.message&&Xs(u,c.message),l.name!==c.name){const d=u.querySelector(`.${Zs}`);if(d){const p=document.createTextNode(c.name);d.replaceChildren(p)}}if(l.avatar!==c.avatar||l.name!==c.name){const d=u.querySelector(`.${Ln}`);d&&Qs(d,{name:l.name,avatar:l.avatar},{name:c.name,avatar:c.avatar})}}})(t.greetingElement,{name:i==null?void 0:i.name,avatar:i==null?void 0:i.avatar,message:i==null?void 0:i.tagline},{name:a.name,avatar:a.avatar,message:a.tagline}):o())}},onDestroy:()=>{var a;(a=t.greetingElement)==null||a.remove(),s.remove()}}},({})=>{})],kn);const yn=n=>{if(typeof n!="object"||n===null)return!1;const e=n;return(typeof e.streamText=="function"||typeof e.batchText=="function")&&["stream","batch"].includes(e.dataTransferMode)&&typeof e.id=="string"&&typeof e.info=="object"&&e.info!==null&&typeof e.preProcessAiBatchedMessage=="function"&&typeof e.preProcessAiStreamedChunk=="function"};var ds;const Wa=typeof navigator<"u"&&((ds=navigator==null?void 0:navigator.userAgent)!=null&&ds.includes("Safari"))?100:1,J=(n,e=Wa)=>{setTimeout(()=>{n()},e)},Va=(n,e,t,r,s,o,a,i,u)=>new Promise(l=>{const c=de(),d=[],p=[];let m=!1,h=!1,g=!1;const k=yn(t),w={next:f=>{if(h||g)return;let x,S;if(k){const C=f,T=t.preProcessAiStreamedChunk(C,r);T!=null&&(x=T,S=C,d.push(x),p.push(S))}else x=f,d.push(x);x!=null?(m||m||(m=!0,J(()=>{s.forEach(C=>{C({uid:c,status:"streaming",time:new Date,participantRole:"assistant",dataTransferMode:"stream"})})})),J(()=>{a.forEach(C=>{C({chunk:x,messageId:c,serverResponse:S})})})):re("Adapter returned an undefined or null value from streamText. This chunk will be ignored.")},complete:()=>{h||g||(g=!0,J(()=>{const f={uid:c,status:"complete",content:d,contentType:"text",serverResponse:void 0,time:new Date,participantRole:"assistant",dataTransferMode:"stream"};o.forEach(x=>{x(f)}),l()}),J(()=>{const f={uid:n,status:"complete",items:[e,{uid:c,status:"complete",contentType:"text",content:d,serverResponse:p,time:new Date,participantRole:"assistant",dataTransferMode:"stream"}]};i.forEach(x=>{x(f)})}))},error:f=>{h||g||(h=!0,J(()=>{u.forEach(x=>{x("failed-to-stream-content",f)}),l()}))}};t.streamText(e.content,w,r)}),ei=(n,e,t)=>{if(!n)return(()=>{const f=new Set,x=de(),S={uid:x,status:"complete",items:[]};return J(()=>{f.forEach(C=>{C(S)}),f.clear()}),{segment:S,observable:{on:(C,T)=>{C==="complete"&&f.add(T)},removeListener:(C,T)=>{f.delete(T)},destroy:()=>{f.clear()},get segmentId(){return x}},dataTransferMode:"batch"}})();const r=e;if(r.streamText===void 0&&r.batchText===void 0&&r.streamServerComponent===void 0)return(f=>{const x=new Set,S=de(),C={uid:S,status:"error",items:[]};return J(()=>{x.forEach(T=>T(f)),x.clear()}),{segment:C,dataTransferMode:"stream",observable:{on:(T,M)=>{T==="error"&&x.add(M)},removeListener:(T,M)=>{x.delete(M)},destroy:()=>{x.clear()},get segmentId(){return S}}}})("no-data-transfer-mode-supported");const s=de(),o=(f=>({uid:de(),time:new Date,status:"complete",participantRole:"user",content:f,contentType:"text"}))(n);let a,i,u,l,c,d,p=new Set,m=new Set,h=new Set;J(()=>{p!=null&&p.size&&(p.forEach(f=>{f(o)}),p.clear(),p=void 0)});const g=(f=>{const x=[],S=f,C=f;(S==null?void 0:S.streamText)===void 0&&(C==null?void 0:C.streamServerComponent)===void 0||x.push("stream"),(S==null?void 0:S.batchText)!==void 0&&x.push("batch");const T=yn(f)?f:void 0,M=(T==null?void 0:T.dataTransferMode)??void 0,$=x.length===1?x[0]:"stream";return M??$})(e);(f=>"streamServerComponent"in f?"server-component":"text")(e)==="server-component"?(u=new Set,i=new Set,((f,x,S,C,T,M,$,A)=>new Promise((I,B)=>{try{const E=x.content,R=de(),O="assistant",X="streaming",ae=new Date,Y="stream";let Z,z;const _=()=>{J(()=>{M.forEach(ue=>{Z&&z&&ue({...Z,content:z,status:"complete"})})},20);const V={uid:f,status:"complete",items:[x,Z]};J(()=>{$.forEach(ue=>{ue(V)}),I()},20)},te=()=>{A.forEach(V=>{V("failed-to-stream-server-component",new Error("Failed to load content"))})};z=S.streamServerComponent(E,C,{onServerComponentReceived:_,onError:te}),Z={uid:R,content:z,contentType:"server-component",participantRole:O,status:X,time:ae,dataTransferMode:Y},J(()=>{T.forEach(V=>{V(Z)})},10)}catch(E){re(E);const R=E instanceof Error?E:typeof E=="string"?new Error(E):new Error("Unknown error");J(()=>{A.forEach(O=>O("failed-to-load-content",R))})}}))(s,o,e,t,i,u,m,h).finally(()=>{J(()=>w())})):g==="batch"?(a=new Set,(async(f,x,S,C,T,M,$)=>{try{const A=x.content,I=yn(S)?S:void 0,B=I!==void 0,E=de(),R="assistant",O="complete",X=new Date,ae="batch";let Y;if(B){const _=await I.batchText(A,C),te=I.preProcessAiBatchedMessage(_,C);te!=null&&(Y={uid:E,content:te,contentType:"text",serverResponse:_,participantRole:R,status:O,time:X,dataTransferMode:ae})}else Y={uid:E,content:await S.batchText(A,C),contentType:"text",serverResponse:void 0,participantRole:R,status:O,time:X,dataTransferMode:ae};if(!Y)throw new Error("Response from adapter was undefined or cannot be processed");const Z=Y;J(()=>{T.forEach(_=>{_(Z)})});const z={uid:f,status:"complete",items:[x,Y]};J(()=>{M.forEach(_=>{_(z)})})}catch(A){re(A);const I=A instanceof Error?A:typeof A=="string"?new Error(A):new Error("Unknown error");J(()=>{$.forEach(B=>B("failed-to-load-content",I))})}})(s,o,e,t,a,m,h).finally(()=>{J(()=>w())})):(l=new Set,c=new Set,d=new Set,Va(s,o,e,t,l,c,d,m,h).finally(()=>{J(()=>w())}));const w=()=>{p==null||p.clear(),p=void 0,a==null||a.clear(),a=void 0,i==null||i.clear(),i=void 0,u==null||u.clear(),u=void 0,l==null||l.clear(),l=void 0,c==null||c.clear(),c=void 0,d==null||d.clear(),d=void 0,m==null||m.clear(),m=void 0,h==null||h.clear(),h=void 0};return{segment:{status:"active",uid:s,items:[]},dataTransferMode:g,observable:{get segmentId(){return s},on:(f,x)=>{f==="userMessageReceived"&&p?p.add(x):f==="aiMessageReceived"&&a?a.add(x):f==="aiServerComponentStreamStarted"&&i?i.add(x):f==="aiServerComponentStreamed"&&u?u.add(x):f==="aiMessageStreamStarted"&&l?l.add(x):f==="aiMessageStreamed"&&c?c.add(x):f==="aiChunkReceived"&&d?d.add(x):f==="complete"&&m?m.add(x):f==="error"&&h&&h.add(x)},removeListener:(f,x)=>{f!=="userMessageReceived"?f!=="aiMessageReceived"?f!=="aiMessageStreamStarted"?f!=="aiMessageStreamed"?f!=="aiChunkReceived"?f!=="complete"?f!=="error"||(h==null||h.delete(x)):m==null||m.delete(x):d==null||d.delete(x):c==null||c.delete(x):l==null||l.delete(x):a==null||a.delete(x):p==null||p.delete(x)},destroy:()=>w()}}},ti={"data-transfer-mode-not-supported":"Requested data transfer mode is not supported","no-data-transfer-mode-supported":"Adapter does not support any valid data transfer modes","connection-error":"Connection error","invalid-credentials":"Invalid credentials","invalid-api-key":"Invalid API key","http-server-side-error":"HTTP server side error","http-client-side-error":"HTTP client side error","failed-to-load-content":"Failed to load content","failed-to-stream-content":"Failed to stream content","failed-to-stream-server-component":"Failed to stream server component","failed-to-render-content":"Failed to display content"},bn=(n,e)=>n!==void 0&&n.length>0||e!==void 0&&e>0?"active":"starting";var ni=Object.defineProperty,ri=Object.getOwnPropertyDescriptor,on=(n,e,t,r)=>{for(var s,o=r>1?void 0:r?ri(e,t):e,a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&ni(e,t,o),o};let kt=class extends le{constructor(n,{conversationLayout:e,autoScroll:t,streamingAnimationSpeed:r,visible:s=!0,composer:o,assistantPersona:a,userPersona:i,showGreeting:u,conversationStarters:l,initialConversationContent:c,syntaxHighlighter:d,htmlSanitizer:p,markdownLinkTarget:m,showCodeBlockCopyButton:h,skipStreamingAnimation:g}){if(super(n,{conversationLayout:e,visible:s,autoScroll:t,streamingAnimationSpeed:r,assistantPersona:a,userPersona:i,conversationStarters:l,showGreeting:u,initialConversationContent:c,composer:o,syntaxHighlighter:d,htmlSanitizer:p,markdownLinkTarget:m,showCodeBlockCopyButton:h,skipStreamingAnimation:g}),this.handleConversationStarterClick=k=>{this.composer.setDomProps({status:"submitting-conversation-starter"}),this.composer.handleTextChange(k.prompt),this.composer.handleSendButtonClick()},this.handleSegmentCountChange=k=>{var f,x;if(this.segmentCount===k)return;this.segmentCount=k;const w=bn(this.getProp("initialConversationContent")||void 0,this.segmentCount);this.chatRoomStatus!==w&&(this.chatRoomStatus=w,this.executeDomAction("updateChatRoomStatus",this.chatRoomStatus),this.chatRoomStatus==="active"?(f=this.launchPad)!=null&&f.id&&(this.removeSubComponent((x=this.launchPad)==null?void 0:x.id),this.launchPad=void 0):this.addLaunchPad(this.getProp("showGreeting")??!0,this.getProp("assistantPersona"),this.getProp("conversationStarters"),this.handleConversationStarterClick))},this.prompt="",this.segmentCount=c&&c.length>0?1:0,this.chatRoomStatus=bn(c,this.segmentCount),this.chatRoomStatus==="starting"&&this.addLaunchPad(u,a,l,this.handleConversationStarterClick),this.addConversation(a,i,c),this.addComposer(o==null?void 0:o.placeholder,o==null?void 0:o.autoFocus,o==null?void 0:o.disableSubmitButton,o==null?void 0:o.submitShortcut),!this.conversation||!this.composer)throw new Error("Chat room not initialized — An error occurred while initializing key components.")}getConversationContentForAdapter(n="max"){return this.conversation.getConversationContentForAdapter(n)}hide(){this.setProp("visible",!1)}messagesContainerClicked(){var n;(n=this.composer)==null||n.focusTextInput()}onChatRoomReady(){ge(()=>{var e,t;const n=(t=(e=this.renderedDom)==null?void 0:e.elements)==null?void 0:t.conversationContainer;if(n instanceof HTMLElement){this.autoScrollController=qa(n,this.getProp("autoScroll")??!0);let r=0;const s=20,o=()=>{n.scrollHeight>n.clientHeight&&(n.scrollTo({behavior:"smooth",top:5e4}),clearInterval(a))},a=setInterval(()=>{r>=s?clearInterval(a):(o(),r++)},10)}this.context.emit("ready",{aiChatProps:Fa(this.context.aiChatProps)})})}setProps(n){var e,t,r,s,o,a,i;if(n.hasOwnProperty("autoScroll")){const u=n.autoScroll;(e=this.autoScrollController)==null||e.updateProps({autoScroll:u})}if(n.hasOwnProperty("conversationLayout")&&((t=this.conversation)==null||t.setConversationLayout(n.conversationLayout)),n.hasOwnProperty("syntaxHighlighter")&&this.setProp("syntaxHighlighter",n.syntaxHighlighter),n.hasOwnProperty("htmlSanitizer")&&this.setProp("htmlSanitizer",n.htmlSanitizer),n.hasOwnProperty("markdownLinkTarget")&&this.setProp("markdownLinkTarget",n.markdownLinkTarget),n.hasOwnProperty("skipStreamingAnimation")&&this.setProp("skipStreamingAnimation",n.skipStreamingAnimation),n.hasOwnProperty("streamingAnimationSpeed")&&this.setProp("streamingAnimationSpeed",n.streamingAnimationSpeed),n.hasOwnProperty("assistantPersona")&&((r=this.conversation)==null||r.setAssistantPersona(n.assistantPersona??void 0),(s=this.launchPad)==null||s.setAssistantPersona(n.assistantPersona??void 0)),n.hasOwnProperty("userPersona")&&((o=this.conversation)==null||o.setUserPersona(n.userPersona??void 0)),n.hasOwnProperty("showGreeting")&&((a=this.launchPad)==null||a.setShowGreeting(n.showGreeting??!0)),n.hasOwnProperty("conversationStarters")&&((i=this.launchPad)==null||i.setConversationStarters(n.conversationStarters)),n.hasOwnProperty("composer")&&this.composer){const u={...this.composer.getProp("domCompProps"),...n.composer};this.composer.setDomProps(u)}}show(){this.setProp("visible",!0)}setProp(n,e){if(super.setProp(n,e),n==="markdownLinkTarget"||n==="syntaxHighlighter"||n==="htmlSanitizer"||n==="skipStreamingAnimation"||n==="streamingAnimationSpeed"){const t=n,r=e;this.conversation.updateMarkdownStreamRenderer(t,r)}}addComposer(n,e,t,r){this.composer=Oe(Ae).withContext(this.context).withProps({props:{domCompProps:{status:"typing",placeholder:n,autoFocus:e,disableSubmitButton:t,submitShortcut:r}},eventListeners:{onTextUpdated:s=>this.handleComposerTextChange(s),onSubmit:()=>this.handleComposerSubmit()}}).create(),this.addSubComponent(this.composer.id,this.composer,"composerContainer")}addConversation(n,e,t){this.conversation=Oe(vn).withContext(this.context).withProps({assistantPersona:n,userPersona:e,messages:t,conversationLayout:this.getProp("conversationLayout"),markdownLinkTarget:this.getProp("markdownLinkTarget"),showCodeBlockCopyButton:this.getProp("showCodeBlockCopyButton"),skipStreamingAnimation:this.getProp("skipStreamingAnimation"),streamingAnimationSpeed:this.getProp("streamingAnimationSpeed"),syntaxHighlighter:this.getProp("syntaxHighlighter"),htmlSanitizer:this.getProp("htmlSanitizer"),onSegmentCountChange:this.handleSegmentCountChange}).create(),this.addSubComponent(this.conversation.id,this.conversation,"conversationContainer")}addLaunchPad(n,e,t,r){this.launchPad=Oe(kn).withContext(this.context).withProps({showGreeting:n,assistantPersona:e,conversationStarters:t,onConversationStarterSelected:r}).create(),this.addSubComponent(this.launchPad.id,this.launchPad,"launchPadContainer")}handleComposerSubmit(){const n=this.props.composer;(({context:e,composerInstance:t,conversation:r,autoScrollController:s,messageToSend:o,resetComposer:a,setComposerAsWaiting:i})=>()=>{var l,c;const u=r.addChatSegment();try{const d=t.getProp("domCompProps");t.setDomProps({...d,status:"submitting-prompt"});const p={aiChatProps:e.aiChatProps,conversationHistory:r.getConversationContentForAdapter((c=(l=e.aiChatProps)==null?void 0:l.conversationOptions)==null?void 0:c.historyPayloadSize)},m=ei(o,e.adapter,p);m.observable.on("error",(h,g)=>{r.removeChatSegment(u),s==null||s.handleChatSegmentRemoved(u),a(!1),e.exception(h),e.emit("error",{errorId:h,message:ti[h],errorObject:g})}),m.observable.on("userMessageReceived",h=>{r.addChatItem(u,h),e.emit("messageSent",{uid:h.uid,message:h.content}),ge(()=>{if(s){const g=r.getChatSegmentContainer(u);g&&s.handleNewChatSegmentAdded(u,g)}})}),m.dataTransferMode==="batch"?m.observable.on("aiMessageReceived",h=>{const g=typeof h.content=="string",k={...h,content:g?"":h.content};r.addChatItem(u,k),g&&r.addChunk(u,k.uid,h.content,h.serverResponse),r.completeChatSegment(u),e.emit("messageReceived",{uid:h.uid,message:h.content}),a(!0)}):(m.observable.on("aiMessageStreamStarted",h=>{r.addChatItem(u,h),i(),e.emit("messageStreamStarted",{uid:h.uid})}),m.observable.on("aiChunkReceived",h=>{const{messageId:g,chunk:k,serverResponse:w}=h;r.addChunk(u,g,k,w)}),m.observable.on("aiMessageStreamed",h=>{h.status==="complete"&&e.emit("messageReceived",{uid:h.uid,message:h.content})}),m.observable.on("aiServerComponentStreamStarted",h=>{r.addChatItem(u,h),i(),e.emit("messageStreamStarted",{uid:h.uid})}),m.observable.on("aiServerComponentStreamed",h=>{h.status==="complete"&&e.emit("messageReceived",{uid:h.uid,message:h.content})}),m.observable.on("complete",()=>{r.completeChatSegment(u),a(!1)}))}catch(d){re(d),a(!1)}})({context:this.context,composerInstance:this.composer,conversation:this.conversation,messageToSend:this.prompt,autoScrollController:this.autoScrollController,resetComposer:e=>{this.destroyed||this.resetComposer(e,n==null?void 0:n.autoFocus)},setComposerAsWaiting:()=>{this.destroyed||this.composer.setDomProps({status:"waiting"})}})()}handleComposerTextChange(n){this.prompt=n}resetComposer(n=!1,e=!1){if(!this.composer)return;const t={...this.composer.getProp("domCompProps"),status:"typing"};n&&(t.message=""),this.composer.setDomProps(t),e&&this.composer.focusTextInput()}};on([pe("conversation-container-clicked")],kt.prototype,"messagesContainerClicked",1),on([pe("chat-room-ready")],kt.prototype,"onChatRoomReady",1),kt=on([ye("chatRoom",({appendToRoot:n,compEvent:e,props:t})=>{const r=document.createElement("div");r.classList.add("nlux-conversation-container");const s=document.createElement("div");s.classList.add("nlux-composer-container");const o=document.createElement("div");o.classList.add("nlux-launchPad-container");const a=document.createDocumentFragment();a.appendChild(o),a.appendChild(r),a.appendChild(s);const i=t.visible??!0,u=document.createElement("div"),l=p=>{u.classList.remove("nlux-chatRoom-starting"),u.classList.remove("nlux-chatRoom-active"),u.classList.add(`nlux-chatRoom-${p}`)};u.classList.add("nlux-chatRoom-container"),l(bn(t.initialConversationContent)),u.append(a),u.style.display=i?"":"none";const[c,d]=zt(u,":scope > .nlux-conversation-container").on("click",e("conversation-container-clicked")).get();return n(u),e("chat-room-ready")(),{elements:{composerContainer:s,conversationContainer:r,launchPadContainer:o},actions:{updateChatRoomStatus:p=>{l(p)}},onDestroy:()=>{d()}}},({propName:n,newValue:e,dom:{elements:t}})=>{})],kt);const si=n=>{const e=new Set;let t=!1,r=null,s=null;const o=()=>{if(t||e.size===0)return;t=!0;const i=e.values().next().value;e.delete(i),r=(({message:u})=>{const l=document.createElement("div");l.classList.add("nlux-comp-exceptionItem");const c=document.createElement("span");return c.classList.add("nlux-comp-exp_itm_msg"),c.append(document.createTextNode(u)),l.append(c),l})(i),n.append(r),s=setTimeout(a,3e3)},a=()=>{r==null||r.classList.add("nlux-comp-exceptionItem--hiding"),s=setTimeout(()=>{t=!1,r==null||r.remove(),r=null,o()},500)};return{displayException:i=>{e.add({message:i}),t||o()},destroy:()=>{e.clear(),r==null||r.remove(),s&&clearTimeout(s)}}};let Ir=class extends le{constructor(n,e){super(n,e)}destroy(){super.destroy()}showAlert(n,e){this.executeDomAction("displayException",e)}};Ir=((n,e,t,r)=>{for(var s,o=e,a=n.length-1;a>=0;a--)(s=n[a])&&(o=s(o)||o);return o})([ye("exceptionsBox",({props:n,appendToRoot:e})=>{const t=(()=>{const s=document.createElement("div");return s.classList.add("nlux-comp-exceptionBox"),s})();e(t);let r=si(t);return{elements:{root:t},actions:{displayException:s=>{r==null||r.displayException(s)}},onDestroy:()=>{r==null||r.destroy(),t.remove(),r=void 0}}},()=>{})],Ir);const oi=n=>{const e=new Set;let t=!1,r=null,s=null;const o=()=>{if(t||e.size===0)return;t=!0;const i=e.values().next().value;e.delete(i),r=(({message:u})=>{const l=document.createElement("div");l.classList.add("nlux-comp-exceptionItem");const c=document.createElement("span");return c.classList.add("nlux-comp-exp_itm_msg"),c.append(document.createTextNode(u)),l.append(c),l})(i),n.append(r),s=setTimeout(a,3e3)},a=()=>{r==null||r.classList.add("nlux-comp-exceptionItem--hiding"),s=setTimeout(()=>{t=!1,r==null||r.remove(),r=null,o()},500)};return{displayException:i=>{e.add({message:i}),t||o()},destroy:()=>{e.clear(),r==null||r.remove(),s&&clearTimeout(s)}}},fe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=16*Math.random()|0;return(n=="x"?e:3&e|8).toString(16)}),oe=n=>{typeof n!="string"?n&&typeof n.toString=="function"?console.warn(`[nlux] ${n.toString()}`):console.warn("[nlux]"):console.warn(`[nlux] ${n}`)},Er=[],tt=n=>{Er.includes(n)||(Er.push(n),oe(n))},ai={typing:"nlux-composer--typing","submitting-prompt":"nlux-composer--submitting","submitting-conversation-starter":"nlux-composer--submitting",waiting:"nlux-composer--waiting"},Ks=(n,e)=>{if(!e||e==="Enter"){const t=n.key==="Enter"&&!n.nativeEvent.isComposing,r=n.altKey||n.ctrlKey||n.metaKey||n.shiftKey;return t&&!r}return!!(e==="CommandEnter"&&n.key==="Enter"&&(n.getModifierState("Control")||n.getModifierState("Meta")))},ii=()=>b.jsx("div",{className:"nlux-comp-cancelIcon",children:b.jsx("div",{className:"nlux-comp-cancelIcon-container"})}),ci=()=>b.jsx("div",{className:"nlux-comp-sendIcon",children:b.jsx("div",{className:"nlux-comp-sendIcon-container"})}),an=["submitting-prompt","submitting-edit","submitting-conversation-starter","submitting-external-message"],li=n=>{const e=`nlux-comp-composer ${ai[n.status]||""}`,t=an.includes(n.status),r=!n.hasValidInput||n.status==="waiting"||an.includes(n.status),s=n.status==="typing"||n.status==="waiting",o=n.hideStopButton!==!0&&(an.includes(n.status)||n.status==="waiting"),a=v.useRef(null);v.useEffect(()=>{n.status==="typing"&&n.autoFocus&&a.current&&a.current.focus()},[n.status,n.autoFocus,a.current]);const i=v.useMemo(()=>c=>{var d;(d=n.onChange)==null||d.call(n,c.target.value)},[n.onChange]),u=v.useMemo(()=>()=>{var c;(c=n.onSubmit)==null||c.call(n)},[n.onSubmit]),l=v.useMemo(()=>c=>{Ks(c,n.submitShortcut)&&(c.preventDefault(),u())},[u,n.submitShortcut]);return v.useEffect(()=>{if(!a.current)return;const c=()=>{const d=a.current;d&&(d.style.height="auto",d.style.height=`${d.scrollHeight}px`)};return a.current.addEventListener("input",c),()=>{var d;(d=a.current)==null||d.removeEventListener("input",c)}},[a.current]),b.jsxs("div",{className:e,children:[b.jsx("textarea",{tabIndex:0,ref:a,disabled:t,placeholder:n.placeholder,value:n.prompt,onChange:i,onKeyDown:l,"aria-label":n.placeholder}),!o&&b.jsxs("button",{tabIndex:0,disabled:r,onClick:()=>n.onSubmit(),"aria-label":"Send",children:[s&&b.jsx(ci,{}),!s&&n.Loader]}),o&&b.jsx("button",{tabIndex:0,onClick:n.onCancel,"aria-label":"Cancel",children:b.jsx(ii,{})})]})},yt=(n,e)=>{var t,r;return n==="assistant"?((t=e==null?void 0:e.assistant)==null?void 0:t.name)??"Assistant":n==="user"?((r=e==null?void 0:e.user)==null?void 0:r.name)??"User":""},ui=n=>{const e="nlux-chatSegment";return n==="complete"?`${e} nlux-chatSegment--complete`:n==="error"?`${e} nlux-chatSegment--error`:`${e} nlux-chatSegment--active`},wn={received:"nlux_msg_received",sent:"nlux_msg_sent"},Sn={streaming:"nlux_msg_streaming",complete:"nlux_msg_complete"},Tr=n=>{if(!(n instanceof HTMLButtonElement)||n.dataset.clickListenerSet==="true")return;let e=!1;const t=n.nextElementSibling;n.addEventListener("click",()=>{if(e||!t)return;const r=t.innerText;navigator.clipboard.writeText(r??""),e=!0,n.classList.add("clicked"),setTimeout(()=>{e=!1,n.classList.remove("clicked")},1e3)}),n.dataset.clickListenerSet="true"},Js=n=>{const e="nlux-comp-copyButton";n instanceof HTMLButtonElement&&n.classList.contains(e)?Tr(n):n.querySelectorAll(`.${e}`).forEach(Tr)};function di(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Te={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function Pr(n){Te=n}var pi=Object.defineProperty,Ws=(n,e,t)=>((r,s,o)=>s in r?pi(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,typeof e!="symbol"?e+"":e,t);class Je{constructor(e){Ws(this,"options"),this.options=e||Te}postprocess(e){return e}preprocess(e){return e}processAllTokens(e){return e}}Ws(Je,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));const Vs=/[&<>"']/,hi=new RegExp(Vs.source,"g"),eo=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,mi=new RegExp(eo.source,"g"),gi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Rr=n=>gi[n];function ce(n,e){if(e){if(Vs.test(n))return n.replace(hi,Rr)}else if(eo.test(n))return n.replace(mi,Rr);return n}const fi=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function vi(n){return n.replace(fi,(e,t)=>(t=t.toLowerCase())==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):"")}const xi=/(^|[^\[])\^/g;function H(n,e){let t=typeof n=="string"?n:n.source;e=e||"";const r={replace:(s,o)=>{let a=typeof o=="string"?o:o.source;return a=a.replace(xi,"$1"),t=t.replace(s,a),r},getRegex:()=>new RegExp(t,e)};return r}function Br(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const We={exec:()=>null};function Lr(n,e){const t=n.replace(/\|/g,(s,o,a)=>{let i=!1,u=o;for(;--u>=0&&a[u]==="\\";)i=!i;return i?"|":" |"}).split(/ \|/);let r=0;if(t[0].trim()||t.shift(),t.length>0&&!t[t.length-1].trim()&&t.pop(),e)if(t.length>e)t.splice(e);else for(;t.length<e;)t.push("");for(;r<t.length;r++)t[r]=t[r].trim().replace(/\\\|/g,"|");return t}function bt(n,e,t){const r=n.length;if(r===0)return"";let s=0;for(;s<r;){const o=n.charAt(r-s-1);if(o!==e||t){if(o===e||!t)break;s++}else s++}return n.slice(0,r-s)}const ot=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,to=/(?:[*+-]|\d{1,9}[.)])/,no=H(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,to).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),_n=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Nn=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ki=H(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",Nn).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),yi=H(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,to).getRegex(),Gt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",qn=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,bi=H("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",qn).replace("tag",Gt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Mr=H(_n).replace("hr",ot).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Gt).getRegex(),Fn={blockquote:H(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Mr).getRegex(),code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,def:ki,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:ot,html:bi,lheading:no,list:yi,newline:/^(?: *(?:\n|$))+/,paragraph:Mr,table:We,text:/^[^\n]+/},Or=H("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ot).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Gt).getRegex(),wi={...Fn,table:Or,paragraph:H(_n).replace("hr",ot).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Or).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Gt).getRegex()},Si={...Fn,html:H(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",qn).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:We,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:H(_n).replace("hr",ot).replace("heading",` *#{1,6} *[^
]`).replace("lheading",no).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},ro=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,so=/^( {2,}|\\)\n(?!\s*$)/,at="\\p{P}\\p{S}",Ci=H(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,at).getRegex(),Ai=H(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,at).getRegex(),Ii=H("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,at).getRegex(),Ei=H("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,at).getRegex(),Ti=H(/\\([punct])/,"gu").replace(/punct/g,at).getRegex(),Pi=H(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Ri=H(qn).replace("(?:-->|$)","-->").getRegex(),Bi=H("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Ri).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),jt=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Li=H(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",jt).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),$r=H(/^!?\[(label)\]\[(ref)\]/).replace("label",jt).replace("ref",Nn).getRegex(),zr=H(/^!?\[(ref)\](?:\[\])?/).replace("ref",Nn).getRegex(),Un={_backpedal:We,anyPunctuation:Ti,autolink:Pi,blockSkip:/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,br:so,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:We,emStrongLDelim:Ai,emStrongRDelimAst:Ii,emStrongRDelimUnd:Ei,escape:ro,link:Li,nolink:zr,punctuation:Ci,reflink:$r,reflinkSearch:H("reflink|nolink(?!\\()","g").replace("reflink",$r).replace("nolink",zr).getRegex(),tag:Bi,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:We},Mi={...Un,link:H(/^!?\[(label)\]\((.*?)\)/).replace("label",jt).getRegex(),reflink:H(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",jt).getRegex()},Cn={...Un,escape:H(ro).replace("])","~|])").getRegex(),url:H(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Oi={...Cn,br:H(so).replace("{2,}","*").getRegex(),text:H(Cn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},wt={normal:Fn,gfm:wi,pedantic:Si},Ue={normal:Un,gfm:Cn,breaks:Oi,pedantic:Mi};var $i=Object.defineProperty,cn=(n,e,t)=>((r,s,o)=>s in r?$i(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,typeof e!="symbol"?e+"":e,t);function jr(n,e,t,r){const s=e.href,o=e.title?ce(e.title):null,a=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const i={type:"link",raw:t,href:s,title:o,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,i}return{type:"image",raw:t,href:s,title:o,text:ce(a)}}class Dt{constructor(e){cn(this,"lexer"),cn(this,"options"),cn(this,"rules"),this.options=e||Te}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let r,s;return t[2]==="@"?(r=ce(t[1]),s="mailto:"+r):(r=ce(t[1]),s=r),{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let r=t[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);r=bt(r.replace(/^ *>[ \t]?/gm,""),`
`);const s=this.lexer.state.top;this.lexer.state.top=!0;const o=this.lexer.blockTokens(r);return this.lexer.state.top=s,{type:"blockquote",raw:t[0],tokens:o,text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:bt(r,`
`)}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(/\n/g," ");const s=/[^ ]/.test(r),o=/^ /.test(r)&&/ $/.test(r);return s&&o&&(r=r.substring(1,r.length-1)),r=ce(r,!0),{type:"codespan",raw:t[0],text:r}}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(/\s+/g," "),s=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:s,title:o}}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}emStrong(e,t,r=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(s&&!(s[3]&&r.match(/[\p{L}\p{N}]/u))&&(!(s[1]||s[2])||!r||this.rules.inline.punctuation.exec(r))){const o=[...s[0]].length-1;let a,i,u=o,l=0;const c=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+o);(s=c.exec(t))!=null;){if(a=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!a)continue;if(i=[...a].length,s[3]||s[4]){u+=i;continue}if((s[5]||s[6])&&o%3&&!((o+i)%3)){l+=i;continue}if(u-=i,u>0)continue;i=Math.min(i,i+u+l);const d=[...s[0]][0].length,p=e.slice(0,o+s.index+d+i);if(Math.min(o,i)%2){const h=p.slice(1,-1);return{type:"em",raw:p,text:h,tokens:this.lexer.inlineTokens(h)}}const m=p.slice(2,-2);return{type:"strong",raw:p,text:m,tokens:this.lexer.inlineTokens(m)}}}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:ce(t[1])}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],s=function(o,a){const i=o.match(/^(\s+)(?:```)/);if(i===null)return a;const u=i[1];return a.split(`
`).map(l=>{const c=l.match(/^\s+/);if(c===null)return l;const[d]=c;return d.length>=u.length?l.slice(u.length):l}).join(`
`)}(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(/#$/.test(r)){const s=bt(r,"#");this.options.pedantic?r=s.trim():s&&!/ $/.test(s)||(r=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let r;return r=this.lexer.state.inRawBlock?t[0]:ce(t[0]),{type:"text",raw:t[0],text:r}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const a=bt(r.slice(0,-1),"\\");if((r.length-a.length)%2==0)return}else{const a=function(i,u){if(i.indexOf(u[1])===-1)return-1;let l=0;for(let c=0;c<i.length;c++)if(i[c]==="\\")c++;else if(i[c]===u[0])l++;else if(i[c]===u[1]&&(l--,l<0))return c;return-1}(t[2],"()");if(a>-1){const i=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,i).trim(),t[3]=""}}let s=t[2],o="";if(this.options.pedantic){const a=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);a&&(s=a[1],o=a[3])}else o=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(s=this.options.pedantic&&!/>$/.test(r)?s.slice(1):s.slice(1,-1)),jr(t,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const s=r.length>1,o={type:"list",raw:"",ordered:s,start:s?+r.slice(0,-1):"",loose:!1,items:[]};r=s?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=s?r:"[*+-]");const a=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let i="",u="",l=!1;for(;e;){let c=!1;if(!(t=a.exec(e))||this.rules.block.hr.test(e))break;i=t[0],e=e.substring(i.length);let d=t[2].split(`
`,1)[0].replace(/^\t+/,w=>" ".repeat(3*w.length)),p=e.split(`
`,1)[0],m=0;this.options.pedantic?(m=2,u=d.trimStart()):(m=t[2].search(/[^ ]/),m=m>4?1:m,u=d.slice(m),m+=t[1].length);let h=!1;if(!d&&/^ *$/.test(p)&&(i+=p+`
`,e=e.substring(p.length+1),c=!0),!c){const w=new RegExp(`^ {0,${Math.min(3,m-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),f=new RegExp(`^ {0,${Math.min(3,m-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),x=new RegExp(`^ {0,${Math.min(3,m-1)}}(?:\`\`\`|~~~)`),S=new RegExp(`^ {0,${Math.min(3,m-1)}}#`);for(;e;){const C=e.split(`
`,1)[0];if(p=C,this.options.pedantic&&(p=p.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),x.test(p)||S.test(p)||w.test(p)||f.test(e))break;if(p.search(/[^ ]/)>=m||!p.trim())u+=`
`+p.slice(m);else{if(h||d.search(/[^ ]/)>=4||x.test(d)||S.test(d)||f.test(d))break;u+=`
`+p}h||p.trim()||(h=!0),i+=C+`
`,e=e.substring(C.length+1),d=p.slice(m)}}o.loose||(l?o.loose=!0:/\n *\n *$/.test(i)&&(l=!0));let g,k=null;this.options.gfm&&(k=/^\[[ xX]\] /.exec(u),k&&(g=k[0]!=="[ ] ",u=u.replace(/^\[[ xX]\] +/,""))),o.items.push({type:"list_item",raw:i,task:!!k,checked:g,loose:!1,text:u,tokens:[]}),o.raw+=i}o.items[o.items.length-1].raw=i.trimEnd(),o.items[o.items.length-1].text=u.trimEnd(),o.raw=o.raw.trimEnd();for(let c=0;c<o.items.length;c++)if(this.lexer.state.top=!1,o.items[c].tokens=this.lexer.blockTokens(o.items[c].text,[]),!o.loose){const d=o.items[c].tokens.filter(m=>m.type==="space"),p=d.length>0&&d.some(m=>/\n.*\n/.test(m.raw));o.loose=p}if(o.loose)for(let c=0;c<o.items.length;c++)o.items[c].loose=!0;return o}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const s=t[(r[2]||r[1]).replace(/\s+/g," ").toLowerCase()];if(!s){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return jr(r,s,r[0],this.lexer)}}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const r=Lr(t[1]),s=t[2].replace(/^\||\| *$/g,"").split("|"),o=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],a={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===s.length){for(const i of s)/^ *-+: *$/.test(i)?a.align.push("right"):/^ *:-+: *$/.test(i)?a.align.push("center"):/^ *:-+ *$/.test(i)?a.align.push("left"):a.align.push(null);for(const i of r)a.header.push({text:i,tokens:this.lexer.inline(i)});for(const i of o)a.rows.push(Lr(i,a.header.length).map(u=>({text:u,tokens:this.lexer.inline(u)})));return a}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}url(e){var r;let t;if(t=this.rules.inline.url.exec(e)){let s,o;if(t[2]==="@")s=ce(t[0]),o="mailto:"+s;else{let a;do a=t[0],t[0]=((r=this.rules.inline._backpedal.exec(t[0]))==null?void 0:r[0])??"";while(a!==t[0]);s=ce(t[0]),o=t[1]==="www."?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:s,href:o,tokens:[{type:"text",raw:s,text:s}]}}}}var zi=Object.defineProperty,Qe=(n,e,t)=>((r,s,o)=>s in r?zi(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,typeof e!="symbol"?e+"":e,t);class ve{constructor(e){Qe(this,"options"),Qe(this,"state"),Qe(this,"tokens"),Qe(this,"inlineQueue"),Qe(this,"tokenizer"),this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Te,this.options.tokenizer=this.options.tokenizer||new Dt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:wt.normal,inline:Ue.normal};this.options.pedantic?(t.block=wt.pedantic,t.inline=Ue.pedantic):this.options.gfm&&(t.block=wt.gfm,this.options.breaks?t.inline=Ue.breaks:t.inline=Ue.gfm),this.tokenizer.rules=t}static get rules(){return{block:wt,inline:Ue}}static lex(e,t){return new ve(t).lex(e)}static lexInline(e,t){return new ve(t).inlineTokens(e)}blockTokens(e,t=[]){let r,s,o,a;for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,(i,u,l)=>u+"    ".repeat(l.length));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(i=>!!(r=i.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0))))if(r=this.tokenizer.space(e))e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);else if(r=this.tokenizer.code(e))e=e.substring(r.raw.length),s=t[t.length-1],!s||s.type!=="paragraph"&&s.type!=="text"?t.push(r):(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text);else if(r=this.tokenizer.fences(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.heading(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.hr(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.blockquote(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.list(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.html(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.def(e))e=e.substring(r.raw.length),s=t[t.length-1],!s||s.type!=="paragraph"&&s.type!=="text"?this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title}):(s.raw+=`
`+r.raw,s.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text);else if(r=this.tokenizer.table(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.lheading(e))e=e.substring(r.raw.length),t.push(r);else{if(o=e,this.options.extensions&&this.options.extensions.startBlock){let i=1/0;const u=e.slice(1);let l;this.options.extensions.startBlock.forEach(c=>{l=c.call({lexer:this},u),typeof l=="number"&&l>=0&&(i=Math.min(i,l))}),i<1/0&&i>=0&&(o=e.substring(0,i+1))}if(this.state.top&&(r=this.tokenizer.paragraph(o)))s=t[t.length-1],a&&s.type==="paragraph"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r),a=o.length!==e.length,e=e.substring(r.raw.length);else if(r=this.tokenizer.text(e))e=e.substring(r.raw.length),s=t[t.length-1],s&&s.type==="text"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r);else if(e){const i="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(i);break}throw new Error(i)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,s,o,a,i,u,l=e;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(l))!=null;)c.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(l))!=null;)l=l.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(l))!=null;)l=l.slice(0,a.index)+"++"+l.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(i||(u=""),i=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(c=>!!(r=c.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0))))if(r=this.tokenizer.escape(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.tag(e))e=e.substring(r.raw.length),s=t[t.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);else if(r=this.tokenizer.link(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(r.raw.length),s=t[t.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);else if(r=this.tokenizer.emStrong(e,l,u))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.codespan(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.br(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.del(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.autolink(e))e=e.substring(r.raw.length),t.push(r);else if(this.state.inLink||!(r=this.tokenizer.url(e))){if(o=e,this.options.extensions&&this.options.extensions.startInline){let c=1/0;const d=e.slice(1);let p;this.options.extensions.startInline.forEach(m=>{p=m.call({lexer:this},d),typeof p=="number"&&p>=0&&(c=Math.min(c,p))}),c<1/0&&c>=0&&(o=e.substring(0,c+1))}if(r=this.tokenizer.inlineText(o))e=e.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(u=r.raw.slice(-1)),i=!0,s=t[t.length-1],s&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);else if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}throw new Error(c)}}else e=e.substring(r.raw.length),t.push(r);return t}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}}var ji=Object.defineProperty,Di=(n,e,t)=>((r,s,o)=>s in r?ji(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,e+"",t);class Ht{constructor(e){Di(this,"options"),this.options=e||Te}blockquote(e){return`<blockquote>
${e}</blockquote>
`}br(){return"<br>"}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}code(e,t,r){var o;const s=(o=(t||"").match(/^\S*/))==null?void 0:o[0];return e=e.replace(/\n$/,"")+`
`,s?'<pre><code class="language-'+ce(s)+'">'+(r?e:ce(e,!0))+`</code></pre>
`:"<pre><code>"+(r?e:ce(e,!0))+`</code></pre>
`}codespan(e){return`<code>${e}</code>`}del(e){return`<del>${e}</del>`}em(e){return`<em>${e}</em>`}heading(e,t,r){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}html(e,t){return e}image(e,t,r){const s=Br(e);if(s===null)return r;let o=`<img src="${e=s}" alt="${r}"`;return t&&(o+=` title="${t}"`),o+=">",o}link(e,t,r){const s=Br(e);if(s===null)return r;let o='<a href="'+(e=s)+'"';return t&&(o+=' title="'+t+'"'),o+=">"+r+"</a>",o}list(e,t,r){const s=t?"ol":"ul";return"<"+s+(t&&r!==1?' start="'+r+'"':"")+`>
`+e+"</"+s+`>
`}listitem(e,t,r){return`<li>${e}</li>
`}paragraph(e){return`<p>${e}</p>
`}strong(e){return`<strong>${e}</strong>`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablecell(e,t){const r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}tablerow(e){return`<tr>
${e}</tr>
`}text(e){return e}}class Qn{br(){return""}codespan(e){return e}del(e){return e}em(e){return e}html(e){return e}image(e,t,r){return""+r}link(e,t,r){return""+r}strong(e){return e}text(e){return e}}var Hi=Object.defineProperty,ln=(n,e,t)=>((r,s,o)=>s in r?Hi(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,typeof e!="symbol"?e+"":e,t);class xe{constructor(e){ln(this,"options"),ln(this,"renderer"),ln(this,"textRenderer"),this.options=e||Te,this.options.renderer=this.options.renderer||new Ht,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Qn}static parse(e,t){return new xe(t).parse(e)}static parseInline(e,t){return new xe(t).parseInline(e)}parse(e,t=!0){let r="";for(let s=0;s<e.length;s++){const o=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]){const a=o,i=this.options.extensions.renderers[a.type].call({parser:this},a);if(i!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){r+=i||"";continue}}switch(o.type){case"space":continue;case"hr":r+=this.renderer.hr();continue;case"heading":{const a=o;r+=this.renderer.heading(this.parseInline(a.tokens),a.depth,vi(this.parseInline(a.tokens,this.textRenderer)));continue}case"code":{const a=o;r+=this.renderer.code(a.text,a.lang,!!a.escaped);continue}case"table":{const a=o;let i="",u="";for(let c=0;c<a.header.length;c++)u+=this.renderer.tablecell(this.parseInline(a.header[c].tokens),{header:!0,align:a.align[c]});i+=this.renderer.tablerow(u);let l="";for(let c=0;c<a.rows.length;c++){const d=a.rows[c];u="";for(let p=0;p<d.length;p++)u+=this.renderer.tablecell(this.parseInline(d[p].tokens),{header:!1,align:a.align[p]});l+=this.renderer.tablerow(u)}r+=this.renderer.table(i,l);continue}case"blockquote":{const a=o,i=this.parse(a.tokens);r+=this.renderer.blockquote(i);continue}case"list":{const a=o,i=a.ordered,u=a.start,l=a.loose;let c="";for(let d=0;d<a.items.length;d++){const p=a.items[d],m=p.checked,h=p.task;let g="";if(p.task){const k=this.renderer.checkbox(!!m);l?p.tokens.length>0&&p.tokens[0].type==="paragraph"?(p.tokens[0].text=k+" "+p.tokens[0].text,p.tokens[0].tokens&&p.tokens[0].tokens.length>0&&p.tokens[0].tokens[0].type==="text"&&(p.tokens[0].tokens[0].text=k+" "+p.tokens[0].tokens[0].text)):p.tokens.unshift({type:"text",text:k+" "}):g+=k+" "}g+=this.parse(p.tokens,l),c+=this.renderer.listitem(g,h,!!m)}r+=this.renderer.list(c,i,u);continue}case"html":{const a=o;r+=this.renderer.html(a.text,a.block);continue}case"paragraph":{const a=o;r+=this.renderer.paragraph(this.parseInline(a.tokens));continue}case"text":{let a=o,i=a.tokens?this.parseInline(a.tokens):a.text;for(;s+1<e.length&&e[s+1].type==="text";)a=e[++s],i+=`
`+(a.tokens?this.parseInline(a.tokens):a.text);r+=t?this.renderer.paragraph(i):i;continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}parseInline(e,t){t=t||this.renderer;let r="";for(let s=0;s<e.length;s++){const o=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]){const a=this.options.extensions.renderers[o.type].call({parser:this},o);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=a||"";continue}}switch(o.type){case"escape":{const a=o;r+=t.text(a.text);break}case"html":{const a=o;r+=t.html(a.text);break}case"link":{const a=o;r+=t.link(a.href,a.title,this.parseInline(a.tokens,t));break}case"image":{const a=o;r+=t.image(a.href,a.title,a.text);break}case"strong":{const a=o;r+=t.strong(this.parseInline(a.tokens,t));break}case"em":{const a=o;r+=t.em(this.parseInline(a.tokens,t));break}case"codespan":{const a=o;r+=t.codespan(a.text);break}case"br":r+=t.br();break;case"del":{const a=o;r+=t.del(this.parseInline(a.tokens,t));break}case"text":{const a=o;r+=t.text(a.text);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}}var Ve,Dr,An,_i=Object.defineProperty,oo=n=>{throw TypeError(n)},me=(n,e,t)=>((r,s,o)=>s in r?_i(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,typeof e!="symbol"?e+"":e,t),In=(n,e,t)=>(((r,s,o)=>{s.has(r)||oo("Cannot "+o)})(n,e,"access private method"),t);Ve=new WeakSet,Dr=function(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){const r="<p>An error occurred:</p><pre>"+ce(t.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(t);throw t}},An=function(n,e){return(t,r)=>{const s={...r},o={...this.defaults,...s};this.defaults.async===!0&&s.async===!1&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const a=In(this,Ve,Dr).call(this,!!o.silent,!!o.async);if(t==null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(t):t).then(i=>n(i,o)).then(i=>o.hooks?o.hooks.processAllTokens(i):i).then(i=>o.walkTokens?Promise.all(this.walkTokens(i,o.walkTokens)).then(()=>i):i).then(i=>e(i,o)).then(i=>o.hooks?o.hooks.postprocess(i):i).catch(a);try{o.hooks&&(t=o.hooks.preprocess(t));let i=n(t,o);o.hooks&&(i=o.hooks.processAllTokens(i)),o.walkTokens&&this.walkTokens(i,o.walkTokens);let u=e(i,o);return o.hooks&&(u=o.hooks.postprocess(u)),u}catch(i){return a(i)}}};const Ie=new class{constructor(...n){var e,t,r;e=this,(t=Ve).has(e)?oo("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),me(this,"Hooks",Je),me(this,"Lexer",ve),me(this,"Parser",xe),me(this,"Renderer",Ht),me(this,"TextRenderer",Qn),me(this,"Tokenizer",Dt),me(this,"defaults",{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}),me(this,"options",this.setOptions),me(this,"parse",In(this,Ve,An).call(this,ve.lex,xe.parse)),me(this,"parseInline",In(this,Ve,An).call(this,ve.lexInline,xe.parseInline)),this.use(...n)}lexer(n,e){return ve.lex(n,e??this.defaults)}parser(n,e){return xe.parse(n,e??this.defaults)}setOptions(n){return this.defaults={...this.defaults,...n},this}use(...n){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{const r={...t};if(r.async=this.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const o=e.renderers[s.name];e.renderers[s.name]=o?function(...a){let i=s.renderer.apply(this,a);return i===!1&&(i=o.apply(this,a)),i}:s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=e[s.level];o?o.unshift(s.tokenizer):e[s.level]=[s.tokenizer],s.start&&(s.level==="block"?e.startBlock?e.startBlock.push(s.start):e.startBlock=[s.start]:s.level==="inline"&&(e.startInline?e.startInline.push(s.start):e.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(e.childTokens[s.name]=s.childTokens)}),r.extensions=e),t.renderer){const s=this.defaults.renderer||new Ht(this.defaults);for(const o in t.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if(o==="options")continue;const a=o,i=t.renderer[a],u=s[a];s[a]=(...l)=>{let c=i.apply(s,l);return c===!1&&(c=u.apply(s,l)),c||""}}r.renderer=s}if(t.tokenizer){const s=this.defaults.tokenizer||new Dt(this.defaults);for(const o in t.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const a=o,i=t.tokenizer[a],u=s[a];s[a]=(...l)=>{let c=i.apply(s,l);return c===!1&&(c=u.apply(s,l)),c}}r.tokenizer=s}if(t.hooks){const s=this.defaults.hooks||new Je;for(const o in t.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if(o==="options")continue;const a=o,i=t.hooks[a],u=s[a];Je.passThroughHooks.has(o)?s[a]=l=>{if(this.defaults.async)return Promise.resolve(i.call(s,l)).then(d=>u.call(s,d));const c=i.call(s,l);return u.call(s,c)}:s[a]=(...l)=>{let c=i.apply(s,l);return c===!1&&(c=u.apply(s,l)),c}}r.hooks=s}if(t.walkTokens){const s=this.defaults.walkTokens,o=t.walkTokens;r.walkTokens=function(a){let i=[];return i.push(o.call(this,a)),s&&(i=i.concat(s.call(this,a))),i}}this.defaults={...this.defaults,...r}}),this}walkTokens(n,e){var r,s;let t=[];for(const o of n)switch(t=t.concat(e.call(this,o)),o.type){case"table":{const a=o;for(const i of a.header)t=t.concat(this.walkTokens(i.tokens,e));for(const i of a.rows)for(const u of i)t=t.concat(this.walkTokens(u.tokens,e));break}case"list":{const a=o;t=t.concat(this.walkTokens(a.items,e));break}default:{const a=o;(s=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(i=>{const u=a[i].flat(1/0);t=t.concat(this.walkTokens(u,e))}):a.tokens&&(t=t.concat(this.walkTokens(a.tokens,e)))}}return t}};function U(n,e){return Ie.parse(n,e)}U.options=U.setOptions=function(n){return Ie.setOptions(n),U.defaults=Ie.defaults,Pr(U.defaults),U},U.getDefaults=di,U.defaults=Te,U.use=function(...n){return Ie.use(...n),U.defaults=Ie.defaults,Pr(U.defaults),U},U.walkTokens=function(n,e){return Ie.walkTokens(n,e)},U.parseInline=Ie.parseInline,U.Parser=xe,U.parser=xe.parse,U.Renderer=Ht,U.TextRenderer=Qn,U.Lexer=ve,U.lexer=ve.lex,U.Tokenizer=Dt,U.Hooks=Je,U.parse=U;const ao=(n,e)=>{const{showCodeBlockCopyButton:t,markdownLinkTarget:r,syntaxHighlighter:s,htmlSanitizer:o}=e||{},a=U(n,{async:!1,breaks:!0});if(typeof a!="string")throw new Error("Markdown parsing failed");const i=document.createElement("div");return i.innerHTML=o?o(a):a,i.querySelectorAll("pre").forEach(u=>{const l=document.createElement("div");l.className="code-block";const c=u.querySelector("code");if(!c){const h=u.innerHTML;return l.innerHTML=o?o(h):h,void u.replaceWith(l)}let d;for(let h=0;h<c.classList.length;h++){const g=c.classList[h];if(g.startsWith("language-")){d=g.slice(9);break}}const p=document.createElement("pre"),m="<div>"+c.innerHTML+"</div>";if(p.innerHTML=e!=null&&e.htmlSanitizer?e.htmlSanitizer(m):m,d&&(p.setAttribute("data-language",d),s)){const h="<div>"+s.createHighlighter()(c.textContent||"",d)+"</div>";p.innerHTML=o?o(h):h,p.className="highlighter-dark"}(h=>{h.replaceChildren()})(l),l.appendChild(p),u.replaceWith(l)}),t!==!1&&i.querySelectorAll(".code-block").forEach(u=>{var p;if(!u.querySelector("pre")||(p=u.previousElementSibling)!=null&&p.classList.contains("nlux-comp-copyButton"))return;const l="Copy code block to clipboard",c=document.createElement("button");c.classList.add("nlux-comp-copyButton"),c.setAttribute("aria-label",l),c.setAttribute("title",l);const d=document.createElement("span");d.classList.add("icon-copy"),c.appendChild(d),u.appendChild(c)}),r!=="self"&&i.querySelectorAll("a").forEach(u=>{u.setAttribute("target","_blank")}),i.innerHTML},io="nlux-comp-message",Hr={received:"nlux-comp-chatItem--received",sent:"nlux-comp-chatItem--sent"},Ni="nlux-comp-chatItem--bubblesLayout",qi="nlux-comp-chatItem--listLayout",Fi=(n,e)=>{let t=!1;const{onComplete:r}=e||{},s=[],o=(e!=null&&e.skipStreamingAnimation?"timeout":"animationFrame")=="timeout"?d=>setTimeout(d,0):d=>requestAnimationFrame(d),a=document.createElement("div");a.classList.add("md-in-progress"),n.append(a);const i=()=>{for(;a.firstChild;){const d=a.firstChild;d instanceof HTMLElement&&Js(d),a.before(d)}},u=!(e!=null&&e.skipStreamingAnimation)&&(e!=null&&e.streamingAnimationSpeed)&&e.streamingAnimationSpeed>=0?e.streamingAnimationSpeed:e!=null&&e.skipStreamingAnimation?0:8,l={timeSinceLastProcessing:new Date().getTime(),currentMarkdown:"",previousHtml:void 0};let c=setInterval(()=>{const d=new Date().getTime(),p=(e==null?void 0:e.waitTimeBeforeStreamCompletion)!=="never";if(s.length===0&&p){const h=typeof(e==null?void 0:e.waitTimeBeforeStreamCompletion)=="number"?e.waitTimeBeforeStreamCompletion:2e3;return void((t||d-l.timeSinceLastProcessing>h)&&(t=!0,c&&(clearInterval(c),c=void 0),i(),a.remove(),r==null?void 0:r()))}l.timeSinceLastProcessing=d;const m=s.shift();m!==void 0&&typeof m=="string"&&o(()=>{const h=l.currentMarkdown+m,g=ao(h,e).trim();if(typeof g!="string")return l.currentMarkdown=l.currentMarkdown.slice(0,-m.length),void oe("Markdown parsing failed");if(l.previousHtml&&g.length>l.previousHtml.length&&g.startsWith(l.previousHtml)){i();const k=g.slice(l.previousHtml.length).trim();a.innerHTML=e!=null&&e.htmlSanitizer?e.htmlSanitizer(k):k,l.currentMarkdown=m,l.previousHtml=void 0}else a.innerHTML=e!=null&&e.htmlSanitizer?e.htmlSanitizer(g):g,l.currentMarkdown=h,l.previousHtml=g})},u);return{next:d=>{if(t)oe("Stream is already complete. No more chunks can be added");else for(const p of d)s.push(p)},complete:()=>{s.push(`
`),t=!0},cancel:()=>{c&&(clearInterval(c),c=void 0),t=!0,a.remove()},error:()=>{t=!0}}},Ui=function(n,e){const{uid:t,status:r,responseRenderer:s,markdownOptions:o,initialMarkdownMessage:a,markdownContainersController:i}=n,[u,l]=v.useState([]),c=v.useRef(null),d=v.useRef(null),p=v.useRef(null),m=v.useRef(null),[h,g]=v.useState();v.useEffect(()=>{c.current!==d.current&&(d.current=c.current,g(c.current||void 0))}),v.useEffect(()=>{if(h){const w=i.getStreamingDomElement(t);h.append(w)}},[h]),v.useEffect(()=>{m.current=w=>{l(f=>[...f,w])}},[l]),v.useEffect(()=>{const w=i.getStreamingDomElement(t);return p.current=Fi(w,{syntaxHighlighter:o==null?void 0:o.syntaxHighlighter,htmlSanitizer:o==null?void 0:o.htmlSanitizer,markdownLinkTarget:o==null?void 0:o.markdownLinkTarget,showCodeBlockCopyButton:o==null?void 0:o.showCodeBlockCopyButton,skipStreamingAnimation:o==null?void 0:o.skipStreamingAnimation,streamingAnimationSpeed:o==null?void 0:o.streamingAnimationSpeed,waitTimeBeforeStreamCompletion:o==null?void 0:o.waitTimeBeforeStreamCompletion,onComplete:o==null?void 0:o.onStreamComplete}),a&&p.current.next(a),()=>{i.deleteStreamingDomElement(t)}},[]),v.useEffect(()=>()=>{d.current=null,p.current=null,m.current=null,g(void 0)},[]),v.useImperativeHandle(e,()=>({streamChunk:w=>{var f,x;m.current&&((f=m.current)==null||f.call(m,w)),typeof w=="string"&&((x=p.current)==null||x.next(w))},completeStream:()=>{var w;(w=p.current)==null||w.complete()},cancelStream:()=>{var w;(w=p.current)==null||w.cancel()}}),[]);const k=s||void 0;return b.jsxs("div",{className:`${io} ${Sn[r]} ${wn.received}`,children:[k&&b.jsx(k,{uid:t,status:r,containerRef:c,content:u,contentType:"text",serverResponse:[],dataTransferMode:"stream"}),!k&&b.jsx("div",{className:"nlux-markdownStream-root",ref:c})]})},Qi=n=>{const{markdownOptions:e}=n,t=v.useRef(null),r=v.useMemo(()=>n.content?ao(n.content,{syntaxHighlighter:e==null?void 0:e.syntaxHighlighter,htmlSanitizer:e==null?void 0:e.htmlSanitizer,markdownLinkTarget:e==null?void 0:e.markdownLinkTarget,showCodeBlockCopyButton:e==null?void 0:e.showCodeBlockCopyButton}):"",[n.content,e==null?void 0:e.markdownLinkTarget,e==null?void 0:e.syntaxHighlighter,e==null?void 0:e.htmlSanitizer,e==null?void 0:e.showCodeBlockCopyButton]);v.useEffect(()=>{t.current&&(e==null?void 0:e.showCodeBlockCopyButton)!==!1&&Js(t.current)},[r,t.current,e==null?void 0:e.showCodeBlockCopyButton]);const s=v.useMemo(()=>e!=null&&e.htmlSanitizer?e.htmlSanitizer(r):r,[r,e==null?void 0:e.htmlSanitizer]),o=v.useCallback(l=>{if(!n.canResubmit)return;const c=l.currentTarget.textContent;return c?Ks(l,n.submitShortcutKey)?(l.preventDefault(),void(n.onResubmit&&n.onResubmit(c))):void(l.key==="Escape"&&(l.preventDefault(),l.currentTarget.textContent=n.content,l.currentTarget.blur())):void 0},[n.canResubmit,n.onResubmit,n.content]),a=v.useCallback(l=>{n.canResubmit&&(l.preventDefault(),l.currentTarget.textContent=n.content,l.currentTarget.blur())},[n.canResubmit,n.content]),i=v.useCallback(l=>{if(!n.canResubmit)return;l.preventDefault();const c=document.createRange();c.selectNodeContents(l.currentTarget);const d=window.getSelection();d==null||d.removeAllRanges(),d==null||d.addRange(c)},[n.canResubmit]),u=n.canResubmit?"editable-markdown-container":"";return b.jsx(co,{children:b.jsx("div",{className:"nlux-markdownStream-root"+(u?` ${u}`:""),children:b.jsx("div",{className:"nlux-markdown-container",ref:t,dangerouslySetInnerHTML:{__html:s},contentEditable:n.canResubmit,onKeyDown:o,onBlur:a,onFocus:i})})})};class co extends v.Component{constructor(){super(...arguments),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e){oe("Markdown rendering error occurred. This could be due to a malformed markdown content, or it could be because the page requires an HTML sanitizer. Please check the error message for more details and consider configuring NLUX with a compatible sanitizer."),this.props.onMarkdownRenderingError&&this.props.onMarkdownRenderingError(e)}render(){return this.state.hasError?null:this.props.children}}const _r=n=>b.jsx(co,{children:b.jsx(Qi,{...n})}),lo=n=>{const e=typeof n.avatar=="string",t=!e&&v.isValidElement(n.avatar);return b.jsxs("div",{className:"nlux-comp-avatar",children:[t&&n.avatar,!t&&e&&b.jsx("div",{className:"nlux-comp-avatarContainer",children:n.avatar&&b.jsx("div",{className:"nlux-comp-avatarPicture",style:{backgroundImage:`url("${encodeURI(n.avatar)}")`}})})]})},Gi=function(n,e){var w,f,x,S,C,T,M,$;const t=v.useRef(null);v.useImperativeHandle(e,()=>({streamChunk:A=>setTimeout(()=>{var I;return(I=t==null?void 0:t.current)==null?void 0:I.streamChunk(A)}),completeStream:()=>setTimeout(()=>{var A;return(A=t==null?void 0:t.current)==null?void 0:A.completeStream()}),cancelStream:()=>{var A;return(A=t==null?void 0:t.current)==null?void 0:A.cancelStream()}}),[]);const r=n.contentType==="server-component",s=n.direction==="received",o=n.direction==="sent",a=n.dataTransferMode==="stream",i=n.isPartOfInitialSegment,u=v.useCallback(()=>{var A;return(A=n.onMarkdownStreamRendered)==null?void 0:A.call(n,n.uid)},[n.uid]);v.useEffect(()=>{var A;a||r||i||((A=n.onMarkdownStreamRendered)==null||A.call(n,n.uid))},[]);const l=function(A){const{uid:I,status:B,dataTransferMode:E,contentType:R,fetchedContent:O,streamedContent:X,streamedServerResponse:ae,fetchedServerResponse:Y,direction:Z,messageOptions:z}=A;if((z==null?void 0:z.responseRenderer)!==void 0){if(E==="stream"){const V={uid:I,status:B,dataTransferMode:E,contentType:R,content:X??[],serverResponse:ae??[]};return()=>{const ue=z.responseRenderer;return b.jsx(ue,{...V})}}const _=v.isValidElement(O),te={uid:I,status:"complete",dataTransferMode:E,contentType:R,content:O?_?[]:[O]:[],serverComponent:_?O:void 0,serverResponse:Y?[Y]:[]};return()=>{const V=z.responseRenderer;return b.jsx(V,{...te})}}if(Z==="sent"){if(typeof O=="string"){const _=O;return()=>b.jsx(b.Fragment,{children:_})}return()=>""}if(typeof O=="string"){const _=O;return()=>b.jsx(_r,{messageUid:I,content:_,markdownOptions:{syntaxHighlighter:z==null?void 0:z.syntaxHighlighter,htmlSanitizer:z==null?void 0:z.htmlSanitizer,markdownLinkTarget:z==null?void 0:z.markdownLinkTarget,showCodeBlockCopyButton:z==null?void 0:z.showCodeBlockCopyButton,skipStreamingAnimation:z==null?void 0:z.skipStreamingAnimation}})}return v.isValidElement(O)?()=>b.jsx(b.Fragment,{children:O}):()=>""}(n),c=function(A){var I;return v.useCallback(()=>{var E,R,O;if(((E=A.messageOptions)==null?void 0:E.promptRenderer)===void 0)return b.jsx(_r,{messageUid:A.uid,content:A.fetchedContent,markdownOptions:{htmlSanitizer:(R=A.messageOptions)==null?void 0:R.htmlSanitizer},canResubmit:(O=A.messageOptions)==null?void 0:O.editableUserMessages,submitShortcutKey:A.submitShortcutKey,onResubmit:X=>{A.onPromptResubmit&&A.onPromptResubmit(X)}});const B=A.messageOptions.promptRenderer;return b.jsx(B,{uid:A.uid,prompt:A.fetchedContent,onResubmit:X=>{A.onPromptResubmit&&A.onPromptResubmit(X)}})},[(I=A.messageOptions)==null?void 0:I.promptRenderer,A.fetchedContent,A.uid])}(n),d=v.useMemo(()=>v.forwardRef(Ui),[]),p=function(A){const I=v.useMemo(()=>b.jsxs("div",{className:"nlux-comp-chatItem-participantInfo",children:[A.avatar!==void 0&&b.jsx(lo,{name:A.name,avatar:A.avatar}),b.jsx("span",{className:"nlux-comp-chatItem-participantName",children:A.name})]}),[A.avatar,A.name]);return()=>b.jsx(b.Fragment,{children:I})}(n),m=`nlux-comp-chatItem ${n.direction?Hr[n.direction]:Hr.received} ${n.layout==="bubbles"?Ni:qi}`,h=n.status?Sn[n.status]:Sn.rendered,g=n.direction?wn[n.direction]:wn.received,k=`${io} ${h} ${g}`;return b.jsxs("div",{className:m,children:[b.jsx(p,{}),s&&a&&!r&&b.jsx(d,{uid:n.uid,status:n.status,ref:t,direction:n.direction,responseRenderer:(w=n.messageOptions)==null?void 0:w.responseRenderer,markdownContainersController:n.markdownContainersController,markdownOptions:{syntaxHighlighter:(f=n.messageOptions)==null?void 0:f.syntaxHighlighter,htmlSanitizer:(x=n.messageOptions)==null?void 0:x.htmlSanitizer,markdownLinkTarget:(S=n.messageOptions)==null?void 0:S.markdownLinkTarget,showCodeBlockCopyButton:(C=n.messageOptions)==null?void 0:C.showCodeBlockCopyButton,skipStreamingAnimation:(T=n.messageOptions)==null?void 0:T.skipStreamingAnimation,streamingAnimationSpeed:(M=n.messageOptions)==null?void 0:M.streamingAnimationSpeed,waitTimeBeforeStreamCompletion:($=n.messageOptions)==null?void 0:$.waitTimeBeforeStreamCompletion,onStreamComplete:u}},"do-not-change"),s&&a&&r&&b.jsx("div",{className:k,children:n.fetchedContent}),s&&!a&&b.jsx("div",{className:k,children:b.jsx(l,{})}),o&&b.jsx("div",{className:k,children:b.jsx(c,{})})]})},St=(n,e)=>{var t,r;return n==="assistant"?(t=e==null?void 0:e.assistant)==null?void 0:t.avatar:n==="user"?(r=e==null?void 0:e.user)==null?void 0:r.avatar:void 0},Nr=n=>typeof n=="string"||typeof n=="number"||typeof n=="boolean"||n==null,Yi=function(n,e){const{chatSegment:t,containerRef:r}=n,[s,o]=v.useState(!1),a=v.useMemo(()=>new Map,[]),i=v.useMemo(()=>new Map,[]),u=v.useRef(new Map),l=v.useRef(new Map);((m,h,g,k)=>{v.useEffect(()=>{if(m.length===0)return k.clear(),h.current.clear(),void g.current.clear();const w=new Set(k.keys()),f=new Set(m.map(x=>x.uid));w.forEach(x=>{f.has(x)||k.delete(x)}),new Set(h.current.keys()).forEach(x=>{f.has(x)||(h.current.delete(x),g.current.delete(x))})},[m])})(t.items,u,l,a),v.useImperativeHandle(e,()=>({streamChunk:(m,h)=>{const g=a.get(m);if(g!=null&&g.current){const k=g.current.streamChunk;(i.get(m)??[]).forEach(w=>{k(w)}),i.delete(m),k(h)}else{const k=i.get(m)??[];i.set(m,[...k,h])}},completeStream:m=>{const h=a.get(m);h!=null&&h.current?(h.current.completeStream(),a.delete(m)):o(!0)},cancelStreams:()=>{i.clear(),a.forEach(m=>{var h;(h=m.current)==null||h.cancelStream()})}}),[]),v.useEffect(()=>{i.size>0&&i.forEach((m,h)=>{const g=a.get(h);g!=null&&g.current&&(m.forEach(k=>{var w;(w=g==null?void 0:g.current)==null||w.streamChunk(k)}),i.delete(h),s&&(g.current.completeStream(),o(!1)))})});const c=v.useMemo(()=>t.status!=="active"?null:b.jsx("div",{className:"nlux-chatSegment-loader-container",children:n.Loader}),[t.status,n.Loader]),d=v.useMemo(()=>v.forwardRef(Gi),[]),p=v.useCallback(m=>{var h;(h=n.onMarkdownStreamRendered)==null||h.call(n,t.uid,m)},[]);return t.items.length===0?null:b.jsxs("div",{ref:r,className:ui(t.status),children:[t.items.map(m=>Xi(n,d,t,m,a,l,u,p)),c]})},Xi=function(n,e,t,r,s,o,a,i){var p;const u=n.isInitialSegment;let l=s.get(r.uid);l||(l=v.createRef(),s.set(r.uid,l));let c=r.content,d="text";if(typeof c=="function"){const m=o.current.get(r.uid),h=a.current.get(r.uid);if(m&&h)c=h,d="server-component";else{a.current.delete(r.uid),o.current.delete(r.uid);try{const g=c;if(c=b.jsx(g,{}),!c||!v.isValidElement(c))throw new Error("Invalid React element returned from the AI chat content function.");d="server-component",a.current.set(r.uid,c),o.current.set(r.uid,g)}catch{return oe(`The type of the AI chat content is an invalid function.
If you're looking to render a React Server Components, please refer to docs.nlkit.com/nlux for more information.
`),null}}}if(r.participantRole==="user")return r.status!=="complete"?(tt(`User chat item should be always be in complete state — Current status: ${r.status} — Segment UID: ${t.uid}`),null):Nr(c)?b.jsx(e,{ref:l,uid:r.uid,status:"complete",direction:"sent",contentType:d,dataTransferMode:"batch",fetchedContent:r.content,markdownContainersController:n.markdownContainersController,layout:n.layout,messageOptions:n.messageOptions,isPartOfInitialSegment:u,name:yt(r.participantRole,n.personaOptions),avatar:St(r.participantRole,n.personaOptions),submitShortcutKey:n.submitShortcutKey,onPromptResubmit:m=>n.onPromptResubmit(n.chatSegment.uid,r.uid,m)},r.uid):(tt(`User chat item should have primitive content (string, number, boolean, null) — Current content: ${JSON.stringify(c)} — Segment UID: ${t.uid}`),null);if(r.status==="complete"){if(r.dataTransferMode==="stream"){const m=r;return b.jsx(e,{ref:l,uid:r.uid,status:r.status,direction:"received",contentType:d,dataTransferMode:r.dataTransferMode,markdownContainersController:n.markdownContainersController,onMarkdownStreamRendered:i,streamedContent:c,streamedServerResponse:m.serverResponse,layout:n.layout,messageOptions:n.messageOptions,isPartOfInitialSegment:u,name:yt(r.participantRole,n.personaOptions),avatar:St(r.participantRole,n.personaOptions)},r.uid)}return d!=="text"||Nr(c)||(p=n.messageOptions)!=null&&p.responseRenderer?b.jsx(e,{ref:l,uid:r.uid,status:"complete",direction:"received",contentType:d,dataTransferMode:r.dataTransferMode,markdownContainersController:n.markdownContainersController,onMarkdownStreamRendered:i,fetchedContent:c,fetchedServerResponse:r.serverResponse,layout:n.layout,messageOptions:n.messageOptions,isPartOfInitialSegment:u,name:yt(r.participantRole,n.personaOptions),avatar:St(r.participantRole,n.personaOptions)},r.uid):(oe(`When the type of the AI chat content is not primitive (object or array), a custom renderer must be provided — Current content: ${JSON.stringify(c)} — Segment UID: ${t.uid}`),null)}if(r.status==="streaming"){const m=d==="server-component"&&v.isValidElement(c)?c:void 0;return b.jsx(e,{ref:l,uid:r.uid,status:"streaming",direction:"received",contentType:d,dataTransferMode:r.dataTransferMode,markdownContainersController:n.markdownContainersController,onMarkdownStreamRendered:i,fetchedContent:m,layout:n.layout,messageOptions:n.messageOptions,isPartOfInitialSegment:u,name:yt(r.participantRole,n.personaOptions),avatar:St(r.participantRole,n.personaOptions)},r.uid)}},Zi=function(n,e){const{segments:t,personaOptions:r,conversationOptions:s,onLastActiveSegmentChange:o}=n,a=v.createRef();(function(c,d,p){const m=v.useMemo(()=>{const g=c.length>0?c[c.length-1]:void 0;return(g==null?void 0:g.status)==="active"?g.uid:void 0},[c]),h=v.useRef(void 0);v.useEffect(()=>{if(!p)return;const g=h.current;if(m===(g==null?void 0:g.uid)&&d.current===(g==null?void 0:g.div))return;const k=m&&d.current?{uid:m,div:d.current}:void 0;(k||h.current)&&(p(k),h.current=k)})})(t,a,o);const i=function(c){const d=v.useMemo(()=>new Map,[]);return v.useEffect(()=>{if(c.length===0)return void d.clear();const p=new Set(d.keys()),m=new Set(c.map(h=>h.uid));p.forEach(h=>{m.has(h)||d.delete(h)})},[c]),{get:p=>{var m;return(m=d.get(p))==null?void 0:m.current},getRef:p=>d.get(p),set:(p,m)=>{d.set(p,m)},remove:p=>{d.delete(p)}}}(t),u=(c=>v.useMemo(()=>{return d=c==null?void 0:c.layout,d??"bubbles";var d},[c==null?void 0:c.layout]))(s);v.useImperativeHandle(e,()=>({streamChunk:(c,d,p)=>{const m=i.get(c);m==null||m.streamChunk(d,p)},completeStream:(c,d)=>{const p=i.get(c);p==null||p.completeStream(d)},cancelSegmentStreams:c=>{const d=i.get(c);d==null||d.cancelStreams()}}),[]);const l=v.useMemo(()=>v.forwardRef(Yi),[]);return b.jsx("div",{className:"nlux-chatSegments-container",children:t.map((c,d)=>{const p=d===t.length-1,m=c.uid==="initial";let h=i.getRef(c.uid);return h||(h=v.createRef(),i.set(c.uid,h)),b.jsx(l,{ref:h,containerRef:p?a:void 0,markdownContainersController:n.markdownContainersController,chatSegment:c,isInitialSegment:m,layout:u,personaOptions:r,messageOptions:n.messageOptions,Loader:n.Loader,submitShortcutKey:n.submitShortcutKey,onPromptResubmit:n.onPromptResubmit,onMarkdownStreamRendered:n.onMarkdownStreamRendered},c.uid)})})},Ki=n=>{const{onConversationStarterSelected:e}=n;return b.jsx("div",{className:"nlux-comp-conversationStarters",children:n.items.map((t,r)=>b.jsxs("button",{className:"nlux-comp-conversationStarter",onClick:()=>e(t),children:[b.jsx(Ji,{icon:t.icon}),b.jsx("span",{className:"nlux-comp-conversationStarter-prompt",children:t.label??t.prompt})]},r))})},Ji=({icon:n})=>n?typeof n=="string"?b.jsx("img",{src:n,width:16}):b.jsx("div",{className:"nlux-comp-conversationStarter-icon-container",children:n}):null,uo="nlux-comp-welcomeMessage",po=n=>b.jsxs("div",{className:uo,children:[b.jsx(lo,{avatar:n.avatar,name:n.name}),b.jsx("div",{className:"nlux-comp-welcomeMessage-personaName",children:n.name}),n.message&&b.jsx("div",{className:"nlux-comp-welcomeMessage-text",children:n.message})]}),qr=({children:n})=>b.jsx("div",{className:uo,children:n}),Wi=()=>{const n=v.useMemo(()=>"data:image/png;base64,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",[]);return b.jsx(po,{avatar:n,name:""})},Vi=n=>{const{segments:e,personaOptions:t,conversationOptions:r,userDefinedGreeting:s}=n,o=v.useMemo(()=>e.some(d=>d.items.length>0),[e]),a=v.useMemo(()=>!s&&!o&&(t==null?void 0:t.assistant)===void 0&&(r==null?void 0:r.showWelcomeMessage)!==!1,[o,t==null?void 0:t.assistant,r==null?void 0:r.showWelcomeMessage,s]),i=v.useMemo(()=>!s&&!o&&(t==null?void 0:t.assistant)!==void 0&&(r==null?void 0:r.showWelcomeMessage)!==!1,[s,o,t==null?void 0:t.assistant,r==null?void 0:r.showWelcomeMessage]),u=v.useMemo(()=>!o&&(r==null?void 0:r.conversationStarters)&&(r==null?void 0:r.conversationStarters.length)>0,[o,r==null?void 0:r.conversationStarters]),l=v.useMemo(()=>s!==void 0&&(r==null?void 0:r.showWelcomeMessage)!==!1,[s]);v.useEffect(()=>{s&&(r==null?void 0:r.showWelcomeMessage)===!1&&tt("Configuration conflict: The greeting UI override provided via <AiChatUI.Greeting> will not be shown because conversationOptions.showWelcomeMessage is set to false.")},[r==null?void 0:r.showWelcomeMessage,s]);const c=!(a||i||l||o);return b.jsxs(b.Fragment,{children:[a&&b.jsx(Wi,{}),i&&b.jsx(po,{name:t.assistant.name,avatar:t.assistant.avatar,message:t.assistant.tagline}),l&&b.jsx(qr,{children:s}),c&&b.jsx(qr,{children:null}),b.jsx("div",{className:"nlux-conversationStarters-container",children:u&&b.jsx(Ki,{items:r.conversationStarters??[],onConversationStarterSelected:n.onConversationStarterSelected})})]})},En=n=>{var r;const e={},t=Object.keys(n);for(let s=0;s<t.length;s++){const o=t[s];o!=="personaOptions"&&o!=="messageOptions"&&o!=="adapter"&&o!=="events"&&Object.assign(e,{[o]:n[o]})}return n.personaOptions&&(e.personaOptions={},n.personaOptions.assistant&&(e.personaOptions.assistant={name:n.personaOptions.assistant.name,avatar:typeof n.personaOptions.assistant.avatar=="string"?n.personaOptions.assistant.avatar:"<REACT ELEMENT />",tagline:n.personaOptions.assistant.tagline}),n.personaOptions.user&&(e.personaOptions.user={name:n.personaOptions.user.name,avatar:typeof n.personaOptions.user.avatar=="string"?n.personaOptions.user.avatar:"<REACT ELEMENT />"})),n.messageOptions&&(e.messageOptions={...n.messageOptions,responseRenderer:n.messageOptions.responseRenderer?()=>null:void 0,promptRenderer:n.messageOptions.promptRenderer?()=>null:void 0}),(r=n.conversationOptions)!=null&&r.conversationStarters&&(e.conversationOptions={...n.conversationOptions,conversationStarters:n.conversationOptions.conversationStarters.map(s=>({...s,icon:s.icon?"<REACT ELEMENT />":void 0}))}),e};var ec=Object.defineProperty,Ct=(n,e,t)=>((r,s,o)=>s in r?ec(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o)(n,typeof e!="symbol"?e+"":e,t);class tc extends Error{constructor(e={}){super(e.message),Ct(this,"exceptionId"),Ct(this,"message"),Ct(this,"source"),Ct(this,"type"),this.message=e.message??"",this.source=e.source,this.type=this.constructor.name,this.exceptionId=e.exceptionId}}const nc=(n,e)=>{let t,r=e,s=n,o=!0;const a=((g,k)=>{let w=!1;if(typeof g!="function")throw new tc({source:"x/throttle",message:"Callback must be a function"});return(...f)=>{w||(g.apply(void 0,f),w=!0,setTimeout(function(){w=!1},k))}})((g=>{let k,w;return f=>{const x=f.target;if(!(x instanceof HTMLElement))return;const{scrollTop:S,clientHeight:C,scrollHeight:T}=x,M=T-30,$=Math.ceil(S+C)>=M,A=k===void 0||w===void 0?void 0:S>k&&w===T?"down":S<k&&w===T?"up":void 0;w=T,k=S,g({scrolledToBottom:$,scrollDirection:A})}})(({scrolledToBottom:g,scrollDirection:k})=>{o?k==="up"&&(o=!1):k==="down"&&g&&(o=!0)}),50),i=g=>{g.addEventListener("scroll",a)},u=g=>{g==null||g.removeEventListener("scroll",a)},l=g=>{(t==null?void 0:t.uid)===g&&(c==null||c.disconnect(),d==null||d.disconnect(),t=void 0,c=void 0,d=void 0)};let c,d;const p=()=>{s==null||s.scrollTo({top:5e4,behavior:"instant"})},m=()=>{s&&r&&o&&p()},h=()=>{m()};return i(s),{updateConversationContainer:g=>{u(s),i(g),s=g},updateProps:({autoScroll:g})=>{r=g},handleNewChatSegmentAdded:(g,k)=>{t&&(c==null||c.disconnect(),d==null||d.disconnect()),t={uid:g,container:k},c=new ResizeObserver(m),c.observe(k),d=new MutationObserver(h),d.observe(k,{childList:!0,subtree:!0,characterData:!0}),r&&p()},handleChatSegmentRemoved:g=>l(g),handleChatSegmentComplete:g=>l(g),destroy:()=>{t&&(l(t.uid),t=void 0),u(s),s=void 0}}},Fr=!0,Ur=v.createContext({}),_t=n=>{if(typeof n!="object"||n===null)return!1;const e=n;return(typeof e.streamText=="function"||typeof e.batchText=="function")&&["stream","batch"].includes(e.dataTransferMode)&&typeof e.id=="string"&&typeof e.info=="object"&&e.info!==null&&typeof e.preProcessAiBatchedMessage=="function"&&typeof e.preProcessAiStreamedChunk=="function"};var ps;const rc=typeof navigator<"u"&&((ps=navigator==null?void 0:navigator.userAgent)!=null&&ps.includes("Safari"))?100:1,W=(n,e=rc)=>{setTimeout(()=>{n()},e)},sc=(n,e,t,r,s,o,a,i,u)=>new Promise(l=>{const c=fe(),d=[],p=[];let m=!1,h=!1,g=!1;const k=_t(t),w={next:f=>{if(h||g)return;let x,S;if(k){const C=f,T=t.preProcessAiStreamedChunk(C,r);T!=null&&(x=T,S=C,d.push(x),p.push(S))}else x=f,d.push(x);x!=null?(m||m||(m=!0,W(()=>{s.forEach(C=>{C({uid:c,status:"streaming",time:new Date,participantRole:"assistant",dataTransferMode:"stream"})})})),W(()=>{a.forEach(C=>{C({chunk:x,messageId:c,serverResponse:S})})})):oe("Adapter returned an undefined or null value from streamText. This chunk will be ignored.")},complete:()=>{h||g||(g=!0,W(()=>{const f={uid:c,status:"complete",content:d,contentType:"text",serverResponse:void 0,time:new Date,participantRole:"assistant",dataTransferMode:"stream"};o.forEach(x=>{x(f)}),l()}),W(()=>{const f={uid:n,status:"complete",items:[e,{uid:c,status:"complete",contentType:"text",content:d,serverResponse:p,time:new Date,participantRole:"assistant",dataTransferMode:"stream"}]};i.forEach(x=>{x(f)})}))},error:f=>{h||g||(h=!0,W(()=>{u.forEach(x=>{x("failed-to-stream-content",f)}),l()}))}};t.streamText(e.content,w,r)}),oc=(n,e,t)=>{if(!n)return(()=>{const f=new Set,x=fe(),S={uid:x,status:"complete",items:[]};return W(()=>{f.forEach(C=>{C(S)}),f.clear()}),{segment:S,observable:{on:(C,T)=>{C==="complete"&&f.add(T)},removeListener:(C,T)=>{f.delete(T)},destroy:()=>{f.clear()},get segmentId(){return x}},dataTransferMode:"batch"}})();const r=e;if(r.streamText===void 0&&r.batchText===void 0&&r.streamServerComponent===void 0)return(f=>{const x=new Set,S=fe(),C={uid:S,status:"error",items:[]};return W(()=>{x.forEach(T=>T(f)),x.clear()}),{segment:C,dataTransferMode:"stream",observable:{on:(T,M)=>{T==="error"&&x.add(M)},removeListener:(T,M)=>{x.delete(M)},destroy:()=>{x.clear()},get segmentId(){return S}}}})("no-data-transfer-mode-supported");const s=fe(),o=(f=>({uid:fe(),time:new Date,status:"complete",participantRole:"user",content:f,contentType:"text"}))(n);let a,i,u,l,c,d,p=new Set,m=new Set,h=new Set;W(()=>{p!=null&&p.size&&(p.forEach(f=>{f(o)}),p.clear(),p=void 0)});const g=(f=>{const x=[],S=f,C=f;(S==null?void 0:S.streamText)===void 0&&(C==null?void 0:C.streamServerComponent)===void 0||x.push("stream"),(S==null?void 0:S.batchText)!==void 0&&x.push("batch");const T=_t(f)?f:void 0,M=(T==null?void 0:T.dataTransferMode)??void 0,$=x.length===1?x[0]:"stream";return M??$})(e);(f=>"streamServerComponent"in f?"server-component":"text")(e)==="server-component"?(u=new Set,i=new Set,((f,x,S,C,T,M,$,A)=>new Promise((I,B)=>{try{const E=x.content,R=fe(),O="assistant",X="streaming",ae=new Date,Y="stream";let Z,z;const _=()=>{W(()=>{M.forEach(ue=>{Z&&z&&ue({...Z,content:z,status:"complete"})})},20);const V={uid:f,status:"complete",items:[x,Z]};W(()=>{$.forEach(ue=>{ue(V)}),I()},20)},te=()=>{A.forEach(V=>{V("failed-to-stream-server-component",new Error("Failed to load content"))})};z=S.streamServerComponent(E,C,{onServerComponentReceived:_,onError:te}),Z={uid:R,content:z,contentType:"server-component",participantRole:O,status:X,time:ae,dataTransferMode:Y},W(()=>{T.forEach(V=>{V(Z)})},10)}catch(E){oe(E);const R=E instanceof Error?E:typeof E=="string"?new Error(E):new Error("Unknown error");W(()=>{A.forEach(O=>O("failed-to-load-content",R))})}}))(s,o,e,t,i,u,m,h).finally(()=>{W(()=>w())})):g==="batch"?(a=new Set,(async(f,x,S,C,T,M,$)=>{try{const A=x.content,I=_t(S)?S:void 0,B=I!==void 0,E=fe(),R="assistant",O="complete",X=new Date,ae="batch";let Y;if(B){const _=await I.batchText(A,C),te=I.preProcessAiBatchedMessage(_,C);te!=null&&(Y={uid:E,content:te,contentType:"text",serverResponse:_,participantRole:R,status:O,time:X,dataTransferMode:ae})}else Y={uid:E,content:await S.batchText(A,C),contentType:"text",serverResponse:void 0,participantRole:R,status:O,time:X,dataTransferMode:ae};if(!Y)throw new Error("Response from adapter was undefined or cannot be processed");const Z=Y;W(()=>{T.forEach(_=>{_(Z)})});const z={uid:f,status:"complete",items:[x,Y]};W(()=>{M.forEach(_=>{_(z)})})}catch(A){oe(A);const I=A instanceof Error?A:typeof A=="string"?new Error(A):new Error("Unknown error");W(()=>{$.forEach(B=>B("failed-to-load-content",I))})}})(s,o,e,t,a,m,h).finally(()=>{W(()=>w())})):(l=new Set,c=new Set,d=new Set,sc(s,o,e,t,l,c,d,m,h).finally(()=>{W(()=>w())}));const w=()=>{p==null||p.clear(),p=void 0,a==null||a.clear(),a=void 0,i==null||i.clear(),i=void 0,u==null||u.clear(),u=void 0,l==null||l.clear(),l=void 0,c==null||c.clear(),c=void 0,d==null||d.clear(),d=void 0,m==null||m.clear(),m=void 0,h==null||h.clear(),h=void 0};return{segment:{status:"active",uid:s,items:[]},dataTransferMode:g,observable:{get segmentId(){return s},on:(f,x)=>{f==="userMessageReceived"&&p?p.add(x):f==="aiMessageReceived"&&a?a.add(x):f==="aiServerComponentStreamStarted"&&i?i.add(x):f==="aiServerComponentStreamed"&&u?u.add(x):f==="aiMessageStreamStarted"&&l?l.add(x):f==="aiMessageStreamed"&&c?c.add(x):f==="aiChunkReceived"&&d?d.add(x):f==="complete"&&m?m.add(x):f==="error"&&h&&h.add(x)},removeListener:(f,x)=>{f!=="userMessageReceived"?f!=="aiMessageReceived"?f!=="aiMessageStreamStarted"?f!=="aiMessageStreamed"?f!=="aiChunkReceived"?f!=="complete"?f!=="error"||(h==null||h.delete(x)):m==null||m.delete(x):d==null||d.delete(x):c==null||c.delete(x):l==null||l.delete(x):a==null||a.delete(x):p==null||p.delete(x)},destroy:()=>w()}}},ac={"data-transfer-mode-not-supported":"Requested data transfer mode is not supported","no-data-transfer-mode-supported":"Adapter does not support any valid data transfer modes","connection-error":"Connection error","invalid-credentials":"Invalid credentials","invalid-api-key":"Invalid API key","http-server-side-error":"HTTP server side error","http-client-side-error":"HTTP client side error","failed-to-load-content":"Failed to load content","failed-to-stream-content":"Failed to stream content","failed-to-stream-server-component":"Failed to stream server component","failed-to-render-content":"Failed to display content"},ic=n=>{var x;const{aiChatProps:e,adapterToUse:t,prompt:r,composerOptions:s,showException:o,initialSegment:a,newSegments:i,cancelledSegmentIds:u,cancelledMessageIds:l,setChatSegments:c,setComposerStatus:d,setPrompt:p,conversationRef:m}=n,h=v.useMemo(()=>r.length>0,[r]),g=v.useRef(r);g.current=r;const k=v.useRef({newSegments:i,cancelledSegmentIds:u,cancelledMessageIds:l,setChatSegments:c,setComposerStatus:d,showException:o,setPrompt:p}),w=v.useRef({});v.useEffect(()=>{k.current={newSegments:i,cancelledSegmentIds:u,cancelledMessageIds:l,setChatSegments:c,setComposerStatus:d,showException:o,setPrompt:p}},[i,u,l,c,d,o,p]);const f=((S,C,T)=>v.useMemo(()=>{const M=(A=>{const I=[];return A.forEach(B=>{B.items.forEach(E=>{if(E.status==="complete"){if(E.participantRole==="assistant")I.push({role:"assistant",message:E.content});else if(E.participantRole==="user")return I.push({role:"user",message:E.content})}})}),I})(C),$=T==="max"||T===void 0?M:T>0?M.slice(-T):void 0;return{aiChatProps:En(S),conversationHistory:$}},[S,C,T]))(e,a?[a,...i]:i,(x=e.conversationOptions)==null?void 0:x.historyPayloadSize);return v.useEffect(()=>{w.current=e.events||{}},[e.events]),v.useCallback(()=>{if(!t)return void oe("No valid adapter was provided to AiChat component");if(!h||s!=null&&s.disableSubmitButton)return;d("submitting-prompt");const S=r,C=new Set,T=_t(t)?t:t.streamServerComponent?{streamServerComponent:t.streamServerComponent}:{batchText:t.batchText,streamText:t.streamText},{segment:M,observable:$}=oc(S,T,f);if(M.status==="error")return oe("Error occurred while submitting prompt"),o("Error occurred while submitting prompt"),d("typing"),void(g.current===""&&p(S));const A=I=>{const B=k.current.newSegments.map(E=>E.uid!==$.segmentId?E:{...E,items:[...E.items,{...I}]});k.current.setChatSegments(B)};$.on("userMessageReceived",I=>{var B,E;(B=k.current)!=null&&B.cancelledMessageIds.includes(I.uid)||(A(I),(E=w.current)!=null&&E.messageSent&&w.current.messageSent({uid:I.uid,message:I.content}))}),$.on("aiMessageStreamStarted",I=>{var B,E;(B=k.current)!=null&&B.cancelledMessageIds.includes(I.uid)||(A(I),k.current.setComposerStatus("waiting"),g.current===S&&k.current.setPrompt(""),C.add(I.uid),(E=w.current)!=null&&E.messageStreamStarted&&w.current.messageStreamStarted({uid:I.uid}))}),$.on("aiServerComponentStreamStarted",I=>{var B,E,R;(B=k.current)!=null&&B.cancelledMessageIds.includes(I.uid)||(A(I),k.current.setComposerStatus("waiting"),g.current===S&&k.current.setPrompt(""),C.add(I.uid),(E=w.current)!=null&&E.serverComponentStreamStarted&&((R=w.current)==null||R.serverComponentStreamStarted({uid:I.uid})))}),$.on("aiServerComponentStreamed",I=>{var B,E,R;(B=k.current)!=null&&B.cancelledMessageIds.includes(I.uid)||(E=w.current)!=null&&E.serverComponentRendered&&!k.current.cancelledMessageIds.includes(I.uid)&&((R=w.current)==null||R.serverComponentRendered({uid:I.uid}))}),$.on("aiMessageReceived",I=>{var E,R;if((E=k.current)!=null&&E.cancelledMessageIds.includes(I.uid))return;const B=k.current.newSegments.map(O=>O.uid!==$.segmentId?O:{...O,items:[...O.items,{...I}]});k.current.setChatSegments(B),(R=w.current)!=null&&R.messageReceived&&w.current.messageReceived({uid:I.uid,message:I.content})}),$.on("complete",I=>{var E;if((E=k.current)!=null&&E.cancelledMessageIds.includes(I.uid))return;k.current.setComposerStatus("typing");const B=k.current.newSegments.map(R=>R.uid!==$.segmentId?R:{...I});k.current.setChatSegments(B),g.current===S&&p(""),C.size>0&&(C.forEach(R=>{requestAnimationFrame(()=>{var O;(O=m.current)==null||O.completeStream($.segmentId,R)})}),C.clear())}),$.on("aiChunkReceived",({messageId:I,chunk:B})=>{var E,R;(E=k.current)!=null&&E.cancelledMessageIds.includes(I)||((R=m.current)==null||R.streamChunk(M.uid,I,B))}),$.on("aiMessageStreamed",I=>{var B,E,R;(B=k.current)!=null&&B.cancelledMessageIds.includes(I.uid)||(E=w.current)!=null&&E.messageReceived&&((R=w.current)==null||R.messageReceived({uid:I.uid,message:I.content}))}),$.on("error",(I,B)=>{var O;const E=k.current.newSegments.filter(X=>X.uid!==M.uid),R=ac[I];k.current.setChatSegments(E),k.current.setComposerStatus("typing"),k.current.showException(R),g.current===""&&p(S),(O=w.current)!=null&&O.error&&w.current.error({errorId:I,message:R,errorObject:B})}),k.current.setChatSegments([...k.current.newSegments,M])},[r,t,f,o,k,s==null?void 0:s.disableSubmitButton])},Qr=()=>b.jsx("div",{className:"nlux-comp-messageLoader",children:b.jsx("div",{className:"nlux-comp-loaderContainer",children:b.jsx("span",{className:"spinning-loader"})})}),Gr={Loader:n=>b.jsx(b.Fragment,{children:n.children}),Greeting:n=>b.jsx(b.Fragment,{children:n.children})},cc=function(n){var Jn,Wn,Vn,er,tr;const{adapter:e,className:t,initialConversation:r,conversationOptions:s,composerOptions:o,displayOptions:a}=n,{themeId:i,colorScheme:u}=a??{},l=v.useRef(null),c=v.useRef(null),d=v.useRef(void 0),p=v.useRef(null),m=((y,P)=>{const[L,Q]=v.useState(),[K,G]=v.useState(),N=v.useRef(L),ee=v.useRef(P);return v.useEffect(()=>{const ne=y.current||void 0;ne!==K&&G(ne)}),v.useEffect(()=>{K?N.current?N.current.updateConversationContainer(K):(N.current=nc(K,ee.current??Fr),Q(N.current)):N.current&&(N.current.destroy(),Q(void 0),N.current=void 0)},[K]),v.useEffect(()=>{ee.current=P,N.current&&N.current.updateProps({autoScroll:P??Fr})},[P]),L})(c,s==null?void 0:s.autoScroll),h=v.useMemo(()=>p.current?oi(p.current):void 0,[p.current]),g=(()=>{const y={},P=new Set;return v.useMemo(()=>({getStreamingDomElement:L=>{if(P.has(L)&&P.delete(L),y[L]===void 0){const Q=document.createElement("div");Q.setAttribute("nlux-message-id",L),Q.className="nlux-markdown-container",y[L]=Q}return y[L]},deleteStreamingDomElement:L=>{P.add(L),setTimeout(()=>{P.forEach(Q=>{y[Q]&&(y[Q].remove(),delete y[Q])}),P.clear()},1e3)}}),[])})(),{PrimitivesContextProvider:k}=function(y){var Q,K,G,N,ee,ne,be,Re,we;const[P,L]=v.useState(y);return v.useEffect(()=>{L(y)},[(Q=y==null?void 0:y.messageOptions)==null?void 0:Q.htmlSanitizer,(K=y==null?void 0:y.messageOptions)==null?void 0:K.syntaxHighlighter,(G=y==null?void 0:y.messageOptions)==null?void 0:G.markdownLinkTarget,(N=y==null?void 0:y.messageOptions)==null?void 0:N.showCodeBlockCopyButton,(ee=y==null?void 0:y.messageOptions)==null?void 0:ee.skipStreamingAnimation,(ne=y==null?void 0:y.messageOptions)==null?void 0:ne.streamingAnimationSpeed,(be=y==null?void 0:y.messageOptions)==null?void 0:be.waitTimeBeforeStreamCompletion,(Re=y==null?void 0:y.messageOptions)==null?void 0:Re.responseRenderer,(we=y==null?void 0:y.messageOptions)==null?void 0:we.promptRenderer]),{PrimitivesContextProvider:v.useMemo(()=>({children:en})=>b.jsx(Ur.Provider,{value:P,children:en}),[P]),primitivesContext:Ur}}({messageOptions:n.messageOptions}),[w,f]=v.useState(""),[x,S]=v.useState("typing"),[C,T]=v.useState(),[M,$]=v.useState([]),[A,I]=v.useState([]),[B,E]=v.useState([]),R=v.useMemo(()=>C?[C,...M]:M,[C,M]),O=v.useMemo(()=>(y=>{const P=y;if(typeof(P==null?void 0:P.create)=="function")return P.create();if(typeof(P==null?void 0:P.batchText)=="function"||typeof(P==null?void 0:P.streamText)=="function"||typeof(P==null?void 0:P.streamServerComponent)=="function")return y;oe("Unable to determine the type of the adapter! Missing batchText or streamText method.")})(e),[e]),X=(y=>v.useMemo(()=>{const P={minWidth:"280px",minHeight:"280px"};return y!=null&&y.width&&(P.width=y.width),y!=null&&y.height&&(P.height=y.height),P},[y==null?void 0:y.width,y==null?void 0:y.height]))(a),ae=v.useMemo(()=>(y=>{const P=["nlux-AiChat-root"],L=`nlux-theme-${y.themeId||"nova"}`;return P.push(L),y.className&&P.push(y.className),P})({className:t,themeId:i}).join(" "),[t,i]),Y=v.useMemo(()=>{var y;return u!=="auto"&&u?u:typeof globalThis!==void 0&&globalThis.matchMedia&&((y=globalThis.matchMedia("(prefers-color-scheme: dark)"))!=null&&y.matches)?"dark":"light"},[u]),Z=v.useCallback(y=>h==null?void 0:h.displayException(y),[h]),z=function(y,P,L,Q,K,G,N,ee){return v.useCallback(()=>{var be;const ne=y.length>0?y[y.length-1]:void 0;(ne==null?void 0:ne.status)==="active"&&(Q(y.slice(0,-1)),K([...P,ne.uid]),G([...L,...ne.items.map(Re=>Re.uid)]),(be=N.current)==null||be.cancelSegmentStreams(ne.uid)),ee("typing")},[y,P,L,Q,K,G,N,ee])}(M,A,B,$,I,E,l,S),_=v.useCallback(y=>f(y),[f]),te=ic({aiChatProps:n,adapterToUse:O,conversationRef:l,initialSegment:C,newSegments:M,cancelledMessageIds:B,cancelledSegmentIds:A,prompt:w,composerOptions:o,showException:Z,setChatSegments:$,setComposerStatus:S,setPrompt:f}),V=((y,P,L,Q,K,G)=>v.useCallback((N,ee,ne)=>{if(N==="initial"&&y){const we=[];for(const nr of y.items){if(nr.uid===ee)break;we.push(nr)}const en={...y,items:we};return P(en),Q([]),K(ne),void G("submitting-edit")}const be=L.findIndex(we=>we.uid===N),Re=L.slice(0,be);Q(Re),K(ne),G("submitting-edit")},[L,Q,y,P,K,G]))(C,T,M,$,f,S),ue=v.useCallback((y,P)=>{var L;(L=n.events)!=null&&L.messageRendered&&n.events.messageRendered({uid:P})},[]),Mo=v.useCallback(y=>{f(y.prompt),S("submitting-conversation-starter")},[f,S]),Oo=((y,P)=>v.useCallback(L=>{y&&L&&(P.current=L.uid,y.handleNewChatSegmentAdded(L.uid,L.div))},[y]))(m,d);v.useEffect(()=>{x!=="submitting-conversation-starter"&&x!=="submitting-external-message"&&x!=="submitting-edit"||te()},[x,te]),v.useEffect(()=>T(r?{uid:"initial",status:"complete",items:r.map((y,P)=>{if(y.role==="assistant"||y.role==="user")return y.role==="user"?typeof y.message!="string"?void oe(`Invalid message type for item at index ${P} in initial conversation: When role is "user", message must be a string`):{uid:fe(),time:new Date,status:"complete",participantRole:"user",content:y.message,contentType:"text"}:{uid:fe(),time:new Date,status:"complete",participantRole:"assistant",content:y.message,contentType:"text",serverResponse:y.serverResponse,dataTransferMode:"batch"};oe(`Invalid role for item at index ${P} in initial conversation: Role must be "assistant" or "user"`)}).filter(y=>y!==void 0)}:void 0),[r]),v.useEffect(()=>{var y;C&&((y=c.current)==null||y.scrollTo({behavior:"smooth",top:5e4}))},[C]);const ct=v.useRef(void 0);v.useEffect(()=>{const y=n.api;ct.current=y,typeof(y==null?void 0:y.__setHost)=="function"?y.__setHost({sendMessage:P=>{f(P),S("submitting-external-message")},resetConversation:()=>{$([]),T(void 0)},cancelLastMessageRequest:z}):tt(`API object passed was is not compatible with AiChat.
Only use API objects created by the useAiChatApi() hook.`)},[n.api,z,f,S,$,T]),v.useEffect(()=>()=>{var y;typeof((y=ct.current)==null?void 0:y.__unsetHost)=="function"&&(ct.current.__unsetHost(),ct.current=void 0)},[]),(y=>{v.useEffect(()=>{var L;const P=(L=y.events)==null?void 0:L.ready;P&&P({aiChatProps:En(y)})},[])})(n),((y,P)=>{var K;const L=v.useRef(),Q=v.useRef();v.useEffect(()=>{L.current=()=>{const G=[];return P.forEach(N=>{N.items&&N.items.length!==0&&N.items.forEach(ee=>{ee.status==="complete"&&(ee.participantRole!=="assistant"?ee.participantRole==="user"&&G.push({role:"user",message:ee.content}):G.push({role:"assistant",message:ee.content}))})}),G}},[P]),v.useEffect(()=>{var G;Q.current=(G=y.events)==null?void 0:G.preDestroy},[(K=y.events)==null?void 0:K.preDestroy]),v.useEffect(()=>()=>{var N;const G=Q.current;G&&(G({aiChatProps:En(y),conversationHistory:((N=L.current)==null?void 0:N.call(L))??[]}),L.current=void 0)},[])})(n,R);const $o=v.useMemo(()=>v.forwardRef(Zi),[]),Vt=(y=>{const P=v.useMemo(()=>y.children?Array.isArray(y.children)?y.children:[y.children]:[],[y.children]);return{Loader:v.useMemo(()=>P.length===0?b.jsx(Qr,{}):P.find(L=>L.type===Gr.Loader)||b.jsx(Qr,{}),[P]),Greeting:v.useMemo(()=>{if(P.length!==0)return P.find(L=>L.type===Gr.Greeting)},[P])}})(n),zo=w.length>0,jo=R.length===0?"nlux-chatRoom-starting":"nlux-chatRoom-active";return O?b.jsx(k,{children:b.jsxs("div",{className:ae,style:X,"data-color-scheme":Y,children:[b.jsx("div",{className:"nlux-comp-exceptionBox",ref:p}),b.jsxs("div",{className:`nlux-chatRoom-container ${jo}`,children:[b.jsx("div",{className:"nlux-launchPad-container",children:b.jsx(Vi,{segments:R,onConversationStarterSelected:Mo,conversationOptions:s,personaOptions:n.personaOptions,userDefinedGreeting:Vt.Greeting})}),b.jsx("div",{className:"nlux-conversation-container",ref:c,"aria-label":"Chat conversation",role:"log",children:b.jsx($o,{ref:l,segments:R,conversationOptions:n.conversationOptions,personaOptions:n.personaOptions,messageOptions:n.messageOptions,onLastActiveSegmentChange:Oo,Loader:Vt.Loader,markdownContainersController:g,submitShortcutKey:(Jn=n.composerOptions)==null?void 0:Jn.submitShortcut,onPromptResubmit:V,onMarkdownStreamRendered:ue})}),b.jsx("div",{className:"nlux-composer-container",children:b.jsx(li,{status:x,prompt:w,hasValidInput:zo,placeholder:(Wn=n.composerOptions)==null?void 0:Wn.placeholder,autoFocus:(Vn=n.composerOptions)==null?void 0:Vn.autoFocus,submitShortcut:(er=n.composerOptions)==null?void 0:er.submitShortcut,hideStopButton:(tr=n.composerOptions)==null?void 0:tr.hideStopButton,onChange:_,onSubmit:te,onCancel:z,Loader:Vt.Loader})})]})]})}):(tt("AiChat: No valid adapter provided. The component will not render."),b.jsx(b.Fragment,{}))},lc=()=>{const n=v.useRef(null),e=v.useRef(((t=()=>{})=>({composer:{send:r=>{throw new Error("AiChatApi is not connected to a host <AiChat /> component.")},cancel:()=>{throw new Error("AiChatApi is not connected to a host <AiChat /> component.")}},conversation:{reset:()=>{throw new Error("AiChatApi is not connected to a host <AiChat /> component.")}},__setHost:r=>{t(r)},__unsetHost:()=>{}}))());return e.current.composer.send=t=>{if(!n.current)throw new Error("AiChatApi is not connected to a host <AiChat /> component.");n.current.sendMessage(t)},e.current.composer.cancel=()=>{if(!n.current)throw new Error("AiChatApi is not connected to a host <AiChat /> component.");n.current.cancelLastMessageRequest()},e.current.conversation.reset=()=>{if(!n.current)throw new Error("AiChatApi is not connected to a host <AiChat /> component.");n.current.resetConversation()},e.current.__setHost=t=>{n.current=t},e.current.__unsetHost=()=>{n.current=null},e.current},uc=function(n,e){return v.useMemo(()=>({streamText:n}),e??[{}])};sessionStorage.removeItem("chatSessionId");let At;function dc(n){let e="",t=null;return n.split(`
id`).forEach(r=>{let s=r.split(`HTTP_STATUS/200
data:`)[1];try{s=JSON.parse(s),t=s.output.session_id,e+=s.output.text||""}catch(o){throw o}}),[e,t]}const pc=function(n){const e=v.useContext(Kn);return[async(r,s)=>{var u,l;(u=e==null?void 0:e.dataProcessor)!=null&&u.rewritePrompt&&(r=e==null?void 0:e.dataProcessor.rewritePrompt(r));const o={sessionId:sessionStorage.getItem("chatSessionId"),prompt:r},a=await fetch(e==null?void 0:e.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(a.status!==200){s.error(new Error("Failed to connect to the server"));return}if(!a.body)return;At=a.body.getReader();const i=new TextDecoder;for(;;){const{value:c,done:d}=await At.read();if(d||n(!0),d)break;const p=i.decode(c);if(p){const m=((l=e==null?void 0:e.dataProcessor)==null?void 0:l.processChunk)||dc;try{const[h,g]=m(p);sessionStorage.setItem("chatSessionId",g||""),h&&s.next(h)}catch(h){console.warn("Parse content failed: "+p,h),s.error(new Error("Parse content failed"))}}}n(!1),s.complete()},()=>{At&&At.cancel()}]};function hc(){this.__data__=[],this.size=0}var mc=hc;function gc(n,e){return n===e||n!==n&&e!==e}var Yt=gc,fc=Yt;function vc(n,e){for(var t=n.length;t--;)if(fc(n[t][0],e))return t;return-1}var Xt=vc,xc=Xt,kc=Array.prototype,yc=kc.splice;function bc(n){var e=this.__data__,t=xc(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():yc.call(e,t,1),--this.size,!0}var wc=bc,Sc=Xt;function Cc(n){var e=this.__data__,t=Sc(e,n);return t<0?void 0:e[t][1]}var Ac=Cc,Ic=Xt;function Ec(n){return Ic(this.__data__,n)>-1}var Tc=Ec,Pc=Xt;function Rc(n,e){var t=this.__data__,r=Pc(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}var Bc=Rc,Lc=mc,Mc=wc,Oc=Ac,$c=Tc,zc=Bc;function ze(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}ze.prototype.clear=Lc;ze.prototype.delete=Mc;ze.prototype.get=Oc;ze.prototype.has=$c;ze.prototype.set=zc;var Zt=ze,jc=Zt;function Dc(){this.__data__=new jc,this.size=0}var Hc=Dc;function _c(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}var Nc=_c;function qc(n){return this.__data__.get(n)}var Fc=qc;function Uc(n){return this.__data__.has(n)}var Qc=Uc,Gc=typeof lt=="object"&&lt&&lt.Object===Object&&lt,ho=Gc,Yc=ho,Xc=typeof self=="object"&&self&&self.Object===Object&&self,Zc=Yc||Xc||Function("return this")(),je=Zc,Kc=je,Jc=Kc.Symbol,mo=Jc,Yr=mo,go=Object.prototype,Wc=go.hasOwnProperty,Vc=go.toString,Ge=Yr?Yr.toStringTag:void 0;function el(n){var e=Wc.call(n,Ge),t=n[Ge];try{n[Ge]=void 0;var r=!0}catch{}var s=Vc.call(n);return r&&(e?n[Ge]=t:delete n[Ge]),s}var tl=el,nl=Object.prototype,rl=nl.toString;function sl(n){return rl.call(n)}var ol=sl,Xr=mo,al=tl,il=ol,cl="[object Null]",ll="[object Undefined]",Zr=Xr?Xr.toStringTag:void 0;function ul(n){return n==null?n===void 0?ll:cl:Zr&&Zr in Object(n)?al(n):il(n)}var Kt=ul;function dl(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var Pe=dl,pl=Kt,hl=Pe,ml="[object AsyncFunction]",gl="[object Function]",fl="[object GeneratorFunction]",vl="[object Proxy]";function xl(n){if(!hl(n))return!1;var e=pl(n);return e==gl||e==fl||e==ml||e==vl}var Gn=xl,kl=je,yl=kl["__core-js_shared__"],bl=yl,un=bl,Kr=function(){var n=/[^.]+$/.exec(un&&un.keys&&un.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function wl(n){return!!Kr&&Kr in n}var Sl=wl,Cl=Function.prototype,Al=Cl.toString;function Il(n){if(n!=null){try{return Al.call(n)}catch{}try{return n+""}catch{}}return""}var El=Il,Tl=Gn,Pl=Sl,Rl=Pe,Bl=El,Ll=/[\\^$.*+?()[\]{}|]/g,Ml=/^\[object .+?Constructor\]$/,Ol=Function.prototype,$l=Object.prototype,zl=Ol.toString,jl=$l.hasOwnProperty,Dl=RegExp("^"+zl.call(jl).replace(Ll,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Hl(n){if(!Rl(n)||Pl(n))return!1;var e=Tl(n)?Dl:Ml;return e.test(Bl(n))}var _l=Hl;function Nl(n,e){return n==null?void 0:n[e]}var ql=Nl,Fl=_l,Ul=ql;function Ql(n,e){var t=Ul(n,e);return Fl(t)?t:void 0}var Yn=Ql,Gl=Yn,Yl=je,Xl=Gl(Yl,"Map"),fo=Xl,Zl=Yn,Kl=Zl(Object,"create"),Jt=Kl,Jr=Jt;function Jl(){this.__data__=Jr?Jr(null):{},this.size=0}var Wl=Jl;function Vl(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var eu=Vl,tu=Jt,nu="__lodash_hash_undefined__",ru=Object.prototype,su=ru.hasOwnProperty;function ou(n){var e=this.__data__;if(tu){var t=e[n];return t===nu?void 0:t}return su.call(e,n)?e[n]:void 0}var au=ou,iu=Jt,cu=Object.prototype,lu=cu.hasOwnProperty;function uu(n){var e=this.__data__;return iu?e[n]!==void 0:lu.call(e,n)}var du=uu,pu=Jt,hu="__lodash_hash_undefined__";function mu(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=pu&&e===void 0?hu:e,this}var gu=mu,fu=Wl,vu=eu,xu=au,ku=du,yu=gu;function De(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}De.prototype.clear=fu;De.prototype.delete=vu;De.prototype.get=xu;De.prototype.has=ku;De.prototype.set=yu;var bu=De,Wr=bu,wu=Zt,Su=fo;function Cu(){this.size=0,this.__data__={hash:new Wr,map:new(Su||wu),string:new Wr}}var Au=Cu;function Iu(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}var Eu=Iu,Tu=Eu;function Pu(n,e){var t=n.__data__;return Tu(e)?t[typeof e=="string"?"string":"hash"]:t.map}var Wt=Pu,Ru=Wt;function Bu(n){var e=Ru(this,n).delete(n);return this.size-=e?1:0,e}var Lu=Bu,Mu=Wt;function Ou(n){return Mu(this,n).get(n)}var $u=Ou,zu=Wt;function ju(n){return zu(this,n).has(n)}var Du=ju,Hu=Wt;function _u(n,e){var t=Hu(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}var Nu=_u,qu=Au,Fu=Lu,Uu=$u,Qu=Du,Gu=Nu;function He(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}He.prototype.clear=qu;He.prototype.delete=Fu;He.prototype.get=Uu;He.prototype.has=Qu;He.prototype.set=Gu;var Yu=He,Xu=Zt,Zu=fo,Ku=Yu,Ju=200;function Wu(n,e){var t=this.__data__;if(t instanceof Xu){var r=t.__data__;if(!Zu||r.length<Ju-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new Ku(r)}return t.set(n,e),this.size=t.size,this}var Vu=Wu,ed=Zt,td=Hc,nd=Nc,rd=Fc,sd=Qc,od=Vu;function _e(n){var e=this.__data__=new ed(n);this.size=e.size}_e.prototype.clear=td;_e.prototype.delete=nd;_e.prototype.get=rd;_e.prototype.has=sd;_e.prototype.set=od;var ad=_e,id=Yn,cd=function(){try{var n=id(Object,"defineProperty");return n({},"",{}),n}catch{}}(),vo=cd,Vr=vo;function ld(n,e,t){e=="__proto__"&&Vr?Vr(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}var Xn=ld,ud=Xn,dd=Yt;function pd(n,e,t){(t!==void 0&&!dd(n[e],t)||t===void 0&&!(e in n))&&ud(n,e,t)}var xo=pd;function hd(n){return function(e,t,r){for(var s=-1,o=Object(e),a=r(e),i=a.length;i--;){var u=a[n?i:++s];if(t(o[u],u,o)===!1)break}return e}}var md=hd,gd=md,fd=gd(),vd=fd,Nt={exports:{}};Nt.exports;(function(n,e){var t=je,r=e&&!e.nodeType&&e,s=r&&!0&&n&&!n.nodeType&&n,o=s&&s.exports===r,a=o?t.Buffer:void 0,i=a?a.allocUnsafe:void 0;function u(l,c){if(c)return l.slice();var d=l.length,p=i?i(d):new l.constructor(d);return l.copy(p),p}n.exports=u})(Nt,Nt.exports);var xd=Nt.exports,kd=je,yd=kd.Uint8Array,bd=yd,es=bd;function wd(n){var e=new n.constructor(n.byteLength);return new es(e).set(new es(n)),e}var Sd=wd,Cd=Sd;function Ad(n,e){var t=e?Cd(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.length)}var Id=Ad;function Ed(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}var Td=Ed,Pd=Pe,ts=Object.create,Rd=function(){function n(){}return function(e){if(!Pd(e))return{};if(ts)return ts(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}(),Bd=Rd;function Ld(n,e){return function(t){return n(e(t))}}var Md=Ld,Od=Md,$d=Od(Object.getPrototypeOf,Object),ko=$d,zd=Object.prototype;function jd(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||zd;return n===t}var yo=jd,Dd=Bd,Hd=ko,_d=yo;function Nd(n){return typeof n.constructor=="function"&&!_d(n)?Dd(Hd(n)):{}}var qd=Nd;function Fd(n){return n!=null&&typeof n=="object"}var it=Fd,Ud=Kt,Qd=it,Gd="[object Arguments]";function Yd(n){return Qd(n)&&Ud(n)==Gd}var Xd=Yd,ns=Xd,Zd=it,bo=Object.prototype,Kd=bo.hasOwnProperty,Jd=bo.propertyIsEnumerable,Wd=ns(function(){return arguments}())?ns:function(n){return Zd(n)&&Kd.call(n,"callee")&&!Jd.call(n,"callee")},wo=Wd,Vd=Array.isArray,So=Vd,ep=9007199254740991;function tp(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=ep}var Co=tp,np=Gn,rp=Co;function sp(n){return n!=null&&rp(n.length)&&!np(n)}var Zn=sp,op=Zn,ap=it;function ip(n){return ap(n)&&op(n)}var cp=ip,qt={exports:{}};function lp(){return!1}var up=lp;qt.exports;(function(n,e){var t=je,r=up,s=e&&!e.nodeType&&e,o=s&&!0&&n&&!n.nodeType&&n,a=o&&o.exports===s,i=a?t.Buffer:void 0,u=i?i.isBuffer:void 0,l=u||r;n.exports=l})(qt,qt.exports);var Ao=qt.exports,dp=Kt,pp=ko,hp=it,mp="[object Object]",gp=Function.prototype,fp=Object.prototype,Io=gp.toString,vp=fp.hasOwnProperty,xp=Io.call(Object);function kp(n){if(!hp(n)||dp(n)!=mp)return!1;var e=pp(n);if(e===null)return!0;var t=vp.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&Io.call(t)==xp}var yp=kp,bp=Kt,wp=Co,Sp=it,Cp="[object Arguments]",Ap="[object Array]",Ip="[object Boolean]",Ep="[object Date]",Tp="[object Error]",Pp="[object Function]",Rp="[object Map]",Bp="[object Number]",Lp="[object Object]",Mp="[object RegExp]",Op="[object Set]",$p="[object String]",zp="[object WeakMap]",jp="[object ArrayBuffer]",Dp="[object DataView]",Hp="[object Float32Array]",_p="[object Float64Array]",Np="[object Int8Array]",qp="[object Int16Array]",Fp="[object Int32Array]",Up="[object Uint8Array]",Qp="[object Uint8ClampedArray]",Gp="[object Uint16Array]",Yp="[object Uint32Array]",q={};q[Hp]=q[_p]=q[Np]=q[qp]=q[Fp]=q[Up]=q[Qp]=q[Gp]=q[Yp]=!0;q[Cp]=q[Ap]=q[jp]=q[Ip]=q[Dp]=q[Ep]=q[Tp]=q[Pp]=q[Rp]=q[Bp]=q[Lp]=q[Mp]=q[Op]=q[$p]=q[zp]=!1;function Xp(n){return Sp(n)&&wp(n.length)&&!!q[bp(n)]}var Zp=Xp;function Kp(n){return function(e){return n(e)}}var Jp=Kp,Ft={exports:{}};Ft.exports;(function(n,e){var t=ho,r=e&&!e.nodeType&&e,s=r&&!0&&n&&!n.nodeType&&n,o=s&&s.exports===r,a=o&&t.process,i=function(){try{var u=s&&s.require&&s.require("util").types;return u||a&&a.binding&&a.binding("util")}catch{}}();n.exports=i})(Ft,Ft.exports);var Wp=Ft.exports,Vp=Zp,eh=Jp,rs=Wp,ss=rs&&rs.isTypedArray,th=ss?eh(ss):Vp,Eo=th;function nh(n,e){if(!(e==="constructor"&&typeof n[e]=="function")&&e!="__proto__")return n[e]}var To=nh,rh=Xn,sh=Yt,oh=Object.prototype,ah=oh.hasOwnProperty;function ih(n,e,t){var r=n[e];(!(ah.call(n,e)&&sh(r,t))||t===void 0&&!(e in n))&&rh(n,e,t)}var ch=ih,lh=ch,uh=Xn;function dh(n,e,t,r){var s=!t;t||(t={});for(var o=-1,a=e.length;++o<a;){var i=e[o],u=r?r(t[i],n[i],i,t,n):void 0;u===void 0&&(u=n[i]),s?uh(t,i,u):lh(t,i,u)}return t}var ph=dh;function hh(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}var mh=hh,gh=9007199254740991,fh=/^(?:0|[1-9]\d*)$/;function vh(n,e){var t=typeof n;return e=e??gh,!!e&&(t=="number"||t!="symbol"&&fh.test(n))&&n>-1&&n%1==0&&n<e}var Po=vh,xh=mh,kh=wo,yh=So,bh=Ao,wh=Po,Sh=Eo,Ch=Object.prototype,Ah=Ch.hasOwnProperty;function Ih(n,e){var t=yh(n),r=!t&&kh(n),s=!t&&!r&&bh(n),o=!t&&!r&&!s&&Sh(n),a=t||r||s||o,i=a?xh(n.length,String):[],u=i.length;for(var l in n)(e||Ah.call(n,l))&&!(a&&(l=="length"||s&&(l=="offset"||l=="parent")||o&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||wh(l,u)))&&i.push(l);return i}var Eh=Ih;function Th(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}var Ph=Th,Rh=Pe,Bh=yo,Lh=Ph,Mh=Object.prototype,Oh=Mh.hasOwnProperty;function $h(n){if(!Rh(n))return Lh(n);var e=Bh(n),t=[];for(var r in n)r=="constructor"&&(e||!Oh.call(n,r))||t.push(r);return t}var zh=$h,jh=Eh,Dh=zh,Hh=Zn;function _h(n){return Hh(n)?jh(n,!0):Dh(n)}var Ro=_h,Nh=ph,qh=Ro;function Fh(n){return Nh(n,qh(n))}var Uh=Fh,os=xo,Qh=xd,Gh=Id,Yh=Td,Xh=qd,as=wo,is=So,Zh=cp,Kh=Ao,Jh=Gn,Wh=Pe,Vh=yp,em=Eo,cs=To,tm=Uh;function nm(n,e,t,r,s,o,a){var i=cs(n,t),u=cs(e,t),l=a.get(u);if(l){os(n,t,l);return}var c=o?o(i,u,t+"",n,e,a):void 0,d=c===void 0;if(d){var p=is(u),m=!p&&Kh(u),h=!p&&!m&&em(u);c=u,p||m||h?is(i)?c=i:Zh(i)?c=Yh(i):m?(d=!1,c=Qh(u,!0)):h?(d=!1,c=Gh(u,!0)):c=[]:Vh(u)||as(u)?(c=i,as(i)?c=tm(i):(!Wh(i)||Jh(i))&&(c=Xh(u))):d=!1}d&&(a.set(u,c),s(c,u,r,o,a),a.delete(u)),os(n,t,c)}var rm=nm,sm=ad,om=xo,am=vd,im=rm,cm=Pe,lm=Ro,um=To;function Bo(n,e,t,r,s){n!==e&&am(e,function(o,a){if(s||(s=new sm),cm(o))im(n,e,a,t,Bo,r,s);else{var i=r?r(um(n,a),o,a+"",n,e,s):void 0;i===void 0&&(i=o),om(n,a,i)}},lm)}var dm=Bo;function pm(n){return n}var Lo=pm;function hm(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}var mm=hm,gm=mm,ls=Math.max;function fm(n,e,t){return e=ls(e===void 0?n.length-1:e,0),function(){for(var r=arguments,s=-1,o=ls(r.length-e,0),a=Array(o);++s<o;)a[s]=r[e+s];s=-1;for(var i=Array(e+1);++s<e;)i[s]=r[s];return i[e]=t(a),gm(n,this,i)}}var vm=fm;function xm(n){return function(){return n}}var km=xm,ym=km,us=vo,bm=Lo,wm=us?function(n,e){return us(n,"toString",{configurable:!0,enumerable:!1,value:ym(e),writable:!0})}:bm,Sm=wm,Cm=800,Am=16,Im=Date.now;function Em(n){var e=0,t=0;return function(){var r=Im(),s=Am-(r-t);if(t=r,s>0){if(++e>=Cm)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}var Tm=Em,Pm=Sm,Rm=Tm,Bm=Rm(Pm),Lm=Bm,Mm=Lo,Om=vm,$m=Lm;function zm(n,e){return $m(Om(n,e,Mm),n+"")}var jm=zm,Dm=Yt,Hm=Zn,_m=Po,Nm=Pe;function qm(n,e,t){if(!Nm(t))return!1;var r=typeof e;return(r=="number"?Hm(t)&&_m(e,t.length):r=="string"&&e in t)?Dm(t[e],n):!1}var Fm=qm,Um=jm,Qm=Fm;function Gm(n){return Um(function(e,t){var r=-1,s=t.length,o=s>1?t[s-1]:void 0,a=s>2?t[2]:void 0;for(o=n.length>3&&typeof o=="function"?(s--,o):void 0,a&&Qm(t[0],t[1],a)&&(o=s<3?void 0:o,s=1),e=Object(e);++r<s;){var i=t[r];i&&n(e,i,r,o)}return e})}var Ym=Gm,Xm=dm,Zm=Ym,Km=Zm(function(n,e,t){Xm(n,e,t)}),Jm=Km;const Wm=Do(Jm),Vm={colorScheme:"light",height:"100%"},eg=[{role:"user",message:"I need help with my order"},{role:"assistant",message:"Sure! What is your order number?"}],tg={conversationOptions:{},personaOptions:{assistant:{name:"你好，我是你的 AI 助手",avatar:"https://s1.eastbuy.com/s/Avatar-9107634e.png",tagline:"您可以尝试点击下方的快捷入口开启体验！"},user:{name:"You",avatar:"https://s1.eastbuy.com/s/Frame-cb35d3ba.png"}},displayOptions:Vm,composerOptions:{placeholder:"请输入您的问题，使用 Shift + Enter 换行。",hideStopButton:!0},initialConversation:eg},ng=n=>Wm({},tg,n.aiChatOptions||n.options),rg="_stopButton_caofb_1",sg={stopButton:rg,"nlux-comp-chatItem":"_nlux-comp-chatItem_caofb_32"},og=b.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",viewBox:"0 0 26 26",children:[b.jsx("circle",{cx:"13.5",cy:"13",r:"12",strokeWidth:"1",fill:"none",stroke:"#999"}),b.jsx("rect",{x:"8",y:"7.5",width:"11",height:"11",fill:"#666"})]}),It=n=>b.jsx("svg",{"aria-hidden":"true",fontSize:n.size,color:n.color,...n,className:`icon-font-svg  ${n.className||""}`,children:b.jsx("use",{href:"#"+n.name})}),ag=n=>{const e=v.useContext(Kn);console.log("CustomResponseRenderers",n);const t={...n};return b.jsx(b.Fragment,{children:b.jsxs("div",{className:"colourful-response-renderer",children:[b.jsx("div",{className:"response-container",children:n.content}),b.jsxs("div",{className:"rating-container",children:[b.jsx("div",{className:"tool-btn",onClick:()=>{var r,s;return(s=(r=e==null?void 0:e.answerEvents)==null?void 0:r.praiseClick)==null?void 0:s.call(r,t)},children:b.jsx(It,{name:"dianzan",size:14})}),b.jsx("div",{className:"tool-btn reverse",onClick:()=>{var r,s;return(s=(r=e==null?void 0:e.answerEvents)==null?void 0:r.blameClick)==null?void 0:s.call(r,t)},children:b.jsx(It,{name:"dianzan",size:14})}),b.jsx("div",{className:"tool-btn",onClick:()=>{var r,s;return(s=(r=e==null?void 0:e.answerEvents)==null?void 0:r.copyClick)==null?void 0:s.call(r,t)},children:b.jsx(It,{name:"icon-copy-14px",size:14})}),b.jsx("div",{className:"tool-btn",onClick:()=>{var r,s;return(s=(r=e==null?void 0:e.answerEvents)==null?void 0:r.collectClick)==null?void 0:s.call(r,t)},children:b.jsx(It,{name:"icon-copy-14px",size:14})})]})]})})};v.forwardRef((n,e)=>{const t=v.useContext(Kn),r=ng(t),s=lc(),[o,a]=v.useState(!1),[i,u]=pc(a),l=uc(i,[]),c=()=>{u()};return v.useImperativeHandle(e,()=>({resetConversation:()=>{u(),s.conversation.reset(),s.composer.cancel()}})),b.jsxs(b.Fragment,{children:[b.jsx(cc,{api:s,adapter:l,messageOptions:{responseRenderer:ag},...r}),o&&b.jsx("div",{className:sg.stopButton,children:b.jsx("button",{onClick:c,children:og})})]})});const Kn=v.createContext({endpoint:"/chat"});
